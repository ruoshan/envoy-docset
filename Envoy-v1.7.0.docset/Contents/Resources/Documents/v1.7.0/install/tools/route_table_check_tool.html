

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Route table check tool &mdash; envoy tag-v1.7.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Schema Validator check tool" href="schema_validator_check_tool.html" />
    <link rel="prev" title="Config load check tool" href="config_load_check_tool.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> envoy
          

          
          </a>

          
            
            
              <div class="version">
                tag-v1.7.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../start/start.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../install.html">Building and installation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../building.html">Building</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ref_configs.html">Reference configurations</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="tools.html">Tools</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="config_load_check_tool.html">Config load check tool</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Route table check tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="schema_validator_check_tool.html">Schema Validator check tool</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration/configuration.html">Configuration reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api-v1/api.html">v1 API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api-v2/api.html">v2 API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/overview.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">envoy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../install.html">Building and installation</a> &raquo;</li>
        
          <li><a href="tools.html">Tools</a> &raquo;</li>
        
      <li>Route table check tool</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/install/tools/route_table_check_tool.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="route-table-check-tool">
<span id="install-tools-route-table-check-tool"></span><h1>Route table check tool<a class="headerlink" href="#route-table-check-tool" title="Permalink to this headline">Â¶</a></h1>
<p>The route table check tool checks whether the route parameters returned by a router match what is expected.
The tool can also be used to check whether a path redirect, path rewrite, or host rewrite
match what is expected.</p>
<dl class="docutils">
<dt>Input</dt>
<dd><p class="first">The tool expects two input JSON files:</p>
<ol class="last arabic simple">
<li>A router config JSON file. The router config JSON file schema is found in
<a class="reference internal" href="../../api-v1/route_config/route_config.html#config-http-conn-man-route-table"><span class="std std-ref">config</span></a>.</li>
<li>A tool config JSON file. The tool config JSON file schema is found in
<a class="reference internal" href="../../configuration/tools/router_check.html#config-tools-router-check-tool"><span class="std std-ref">config</span></a>.
The tool config input file specifies urls (composed of authorities and paths)
and expected route parameter values. Additional parameters such as additional headers are optional.</li>
</ol>
</dd>
<dt>Output</dt>
<dd><p class="first">The program exits with status EXIT_FAILURE if any test case does not match the expected route parameter
value.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">--details</span></code> option prints out details for each test. The first line indicates the test name.</p>
<p>If a test fails, details of the failed test cases are printed. The first field is the expected
route parameter value. The second field is the actual route parameter value. The third field indicates
the parameter that is compared. In the following example, Test_2 and Test_5 failed while the other tests
passed. In the failed test cases, conflict details are printed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Test_1</span>
<span class="n">Test_2</span>
<span class="n">default</span> <span class="n">other</span> <span class="n">virtual_host_name</span>
<span class="n">Test_3</span>
<span class="n">Test_4</span>
<span class="n">Test_5</span>
<span class="n">locations</span> <span class="n">ats</span> <span class="n">cluster_name</span>
<span class="n">Test_6</span>
</pre></div>
</div>
<p class="last">Testing with valid <a class="reference internal" href="../../api-v1/route_config/route.html#config-http-conn-man-route-table-route"><span class="std std-ref">runtime values</span></a> is not currently supported,
this may be added in future work.</p>
</dd>
<dt>Building</dt>
<dd><p class="first">The tool can be built locally using Bazel.</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bazel</span> <span class="n">build</span> <span class="o">//</span><span class="n">test</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">router_check</span><span class="p">:</span><span class="n">router_check_tool</span>
</pre></div>
</div>
</dd>
<dt>Running</dt>
<dd><p class="first">The tool takes two input json files and an optional command line parameter <code class="docutils literal notranslate"><span class="pre">--details</span></code>. The
expected order of command line arguments is:
1. The router configuration json file.
2. The tool configuration json file.
3. The optional details flag.</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bazel</span><span class="o">-</span><span class="nb">bin</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">router_check</span><span class="o">/</span><span class="n">router_check_tool</span> <span class="n">router_config</span><span class="o">.</span><span class="n">json</span> <span class="n">tool_config</span><span class="o">.</span><span class="n">json</span>

<span class="n">bazel</span><span class="o">-</span><span class="nb">bin</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">router_check</span><span class="o">/</span><span class="n">router_check_tool</span> <span class="n">router_config</span><span class="o">.</span><span class="n">json</span> <span class="n">tool_config</span><span class="o">.</span><span class="n">json</span> <span class="o">--</span><span class="n">details</span>
</pre></div>
</div>
</dd>
<dt>Testing</dt>
<dd><p class="first">A bash shell script test can be run with bazel. The test compares routes using different router and
tool configuration json files. The configuration json files can be found in
test/tools/router_check/test/config/â¦ .</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bazel</span> <span class="n">test</span> <span class="o">//</span><span class="n">test</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">router_check</span><span class="o">/...</span>
</pre></div>
</div>
</dd>
</dl>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="schema_validator_check_tool.html" class="btn btn-neutral float-right" title="Schema Validator check tool" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="config_load_check_tool.html" class="btn btn-neutral" title="Config load check tool" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2018, Envoy Project Authors.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'tag-v1.7.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>