

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>TCP Proxy &mdash; envoy tag-v1.7.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../../../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" />
    <link rel="next" title="HTTP filters" href="../../../http/http.html" />
    <link rel="prev" title="Redis Proxy" href="../../redis_proxy/v2/redis_proxy.proto.html" /> 

  
  <script src="../../../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../../../index.html" class="icon icon-home"> envoy
          

          
          </a>

          
            
            
              <div class="version">
                tag-v1.7.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../start/start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../install/install.html">Building and installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../configuration/configuration.html">Configuration reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../api-v1/api.html">v1 API reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../../api.html">v2 API reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../../../bootstrap/bootstrap.html">Bootstrap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../listeners/listeners.html">Listeners</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../clusters/clusters.html">Clusters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../http_routes/http_routes.html">HTTP route management</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../../config.html">Extensions</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../../filter.html">Filters</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="../../network.html">Network filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../http/http.html">HTTP filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../accesslog/v2/accesslog.proto.html">Common access log types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../fault/v2/fault.proto.html">Common fault injection types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../accesslog/accesslog.html">Access loggers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../rbac/rbac.html">RBAC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../health_checker/health_checker.html">Health checkers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../transport_socket/transport_socket.html">Transport sockets</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../admin/admin.html">Admin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../data/data.html">Envoy data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../service/service.html">Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../common_messages/common_messages.html">Common messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../types/types.html">Types</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../faq/overview.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../index.html">envoy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../../../api.html">v2 API reference</a> &raquo;</li>
        
          <li><a href="../../../../config.html">Extensions</a> &raquo;</li>
        
          <li><a href="../../../filter.html">Filters</a> &raquo;</li>
        
          <li><a href="../../network.html">Network filters</a> &raquo;</li>
        
      <li>TCP Proxy</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../../../_sources/api-v2/config/filter/network/tcp_proxy/v2/tcp_proxy.proto.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tcp-proxy">
<span id="envoy-api-file-envoy-config-filter-network-tcp-proxy-v2-tcp-proxy-proto"></span><h1>TCP Proxy<a class="headerlink" href="#tcp-proxy" title="Permalink to this headline">¶</a></h1>
<p>TCP Proxy <a class="reference internal" href="../../../../../../configuration/network_filters/tcp_proxy_filter.html#config-network-filters-tcp-proxy"><span class="std std-ref">configuration overview</span></a>.</p>
<div class="section" id="config-filter-network-tcp-proxy-v2-tcpproxy">
<span id="envoy-api-msg-config-filter-network-tcp-proxy-v2-tcpproxy"></span><h2>config.filter.network.tcp_proxy.v2.TcpProxy<a class="headerlink" href="#config-filter-network-tcp-proxy-v2-tcpproxy" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/master/api/envoy/config/filter/network/tcp_proxy/v2/tcp_proxy.proto#L18">[config.filter.network.tcp_proxy.v2.TcpProxy proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;stat_prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;cluster&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;metadata_match&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;idle_timeout&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;access_log&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;deprecated_v1&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;max_connect_attempts&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="docutils" id="envoy-api-field-config-filter-network-tcp-proxy-v2-tcpproxy-stat-prefix">
<dt>stat_prefix</dt>
<dd>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The prefix to use when emitting <a class="reference internal" href="../../../../../../configuration/network_filters/tcp_proxy_filter.html#config-network-filters-tcp-proxy-stats"><span class="std std-ref">statistics</span></a>.</dd>
</dl>
<dl class="docutils" id="envoy-api-field-config-filter-network-tcp-proxy-v2-tcpproxy-cluster">
<dt>cluster</dt>
<dd><p class="first">(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) The upstream cluster to connect to.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Once full filter chain matching is implemented in listeners, this field will become the only
way to configure the target cluster. All other matching will be done via <a class="reference internal" href="../../../../../api/v2/listener/listener.proto.html#envoy-api-msg-listener-filterchainmatch"><span class="std std-ref">filter chain
matching rules</span></a>. For very simple configurations,
this field can still be used to select the cluster when no other matching rules are required.
Otherwise, a <a class="reference internal" href="#envoy-api-field-config-filter-network-tcp-proxy-v2-tcpproxy-deprecated-v1"><span class="std std-ref">deprecated_v1</span></a> configuration is
required to use more complex routing in the interim.</p>
</div>
</dd>
</dl>
<dl class="docutils" id="envoy-api-field-config-filter-network-tcp-proxy-v2-tcpproxy-metadata-match">
<dt>metadata_match</dt>
<dd>(<a class="reference internal" href="../../../../../api/v2/core/base.proto.html#envoy-api-msg-core-metadata"><span class="std std-ref">core.Metadata</span></a>) Optional endpoint metadata match criteria. Only endpoints in the upstream
cluster with metadata matching that set in metadata_match will be
considered. The filter name should be specified as <em>envoy.lb</em>.</dd>
</dl>
<dl class="docutils" id="envoy-api-field-config-filter-network-tcp-proxy-v2-tcpproxy-idle-timeout">
<dt>idle_timeout</dt>
<dd>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) The idle timeout for connections managed by the TCP proxy filter. The idle timeout
is defined as the period in which there are no bytes sent or received on either
the upstream or downstream connection. If not set, connections will never be closed
by the TCP proxy due to being idle.</dd>
</dl>
<dl class="docutils" id="envoy-api-field-config-filter-network-tcp-proxy-v2-tcpproxy-access-log">
<dt>access_log</dt>
<dd>(<a class="reference internal" href="../../../accesslog/v2/accesslog.proto.html#envoy-api-msg-config-filter-accesslog-v2-accesslog"><span class="std std-ref">config.filter.accesslog.v2.AccessLog</span></a>) Configuration for <a class="reference internal" href="../../../../../../intro/arch_overview/access_logging.html#arch-overview-access-logs"><span class="std std-ref">access logs</span></a>
emitted by the this tcp_proxy.</dd>
</dl>
<dl class="docutils" id="envoy-api-field-config-filter-network-tcp-proxy-v2-tcpproxy-deprecated-v1">
<dt>deprecated_v1</dt>
<dd><p class="first">(<a class="reference internal" href="#envoy-api-msg-config-filter-network-tcp-proxy-v2-tcpproxy-deprecatedv1"><span class="std std-ref">config.filter.network.tcp_proxy.v2.TcpProxy.DeprecatedV1</span></a>) TCP Proxy filter configuration using deprecated V1 format. This is required for complex
routing until filter chain matching in the listener is implemented.</p>
<div class="last admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">Using this field will lead to <a class="reference external" href="https://github.com/envoyproxy/envoy/issues/2441">problems loading the configuration</a>. If you want to configure the filter
using v1 config structure, please make this field a boolean with value <code class="docutils literal notranslate"><span class="pre">true</span></code> and configure
via the opaque <code class="docutils literal notranslate"><span class="pre">value</span></code> field like is suggested in <a class="reference external" href="https://github.com/envoyproxy/envoy/blob/master/api/envoy/config/filter/README.md">envoy/config/filter/README.md</a>.</p>
</div>
</dd>
</dl>
<dl class="docutils" id="envoy-api-field-config-filter-network-tcp-proxy-v2-tcpproxy-max-connect-attempts">
<dt>max_connect_attempts</dt>
<dd>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#uint32value">UInt32Value</a>) The maximum number of unsuccessful connection attempts that will be made before
giving up. If the parameter is not specified, 1 connection attempt will be made.</dd>
</dl>
</div>
<div class="section" id="config-filter-network-tcp-proxy-v2-tcpproxy-deprecatedv1">
<span id="envoy-api-msg-config-filter-network-tcp-proxy-v2-tcpproxy-deprecatedv1"></span><h2>config.filter.network.tcp_proxy.v2.TcpProxy.DeprecatedV1<a class="headerlink" href="#config-filter-network-tcp-proxy-v2-tcpproxy-deprecatedv1" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/master/api/envoy/config/filter/network/tcp_proxy/v2/tcp_proxy.proto#L67">[config.filter.network.tcp_proxy.v2.TcpProxy.DeprecatedV1 proto]</a></p>
<p>TCP Proxy filter configuration using V1 format, until Envoy gets the
ability to match source/destination at the listener level (called
<a class="reference internal" href="../../../../../api/v2/listener/listener.proto.html#envoy-api-msg-listener-filterchainmatch"><span class="std std-ref">filter chain match</span></a>).</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;routes&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="docutils" id="envoy-api-field-config-filter-network-tcp-proxy-v2-tcpproxy-deprecatedv1-routes">
<dt>routes</dt>
<dd>(<a class="reference internal" href="#envoy-api-msg-config-filter-network-tcp-proxy-v2-tcpproxy-deprecatedv1-tcproute"><span class="std std-ref">config.filter.network.tcp_proxy.v2.TcpProxy.DeprecatedV1.TCPRoute</span></a>, <em>REQUIRED</em>) The route table for the filter. All filter instances must have a route
table, even if it is empty.</dd>
</dl>
</div>
<div class="section" id="config-filter-network-tcp-proxy-v2-tcpproxy-deprecatedv1-tcproute">
<span id="envoy-api-msg-config-filter-network-tcp-proxy-v2-tcpproxy-deprecatedv1-tcproute"></span><h2>config.filter.network.tcp_proxy.v2.TcpProxy.DeprecatedV1.TCPRoute<a class="headerlink" href="#config-filter-network-tcp-proxy-v2-tcpproxy-deprecatedv1-tcproute" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/master/api/envoy/config/filter/network/tcp_proxy/v2/tcp_proxy.proto#L75">[config.filter.network.tcp_proxy.v2.TcpProxy.DeprecatedV1.TCPRoute proto]</a></p>
<p>A TCP proxy route consists of a set of optional L4 criteria and the
name of a cluster. If a downstream connection matches all the
specified criteria, the cluster in the route is used for the
corresponding upstream connection. Routes are tried in the order
specified until a match is found. If no match is found, the connection
is closed. A route with no criteria is valid and always produces a
match.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;cluster&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;destination_ip_list&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;destination_ports&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;source_ip_list&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;source_ports&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="docutils" id="envoy-api-field-config-filter-network-tcp-proxy-v2-tcpproxy-deprecatedv1-tcproute-cluster">
<dt>cluster</dt>
<dd>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The cluster to connect to when a the downstream network connection
matches the specified criteria.</dd>
</dl>
<dl class="docutils" id="envoy-api-field-config-filter-network-tcp-proxy-v2-tcpproxy-deprecatedv1-tcproute-destination-ip-list">
<dt>destination_ip_list</dt>
<dd>(<a class="reference internal" href="../../../../../api/v2/core/address.proto.html#envoy-api-msg-core-cidrrange"><span class="std std-ref">core.CidrRange</span></a>) An optional list of IP address subnets in the form
“ip_address/xx”. The criteria is satisfied if the destination IP
address of the downstream connection is contained in at least one of
the specified subnets. If the parameter is not specified or the list
is empty, the destination IP address is ignored. The destination IP
address of the downstream connection might be different from the
addresses on which the proxy is listening if the connection has been
redirected.</dd>
</dl>
<dl class="docutils" id="envoy-api-field-config-filter-network-tcp-proxy-v2-tcpproxy-deprecatedv1-tcproute-destination-ports">
<dt>destination_ports</dt>
<dd>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) An optional string containing a comma-separated list of port numbers
or ranges. The criteria is satisfied if the destination port of the
downstream connection is contained in at least one of the specified
ranges. If the parameter is not specified, the destination port is
ignored. The destination port address of the downstream connection
might be different from the port on which the proxy is listening if
the connection has been redirected.</dd>
</dl>
<dl class="docutils" id="envoy-api-field-config-filter-network-tcp-proxy-v2-tcpproxy-deprecatedv1-tcproute-source-ip-list">
<dt>source_ip_list</dt>
<dd>(<a class="reference internal" href="../../../../../api/v2/core/address.proto.html#envoy-api-msg-core-cidrrange"><span class="std std-ref">core.CidrRange</span></a>) An optional list of IP address subnets in the form
“ip_address/xx”. The criteria is satisfied if the source IP address
of the downstream connection is contained in at least one of the
specified subnets. If the parameter is not specified or the list is
empty, the source IP address is ignored.</dd>
</dl>
<dl class="docutils" id="envoy-api-field-config-filter-network-tcp-proxy-v2-tcpproxy-deprecatedv1-tcproute-source-ports">
<dt>source_ports</dt>
<dd>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) An optional string containing a comma-separated list of port numbers
or ranges. The criteria is satisfied if the source port of the
downstream connection is contained in at least one of the specified
ranges. If the parameter is not specified, the source port is
ignored.</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../../http/http.html" class="btn btn-neutral float-right" title="HTTP filters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../../redis_proxy/v2/redis_proxy.proto.html" class="btn btn-neutral" title="Redis Proxy" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2018, Envoy Project Authors.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../../../',
            VERSION:'tag-v1.7.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../../../../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>