

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>JWT Authentication &mdash; envoy 1.17.0-5c801b documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/envoy.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/sphinx_tabs/semantic-ui-2.4.1/segment.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/sphinx_tabs/semantic-ui-2.4.1/menu.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/sphinx_tabs/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
        <script src="../../../_static/clipboard.min.js"></script>
        <script src="../../../_static/copybutton.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Kill Request" href="kill_request_filter.html" />
    <link rel="prev" title="IP Tagging" href="ip_tagging_filter.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html">
          

          
            
            <img src="../../../_static/envoy-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.17.0-5c801b
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../start/start.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../configuration.html">Configuration reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../overview/overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../listeners/listeners.html">Listeners</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../http.html">HTTP</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../http_conn_man/http_conn_man.html">HTTP connection manager</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="http_filters.html">HTTP filters</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="adaptive_concurrency_filter.html">Adaptive Concurrency</a></li>
<li class="toctree-l4"><a class="reference internal" href="admission_control_filter.html">Admission Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="aws_lambda_filter.html">AWS Lambda</a></li>
<li class="toctree-l4"><a class="reference internal" href="aws_request_signing_filter.html">AWS Request Signing</a></li>
<li class="toctree-l4"><a class="reference internal" href="buffer_filter.html">Buffer</a></li>
<li class="toctree-l4"><a class="reference internal" href="cdn_loop_filter.html">CDN-Loop header</a></li>
<li class="toctree-l4"><a class="reference internal" href="compressor_filter.html">Compressor</a></li>
<li class="toctree-l4"><a class="reference internal" href="cors_filter.html">CORS</a></li>
<li class="toctree-l4"><a class="reference internal" href="csrf_filter.html">CSRF</a></li>
<li class="toctree-l4"><a class="reference internal" href="decompressor_filter.html">Decompressor</a></li>
<li class="toctree-l4"><a class="reference internal" href="dynamic_forward_proxy_filter.html">Dynamic forward proxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="dynamodb_filter.html">DynamoDB</a></li>
<li class="toctree-l4"><a class="reference internal" href="ext_authz_filter.html">External Authorization</a></li>
<li class="toctree-l4"><a class="reference internal" href="ext_proc_filter.html">External Processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="fault_filter.html">Fault Injection</a></li>
<li class="toctree-l4"><a class="reference internal" href="grpc_http1_bridge_filter.html">gRPC HTTP/1.1 bridge</a></li>
<li class="toctree-l4"><a class="reference internal" href="grpc_http1_reverse_bridge_filter.html">gRPC HTTP/1.1 reverse bridge</a></li>
<li class="toctree-l4"><a class="reference internal" href="grpc_json_transcoder_filter.html">gRPC-JSON transcoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="grpc_stats_filter.html">gRPC Statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="grpc_web_filter.html">gRPC-Web</a></li>
<li class="toctree-l4"><a class="reference internal" href="gzip_filter.html">Gzip</a></li>
<li class="toctree-l4"><a class="reference internal" href="health_check_filter.html">Health check</a></li>
<li class="toctree-l4"><a class="reference internal" href="header_to_metadata_filter.html">Envoy Header-To-Metadata Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="ip_tagging_filter.html">IP Tagging</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">JWT Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="kill_request_filter.html">Kill Request</a></li>
<li class="toctree-l4"><a class="reference internal" href="local_rate_limit_filter.html">Local rate limit</a></li>
<li class="toctree-l4"><a class="reference internal" href="lua_filter.html">Lua</a></li>
<li class="toctree-l4"><a class="reference internal" href="oauth2_filter.html">OAuth2</a></li>
<li class="toctree-l4"><a class="reference internal" href="on_demand_updates_filter.html">On-demand VHDS and S/RDS Updates</a></li>
<li class="toctree-l4"><a class="reference internal" href="original_src_filter.html">Original Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="rate_limit_filter.html">Rate limit</a></li>
<li class="toctree-l4"><a class="reference internal" href="rbac_filter.html">Role Based Access Control (RBAC) Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="router_filter.html">Router</a></li>
<li class="toctree-l4"><a class="reference internal" href="squash_filter.html">Squash</a></li>
<li class="toctree-l4"><a class="reference internal" href="tap_filter.html">Tap</a></li>
<li class="toctree-l4"><a class="reference internal" href="wasm_filter.html">Wasm</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../upstream/upstream.html">Upstream clusters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../observability/observability.html">Observability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../security/security.html">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../operations/operations.html">Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../other_features/other_features.html">Other features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../other_protocols/other_protocols.html">Other protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/advanced.html">Advanced</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../best_practices/best_practices.html">Configuration best practices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/overview.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../version_history/version_history.html">Version history</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">envoy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../configuration.html">Configuration reference</a> &raquo;</li>
        
          <li><a href="../http.html">HTTP</a> &raquo;</li>
        
          <li><a href="http_filters.html">HTTP filters</a> &raquo;</li>
        
      <li>JWT Authentication</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/configuration/http/http_filters/jwt_authn_filter.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="jwt-authentication">
<span id="config-http-filters-jwt-authn"></span><h1>JWT Authentication<a class="headerlink" href="#jwt-authentication" title="Permalink to this headline">¶</a></h1>
<p>This HTTP filter can be used to verify JSON Web Token (JWT). It will verify its signature, audiences and issuer. It will also check its time restrictions, such as expiration and nbf (not before) time. If the JWT verification fails, its request will be rejected. If the JWT verification succeeds, its payload can be forwarded to the upstream for further authorization if desired.</p>
<p>JWKS is needed to verify JWT signatures. They can be specified in the filter config or can be fetched remotely from a JWKS server.</p>
<p>Following are supported JWT alg:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ES256</span><span class="p">,</span> <span class="n">ES384</span><span class="p">,</span> <span class="n">ES512</span><span class="p">,</span>
<span class="n">HS256</span><span class="p">,</span> <span class="n">HS384</span><span class="p">,</span> <span class="n">HS512</span><span class="p">,</span>
<span class="n">RS256</span><span class="p">,</span> <span class="n">RS384</span><span class="p">,</span> <span class="n">RS512</span><span class="p">,</span>
<span class="n">PS256</span><span class="p">,</span> <span class="n">PS384</span><span class="p">,</span> <span class="n">PS512</span><span class="p">,</span>
<span class="n">EdDSA</span>
</pre></div>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>This filter should be configured with the name <em>envoy.filters.http.jwt_authn</em>.</p>
<p>This HTTP <a class="reference internal" href="../../../api-v3/extensions/filters/http/jwt_authn/v3/config.proto.html#envoy-v3-api-msg-extensions-filters-http-jwt-authn-v3-jwtauthentication"><span class="std std-ref">filter config</span></a> has two fields:</p>
<ul class="simple">
<li><p>Field <em>providers</em> specifies how a JWT should be verified, such as where to extract the token, where to fetch the public key (JWKS) and where to output its payload.</p></li>
<li><p>Field <em>rules</em> specifies matching rules and their requirements. If a request matches a rule, its requirement applies. The requirement specifies which JWT providers should be used.</p></li>
</ul>
<div class="section" id="jwtprovider">
<h3>JwtProvider<a class="headerlink" href="#jwtprovider" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../../../api-v3/extensions/filters/http/jwt_authn/v3/config.proto.html#envoy-v3-api-msg-extensions-filters-http-jwt-authn-v3-jwtprovider"><span class="std std-ref">JwtProvider</span></a> specifies how a JWT should be verified. It has the following fields:</p>
<ul class="simple">
<li><p><em>issuer</em>: the principal that issued the JWT, usually a URL or an email address.</p></li>
<li><p><em>audiences</em>: a list of JWT audiences allowed to access. A JWT containing any of these audiences will be accepted.
If not specified, the audiences in JWT will not be checked.</p></li>
<li><p><em>local_jwks</em>: fetch JWKS in local data source, either in a local file or embedded in the inline string.</p></li>
<li><p><em>remote_jwks</em>: fetch JWKS from a remote HTTP server, also specify cache duration.</p></li>
<li><p><em>forward</em>: if true, JWT will be forwarded to the upstream.</p></li>
<li><p><em>from_headers</em>: extract JWT from HTTP headers.</p></li>
<li><p><em>from_params</em>: extract JWT from query parameters.</p></li>
<li><p><em>forward_payload_header</em>: forward the JWT payload in the specified HTTP header.</p></li>
</ul>
</div>
<div class="section" id="default-extract-location">
<h3>Default Extract Location<a class="headerlink" href="#default-extract-location" title="Permalink to this headline">¶</a></h3>
<p>If <em>from_headers</em> and <em>from_params</em> is empty,  the default location to extract JWT is from HTTP header:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Authorization</span><span class="p">:</span> <span class="n">Bearer</span> <span class="o">&lt;</span><span class="n">token</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>and query parameter key <em>access_token</em> as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/path?access_token=&lt;JWT&gt;
</pre></div>
</div>
<p>If a request has two tokens, one from the header and the other from the query parameter, all of them must be valid.</p>
<p>In the <a class="reference internal" href="../../../api-v3/extensions/filters/http/jwt_authn/v3/config.proto.html#envoy-v3-api-msg-extensions-filters-http-jwt-authn-v3-jwtauthentication"><span class="std std-ref">filter config</span></a>, <em>providers</em> is a map, to map <em>provider_name</em> to a <a class="reference internal" href="../../../api-v3/extensions/filters/http/jwt_authn/v3/config.proto.html#envoy-v3-api-msg-extensions-filters-http-jwt-authn-v3-jwtprovider"><span class="std std-ref">JwtProvider</span></a>. The <em>provider_name</em> must be unique, it is referred in the <cite>JwtRequirement &lt;envoy_v3_api_msg_extensions.filters.http.jwt_authn.v3.JwtRequirement&gt;</cite> in its <em>provider_name</em> field.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>For <em>remote_jwks</em>, a <strong>jwks_cluster</strong> cluster is required.</p>
</div>
<p>Due to above requirement, <a class="reference external" href="https://openid.net/specs/openid-connect-discovery-1_0.html">OpenID Connect Discovery</a> is not supported since the URL to fetch JWKS is in the response of the discovery. It is not easy to setup a cluster config for a dynamic URL.</p>
</div>
<div class="section" id="remote-jwks-config-example">
<h3>Remote JWKS config example<a class="headerlink" href="#remote-jwks-config-example" title="Permalink to this headline">¶</a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">providers</span><span class="p">:</span>
  <span class="nt">provider_name1</span><span class="p">:</span>
    <span class="nt">issuer</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://example.com</span>
    <span class="nt">audiences</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bookstore_android.apps.googleusercontent.com</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">bookstore_web.apps.googleusercontent.com</span>
    <span class="nt">remote_jwks</span><span class="p">:</span>
      <span class="nt">http_uri</span><span class="p">:</span>
        <span class="nt">uri</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://example.com/jwks.json</span>
        <span class="nt">cluster</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">example_jwks_cluster</span>
        <span class="nt">timeout</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1s</span>
      <span class="nt">cache_duration</span><span class="p">:</span>
        <span class="nt">seconds</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">300</span>
</pre></div>
</div>
<p>Above example fetches JWSK from a remote server with URL <a class="reference external" href="https://example.com/jwks.json">https://example.com/jwks.json</a>. The token will be extracted from the default extract locations. The token will not be forwarded to upstream. JWT payload will not be added to the request header.</p>
<p>Following cluster <strong>example_jwks_cluster</strong> is needed to fetch JWKS.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">cluster</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">example_jwks_cluster</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">STRICT_DNS</span>
  <span class="nt">load_assignment</span><span class="p">:</span>
    <span class="nt">cluster_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">example_jwks_cluster</span>
    <span class="nt">endpoints</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">lb_endpoints</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">endpoint</span><span class="p">:</span>
          <span class="nt">address</span><span class="p">:</span>
            <span class="nt">socket_address</span><span class="p">:</span>
              <span class="nt">address</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">example.com</span>
              <span class="nt">port_value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">443</span>
  <span class="nt">transport_socket</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">envoy.transport_sockets.tls</span>
</pre></div>
</div>
</div>
<div class="section" id="inline-jwks-config-example">
<h3>Inline JWKS config example<a class="headerlink" href="#inline-jwks-config-example" title="Permalink to this headline">¶</a></h3>
<p>Another config example using inline JWKS:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">providers</span><span class="p">:</span>
  <span class="nt">provider_name2</span><span class="p">:</span>
    <span class="nt">issuer</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://example2.com</span>
    <span class="nt">local_jwks</span><span class="p">:</span>
      <span class="nt">inline_string</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">PUBLIC-KEY</span>
    <span class="nt">from_headers</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">jwt-assertion</span>
    <span class="nt">forward</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="nt">forward_payload_header</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">x-jwt-payload</span>
</pre></div>
</div>
<p>Above example uses config inline string to specify JWKS. The JWT token will be extracted from HTTP headers as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jwt</span><span class="o">-</span><span class="n">assertion</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">JWT</span><span class="o">&gt;.</span>
</pre></div>
</div>
<p>JWT payload will be added to the request header as following format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">-</span><span class="n">jwt</span><span class="o">-</span><span class="n">payload</span><span class="p">:</span> <span class="n">base64url_encoded</span><span class="p">(</span><span class="n">jwt_payload_in_JSON</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="requirementrule">
<h3>RequirementRule<a class="headerlink" href="#requirementrule" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../../../api-v3/extensions/filters/http/jwt_authn/v3/config.proto.html#envoy-v3-api-msg-extensions-filters-http-jwt-authn-v3-requirementrule"><span class="std std-ref">RequirementRule</span></a> has two fields:</p>
<ul class="simple">
<li><p>Field <em>match</em> specifies how a request can be matched; e.g. by HTTP headers, or by query parameters, or by path prefixes.</p></li>
<li><p>Field <em>requires</em> specifies the JWT requirement, e.g. which provider is required.</p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<ul class="simple">
<li><p><strong>If a request matches multiple rules, the first matched rule will apply</strong>.</p></li>
<li><p>If the matched rule has empty <em>requires</em> field, <strong>JWT verification is not required</strong>.</p></li>
<li><p>If a request doesn’t match any rules, <strong>JWT verification is not required</strong>.</p></li>
</ul>
</div>
</div>
<div class="section" id="single-requirement-config-example">
<h3>Single requirement config example<a class="headerlink" href="#single-requirement-config-example" title="Permalink to this headline">¶</a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">providers</span><span class="p">:</span>
  <span class="nt">jwt_provider1</span><span class="p">:</span>
    <span class="nt">issuer</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://example.com</span>
    <span class="nt">audiences</span><span class="p">:</span>
      <span class="l l-Scalar l-Scalar-Plain">audience1</span>
    <span class="nt">local_jwks</span><span class="p">:</span>
      <span class="nt">inline_string</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">PUBLIC-KEY</span>
<span class="nt">rules</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">match</span><span class="p">:</span>
    <span class="nt">prefix</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/health</span>
<span class="p p-Indicator">-</span> <span class="nt">match</span><span class="p">:</span>
    <span class="nt">prefix</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/api</span>
  <span class="nt">requires</span><span class="p">:</span>
    <span class="nt">provider_and_audiences</span><span class="p">:</span>
      <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">jwt_provider1</span>
      <span class="nt">audiences</span><span class="p">:</span>
        <span class="l l-Scalar l-Scalar-Plain">api_audience</span>
<span class="p p-Indicator">-</span> <span class="nt">match</span><span class="p">:</span>
    <span class="nt">prefix</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
  <span class="nt">requires</span><span class="p">:</span>
    <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">jwt_provider1</span>
</pre></div>
</div>
<p>Above config uses single requirement rule, each rule may have either an empty requirement or a single requirement with one provider name.</p>
</div>
<div class="section" id="group-requirement-config-example">
<h3>Group requirement config example<a class="headerlink" href="#group-requirement-config-example" title="Permalink to this headline">¶</a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">providers</span><span class="p">:</span>
  <span class="nt">provider1</span><span class="p">:</span>
    <span class="nt">issuer</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://provider1.com</span>
    <span class="nt">local_jwks</span><span class="p">:</span>
      <span class="nt">inline_string</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">PUBLIC-KEY</span>
  <span class="nt">provider2</span><span class="p">:</span>
    <span class="nt">issuer</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">https://provider2.com</span>
    <span class="nt">local_jwks</span><span class="p">:</span>
      <span class="nt">inline_string</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">PUBLIC-KEY</span>
<span class="nt">rules</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">match</span><span class="p">:</span>
    <span class="nt">prefix</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/any</span>
  <span class="nt">requires</span><span class="p">:</span>
    <span class="nt">requires_any</span><span class="p">:</span>
      <span class="nt">requirements</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider1</span>
      <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider2</span>
<span class="p p-Indicator">-</span> <span class="nt">match</span><span class="p">:</span>
    <span class="nt">prefix</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/all</span>
  <span class="nt">requires</span><span class="p">:</span>
    <span class="nt">requires_all</span><span class="p">:</span>
      <span class="nt">requirements</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider1</span>
      <span class="p p-Indicator">-</span> <span class="nt">provider_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">provider2</span>
</pre></div>
</div>
<p>Above config uses more complex <em>group</em> requirements:</p>
<ul class="simple">
<li><p>The first <em>rule</em> specifies <em>requires_any</em>; if any of <strong>provider1</strong> or <strong>provider2</strong> requirement is satisfied, the request is OK to proceed.</p></li>
<li><p>The second <em>rule</em> specifies <em>requires_all</em>; only if both <strong>provider1</strong> and <strong>provider2</strong> requirements are satisfied, the request is OK to proceed.</p></li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="kill_request_filter.html" class="btn btn-neutral float-right" title="Kill Request" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ip_tagging_filter.html" class="btn btn-neutral float-left" title="IP Tagging" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2016-2021, Envoy Project Authors

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>