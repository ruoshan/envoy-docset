

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Redis &mdash; envoy 1.17.0-5c801b documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/envoy.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/sphinx_tabs/semantic-ui-2.4.1/segment.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/sphinx_tabs/semantic-ui-2.4.1/menu.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/sphinx_tabs/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
        <script src="../../../_static/clipboard.min.js"></script>
        <script src="../../../_static/copybutton.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Postgres" href="postgres.html" />
    <link rel="prev" title="DynamoDB" href="dynamo.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html">
          

          
            
            <img src="../../../_static/envoy-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.17.0-5c801b
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../intro.html">Introduction</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../what_is_envoy.html">What is Envoy</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../arch_overview.html">Architecture overview</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../intro/intro.html">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../listeners/listeners_toc.html">Listeners</a></li>
<li class="toctree-l3"><a class="reference internal" href="../http/http.html">HTTP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upstream/upstream.html">Upstream clusters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../observability/observability.html">Observability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/security.html">Security</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operations/operations.html">Operations &amp; configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../other_features/other_features.html">Other features</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="other_protocols.html">Other protocols</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="grpc.html">gRPC</a></li>
<li class="toctree-l4"><a class="reference internal" href="mongo.html">MongoDB</a></li>
<li class="toctree-l4"><a class="reference internal" href="dynamo.html">DynamoDB</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Redis</a></li>
<li class="toctree-l4"><a class="reference internal" href="postgres.html">Postgres</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../advanced/advanced.html">Advanced</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../life_of_a_request.html">Life of a Request</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../deployment_types/deployment_types.html">Deployment types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_help.html">Getting help</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../start/start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../configuration/configuration.html">Configuration reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/overview.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../version_history/version_history.html">Version history</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">envoy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../intro.html">Introduction</a> &raquo;</li>
        
          <li><a href="../arch_overview.html">Architecture overview</a> &raquo;</li>
        
          <li><a href="other_protocols.html">Other protocols</a> &raquo;</li>
        
      <li>Redis</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/intro/arch_overview/other_protocols/redis.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="redis">
<span id="arch-overview-redis"></span><h1>Redis<a class="headerlink" href="#redis" title="Permalink to this headline">¶</a></h1>
<p>Envoy can act as a Redis proxy, partitioning commands among instances in a cluster.
In this mode, the goals of Envoy are to maintain availability and partition tolerance
over consistency. This is the key point when comparing Envoy to <a class="reference external" href="https://redis.io/topics/cluster-spec">Redis Cluster</a>. Envoy is designed as a best-effort cache,
meaning that it will not try to reconcile inconsistent data or keep a globally consistent
view of cluster membership. It also supports routing commands from different workload to
different to different upstream clusters based on their access patterns, eviction, or isolation
requirements.</p>
<p>The Redis project offers a thorough reference on partitioning as it relates to Redis. See
“<a class="reference external" href="https://redis.io/topics/partitioning">Partitioning: how to split data among multiple Redis instances</a>”.</p>
<p><strong>Features of Envoy Redis</strong>:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://redis.io/topics/protocol">Redis protocol</a> codec.</p></li>
<li><p>Hash-based partitioning.</p></li>
<li><p>Ketama distribution.</p></li>
<li><p>Detailed command statistics.</p></li>
<li><p>Active and passive healthchecking.</p></li>
<li><p>Hash tagging.</p></li>
<li><p>Prefix routing.</p></li>
<li><p>Separate downstream client and upstream server authentication.</p></li>
<li><p>Request mirroring for all requests or write requests only.</p></li>
<li><p>Control <a class="reference internal" href="../../../api-v3/extensions/filters/network/redis_proxy/v3/redis_proxy.proto.html#envoy-v3-api-field-extensions-filters-network-redis-proxy-v3-redisproxy-connpoolsettings-read-policy"><span class="std std-ref">read requests routing</span></a>. This only works with Redis Cluster.</p></li>
</ul>
<p><strong>Planned future enhancements</strong>:</p>
<ul class="simple">
<li><p>Additional timing stats.</p></li>
<li><p>Circuit breaking.</p></li>
<li><p>Request collapsing for fragmented commands.</p></li>
<li><p>Replication.</p></li>
<li><p>Built-in retry.</p></li>
<li><p>Tracing.</p></li>
</ul>
<div class="section" id="configuration">
<span id="arch-overview-redis-configuration"></span><h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>For filter configuration details, see the Redis proxy filter
<a class="reference internal" href="../../../configuration/listeners/network_filters/redis_proxy_filter.html#config-network-filters-redis-proxy"><span class="std std-ref">configuration reference</span></a>.</p>
<p>The corresponding cluster definition should be configured with
<a class="reference internal" href="../../../api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-lb-policy"><span class="std std-ref">ring hash load balancing</span></a>.</p>
<p>If <a class="reference internal" href="../upstream/health_checking.html#arch-overview-health-checking"><span class="std std-ref">active health checking</span></a> is desired, the
cluster should be configured with a <a class="reference internal" href="../../../api-v3/config/core/v3/health_check.proto.html#envoy-v3-api-field-config-core-v3-healthcheck-custom-health-check"><span class="std std-ref">custom health check</span></a> which configured as a
<a class="reference internal" href="../../../configuration/upstream/health_checkers/redis.html#config-health-checkers-redis"><span class="std std-ref">Redis health checker</span></a>.</p>
<p>If passive healthchecking is desired, also configure
<a class="reference internal" href="../upstream/outlier.html#arch-overview-outlier-detection"><span class="std std-ref">outlier detection</span></a>.</p>
<p>For the purposes of passive healthchecking, connect timeouts, command timeouts, and connection
close map to 5xx. All other responses from Redis are counted as a success.</p>
</div>
<div class="section" id="redis-cluster-support-experimental">
<span id="arch-overview-redis-cluster-support"></span><h2>Redis Cluster Support (Experimental)<a class="headerlink" href="#redis-cluster-support-experimental" title="Permalink to this headline">¶</a></h2>
<p>Envoy currently offers experimental support for <a class="reference external" href="https://redis.io/topics/cluster-spec">Redis Cluster</a>.</p>
<p>When using Envoy as a sidecar proxy for a Redis Cluster, the service can use a non-cluster Redis client
implemented in any language to connect to the proxy as if it’s a single node Redis instance.
The Envoy proxy will keep track of the cluster topology and send commands to the correct Redis node in the
cluster according to the <a class="reference external" href="https://redis.io/topics/cluster-spec">spec</a>. Advance features such as reading
from replicas can also be added to the Envoy proxy instead of updating redis clients in each language.</p>
<p>Envoy proxy tracks the topology of the cluster by sending periodic
<a class="reference external" href="https://redis.io/commands/cluster-slots">cluster slots</a> commands to a random node in the cluster, and maintains the
following information:</p>
<ul class="simple">
<li><p>List of known nodes.</p></li>
<li><p>The primaries for each shard.</p></li>
<li><p>Nodes entering or leaving the cluster.</p></li>
</ul>
<p>For topology configuration details, see the Redis Cluster
<a class="reference internal" href="../../../api-v3/extensions/clusters/redis/v3/redis_cluster.proto.html#envoy-v3-api-msg-extensions-clusters-redis-v3-redisclusterconfig"><span class="std std-ref">v3 API reference</span></a>.</p>
<p>Every Redis cluster has its own extra statistics tree rooted at <em>cluster.&lt;name&gt;.redis_cluster.</em> with the following statistics:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_upstream_unknown_connections_reached</p></td>
<td><p>Counter</p></td>
<td><p>Total number of times that an upstream connection to an unknown host is not created after redirection having reached the connection pool’s max_upstream_unknown_connections limit</p></td>
</tr>
<tr class="row-odd"><td><p>upstream_cx_drained</p></td>
<td><p>Counter</p></td>
<td><p>Total number of upstream connections drained of active requests before being closed</p></td>
</tr>
<tr class="row-even"><td><p>upstream_commands.upstream_rq_time</p></td>
<td><p>Histogram</p></td>
<td><p>Histogram of upstream request times for all types of requests</p></td>
</tr>
</tbody>
</table>
<p id="arch-overview-redis-cluster-command-stats">Per-cluster command statistics can be enabled via the setting <a class="reference internal" href="../../../api-v3/extensions/filters/network/redis_proxy/v3/redis_proxy.proto.html#envoy-v3-api-field-extensions-filters-network-redis-proxy-v3-redisproxy-connpoolsettings-enable-command-stats"><span class="std std-ref">enable_command_stats</span></a>.:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>upstream_commands.[command].success</p></td>
<td><p>Counter</p></td>
<td><p>Total number of successful requests for a specific Redis command</p></td>
</tr>
<tr class="row-odd"><td><p>upstream_commands.[command].failure</p></td>
<td><p>Counter</p></td>
<td><p>Total number of failed or cancelled requests for a specific Redis command</p></td>
</tr>
<tr class="row-even"><td><p>upstream_commands.[command].total</p></td>
<td><p>Counter</p></td>
<td><p>Total number of requests for a specific Redis command (sum of success and failure)</p></td>
</tr>
<tr class="row-odd"><td><p>upstream_commands.[command].latency</p></td>
<td><p>Histogram</p></td>
<td><p>Latency of requests for a specific Redis command</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="supported-commands">
<h2>Supported commands<a class="headerlink" href="#supported-commands" title="Permalink to this headline">¶</a></h2>
<p>At the protocol level, pipelines are supported. MULTI (transaction block) is not.
Use pipelining wherever possible for the best performance.</p>
<p>At the command level, Envoy only supports commands that can be reliably hashed to a server. AUTH and PING
are the only exceptions. AUTH is processed locally by Envoy if a downstream password has been configured,
and no other commands will be processed until authentication is successful when a password has been
configured. Envoy will transparently issue AUTH commands upon connecting to upstream servers, if upstream
authentication passwords are configured for the cluster. Envoy responds to PING immediately with PONG.
Arguments to PING are not allowed. All other supported commands must contain a key. Supported commands are
functionally identical to the original Redis command except possibly in failure scenarios.</p>
<p>For details on each command’s usage see the official
<a class="reference external" href="https://redis.io/commands">Redis command reference</a>.</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Group</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>AUTH</p></td>
<td><p>Authentication</p></td>
</tr>
<tr class="row-odd"><td><p>PING</p></td>
<td><p>Connection</p></td>
</tr>
<tr class="row-even"><td><p>DEL</p></td>
<td><p>Generic</p></td>
</tr>
<tr class="row-odd"><td><p>DUMP</p></td>
<td><p>Generic</p></td>
</tr>
<tr class="row-even"><td><p>EXISTS</p></td>
<td><p>Generic</p></td>
</tr>
<tr class="row-odd"><td><p>EXPIRE</p></td>
<td><p>Generic</p></td>
</tr>
<tr class="row-even"><td><p>EXPIREAT</p></td>
<td><p>Generic</p></td>
</tr>
<tr class="row-odd"><td><p>PERSIST</p></td>
<td><p>Generic</p></td>
</tr>
<tr class="row-even"><td><p>PEXPIRE</p></td>
<td><p>Generic</p></td>
</tr>
<tr class="row-odd"><td><p>PEXPIREAT</p></td>
<td><p>Generic</p></td>
</tr>
<tr class="row-even"><td><p>PTTL</p></td>
<td><p>Generic</p></td>
</tr>
<tr class="row-odd"><td><p>RESTORE</p></td>
<td><p>Generic</p></td>
</tr>
<tr class="row-even"><td><p>TOUCH</p></td>
<td><p>Generic</p></td>
</tr>
<tr class="row-odd"><td><p>TTL</p></td>
<td><p>Generic</p></td>
</tr>
<tr class="row-even"><td><p>TYPE</p></td>
<td><p>Generic</p></td>
</tr>
<tr class="row-odd"><td><p>UNLINK</p></td>
<td><p>Generic</p></td>
</tr>
<tr class="row-even"><td><p>GEOADD</p></td>
<td><p>Geo</p></td>
</tr>
<tr class="row-odd"><td><p>GEODIST</p></td>
<td><p>Geo</p></td>
</tr>
<tr class="row-even"><td><p>GEOHASH</p></td>
<td><p>Geo</p></td>
</tr>
<tr class="row-odd"><td><p>GEOPOS</p></td>
<td><p>Geo</p></td>
</tr>
<tr class="row-even"><td><p>GEORADIUS_RO</p></td>
<td><p>Geo</p></td>
</tr>
<tr class="row-odd"><td><p>GEORADIUSBYMEMBER_RO</p></td>
<td><p>Geo</p></td>
</tr>
<tr class="row-even"><td><p>HDEL</p></td>
<td><p>Hash</p></td>
</tr>
<tr class="row-odd"><td><p>HEXISTS</p></td>
<td><p>Hash</p></td>
</tr>
<tr class="row-even"><td><p>HGET</p></td>
<td><p>Hash</p></td>
</tr>
<tr class="row-odd"><td><p>HGETALL</p></td>
<td><p>Hash</p></td>
</tr>
<tr class="row-even"><td><p>HINCRBY</p></td>
<td><p>Hash</p></td>
</tr>
<tr class="row-odd"><td><p>HINCRBYFLOAT</p></td>
<td><p>Hash</p></td>
</tr>
<tr class="row-even"><td><p>HKEYS</p></td>
<td><p>Hash</p></td>
</tr>
<tr class="row-odd"><td><p>HLEN</p></td>
<td><p>Hash</p></td>
</tr>
<tr class="row-even"><td><p>HMGET</p></td>
<td><p>Hash</p></td>
</tr>
<tr class="row-odd"><td><p>HMSET</p></td>
<td><p>Hash</p></td>
</tr>
<tr class="row-even"><td><p>HSCAN</p></td>
<td><p>Hash</p></td>
</tr>
<tr class="row-odd"><td><p>HSET</p></td>
<td><p>Hash</p></td>
</tr>
<tr class="row-even"><td><p>HSETNX</p></td>
<td><p>Hash</p></td>
</tr>
<tr class="row-odd"><td><p>HSTRLEN</p></td>
<td><p>Hash</p></td>
</tr>
<tr class="row-even"><td><p>HVALS</p></td>
<td><p>Hash</p></td>
</tr>
<tr class="row-odd"><td><p>LINDEX</p></td>
<td><p>List</p></td>
</tr>
<tr class="row-even"><td><p>LINSERT</p></td>
<td><p>List</p></td>
</tr>
<tr class="row-odd"><td><p>LLEN</p></td>
<td><p>List</p></td>
</tr>
<tr class="row-even"><td><p>LPOP</p></td>
<td><p>List</p></td>
</tr>
<tr class="row-odd"><td><p>LPUSH</p></td>
<td><p>List</p></td>
</tr>
<tr class="row-even"><td><p>LPUSHX</p></td>
<td><p>List</p></td>
</tr>
<tr class="row-odd"><td><p>LRANGE</p></td>
<td><p>List</p></td>
</tr>
<tr class="row-even"><td><p>LREM</p></td>
<td><p>List</p></td>
</tr>
<tr class="row-odd"><td><p>LSET</p></td>
<td><p>List</p></td>
</tr>
<tr class="row-even"><td><p>LTRIM</p></td>
<td><p>List</p></td>
</tr>
<tr class="row-odd"><td><p>RPOP</p></td>
<td><p>List</p></td>
</tr>
<tr class="row-even"><td><p>RPUSH</p></td>
<td><p>List</p></td>
</tr>
<tr class="row-odd"><td><p>RPUSHX</p></td>
<td><p>List</p></td>
</tr>
<tr class="row-even"><td><p>EVAL</p></td>
<td><p>Scripting</p></td>
</tr>
<tr class="row-odd"><td><p>EVALSHA</p></td>
<td><p>Scripting</p></td>
</tr>
<tr class="row-even"><td><p>SADD</p></td>
<td><p>Set</p></td>
</tr>
<tr class="row-odd"><td><p>SCARD</p></td>
<td><p>Set</p></td>
</tr>
<tr class="row-even"><td><p>SISMEMBER</p></td>
<td><p>Set</p></td>
</tr>
<tr class="row-odd"><td><p>SMEMBERS</p></td>
<td><p>Set</p></td>
</tr>
<tr class="row-even"><td><p>SPOP</p></td>
<td><p>Set</p></td>
</tr>
<tr class="row-odd"><td><p>SRANDMEMBER</p></td>
<td><p>Set</p></td>
</tr>
<tr class="row-even"><td><p>SREM</p></td>
<td><p>Set</p></td>
</tr>
<tr class="row-odd"><td><p>SSCAN</p></td>
<td><p>Set</p></td>
</tr>
<tr class="row-even"><td><p>ZADD</p></td>
<td><p>Sorted Set</p></td>
</tr>
<tr class="row-odd"><td><p>ZCARD</p></td>
<td><p>Sorted Set</p></td>
</tr>
<tr class="row-even"><td><p>ZCOUNT</p></td>
<td><p>Sorted Set</p></td>
</tr>
<tr class="row-odd"><td><p>ZINCRBY</p></td>
<td><p>Sorted Set</p></td>
</tr>
<tr class="row-even"><td><p>ZLEXCOUNT</p></td>
<td><p>Sorted Set</p></td>
</tr>
<tr class="row-odd"><td><p>ZRANGE</p></td>
<td><p>Sorted Set</p></td>
</tr>
<tr class="row-even"><td><p>ZRANGEBYLEX</p></td>
<td><p>Sorted Set</p></td>
</tr>
<tr class="row-odd"><td><p>ZRANGEBYSCORE</p></td>
<td><p>Sorted Set</p></td>
</tr>
<tr class="row-even"><td><p>ZRANK</p></td>
<td><p>Sorted Set</p></td>
</tr>
<tr class="row-odd"><td><p>ZREM</p></td>
<td><p>Sorted Set</p></td>
</tr>
<tr class="row-even"><td><p>ZREMRANGEBYLEX</p></td>
<td><p>Sorted Set</p></td>
</tr>
<tr class="row-odd"><td><p>ZREMRANGEBYRANK</p></td>
<td><p>Sorted Set</p></td>
</tr>
<tr class="row-even"><td><p>ZREMRANGEBYSCORE</p></td>
<td><p>Sorted Set</p></td>
</tr>
<tr class="row-odd"><td><p>ZREVRANGE</p></td>
<td><p>Sorted Set</p></td>
</tr>
<tr class="row-even"><td><p>ZREVRANGEBYLEX</p></td>
<td><p>Sorted Set</p></td>
</tr>
<tr class="row-odd"><td><p>ZREVRANGEBYSCORE</p></td>
<td><p>Sorted Set</p></td>
</tr>
<tr class="row-even"><td><p>ZREVRANK</p></td>
<td><p>Sorted Set</p></td>
</tr>
<tr class="row-odd"><td><p>ZPOPMIN</p></td>
<td><p>Sorted Set</p></td>
</tr>
<tr class="row-even"><td><p>ZPOPMAX</p></td>
<td><p>Sorted Set</p></td>
</tr>
<tr class="row-odd"><td><p>ZSCAN</p></td>
<td><p>Sorted Set</p></td>
</tr>
<tr class="row-even"><td><p>ZSCORE</p></td>
<td><p>Sorted Set</p></td>
</tr>
<tr class="row-odd"><td><p>APPEND</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-even"><td><p>BITCOUNT</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-odd"><td><p>BITFIELD</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-even"><td><p>BITPOS</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-odd"><td><p>DECR</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-even"><td><p>DECRBY</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-odd"><td><p>GET</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-even"><td><p>GETBIT</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-odd"><td><p>GETRANGE</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-even"><td><p>GETSET</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-odd"><td><p>INCR</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-even"><td><p>INCRBY</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-odd"><td><p>INCRBYFLOAT</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-even"><td><p>MGET</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-odd"><td><p>MSET</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-even"><td><p>PSETEX</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-odd"><td><p>SET</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-even"><td><p>SETBIT</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-odd"><td><p>SETEX</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-even"><td><p>SETNX</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-odd"><td><p>SETRANGE</p></td>
<td><p>String</p></td>
</tr>
<tr class="row-even"><td><p>STRLEN</p></td>
<td><p>String</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="failure-modes">
<h2>Failure modes<a class="headerlink" href="#failure-modes" title="Permalink to this headline">¶</a></h2>
<p>If Redis throws an error, we pass that error along as the response to the command. Envoy treats a
response from Redis with the error datatype as a normal response and passes it through to the
caller.</p>
<p>Envoy can also generate its own errors in response to the client.</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Error</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>no upstream host</p></td>
<td><p>The ring hash load balancer did not have a healthy host available at the
ring position chosen for the key.</p></td>
</tr>
<tr class="row-odd"><td><p>upstream failure</p></td>
<td><p>The backend did not respond within the timeout period or closed
the connection.</p></td>
</tr>
<tr class="row-even"><td><p>invalid request</p></td>
<td><p>Command was rejected by the first stage of the command splitter due to
datatype or length.</p></td>
</tr>
<tr class="row-odd"><td><p>unsupported command</p></td>
<td><p>The command was not recognized by Envoy and therefore cannot be serviced
because it cannot be hashed to a backend server.</p></td>
</tr>
<tr class="row-even"><td><p>finished with n errors</p></td>
<td><p>Fragmented commands which sum the response (e.g. DEL) will return the
total number of errors received if any were received.</p></td>
</tr>
<tr class="row-odd"><td><p>upstream protocol error</p></td>
<td><p>A fragmented command received an unexpected datatype or a backend
responded with a response that not conform to the Redis protocol.</p></td>
</tr>
<tr class="row-even"><td><p>wrong number of arguments for command</p></td>
<td><p>Certain commands check in Envoy that the number of
arguments is correct.</p></td>
</tr>
<tr class="row-odd"><td><p>NOAUTH Authentication required.</p></td>
<td><p>The command was rejected because a downstream authentication
password has been set and the client has not successfully authenticated.</p></td>
</tr>
<tr class="row-even"><td><p>ERR invalid password</p></td>
<td><p>The authentication command failed due to an invalid password.</p></td>
</tr>
<tr class="row-odd"><td><p>ERR Client sent AUTH, but no password is set</p></td>
<td><p>An authentication command was received, but no
downstream authentication password has been configured.</p></td>
</tr>
</tbody>
</table>
<p>In the case of MGET, each individual key that cannot be fetched will generate an error response.
For example, if we fetch five keys and two of the keys’ backends time out, we would get an error
response for each in place of the value.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ redis-cli MGET a b c d e
1) &quot;alpha&quot;
2) &quot;bravo&quot;
3) (error) upstream failure
4) (error) upstream failure
5) &quot;echo&quot;
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="postgres.html" class="btn btn-neutral float-right" title="Postgres" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="dynamo.html" class="btn btn-neutral float-left" title="DynamoDB" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2016-2021, Envoy Project Authors

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>