

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>HTTP connection manager &mdash; envoy 1.17.0-5c801b documentation</title>
  

  
  <link rel="stylesheet" href="../../../../../../_static/css/envoy.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/sphinx_tabs/semantic-ui-2.4.1/segment.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/sphinx_tabs/semantic-ui-2.4.1/menu.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/sphinx_tabs/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../_static/copybutton.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../../../../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../../" src="../../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../../_static/jquery.js"></script>
        <script src="../../../../../../_static/underscore.js"></script>
        <script src="../../../../../../_static/doctools.js"></script>
        <script src="../../../../../../_static/language_data.js"></script>
        <script src="../../../../../../_static/clipboard.min.js"></script>
        <script src="../../../../../../_static/copybutton.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" />
    <link rel="next" title="Kafka Broker" href="../../kafka_broker/v3/kafka_broker.proto.html" />
    <link rel="prev" title="Network External Authorization" href="../../ext_authz/v3/ext_authz.proto.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../../index.html">
          

          
            
            <img src="../../../../../../_static/envoy-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.17.0-5c801b
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../start/start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../configuration/configuration.html">Configuration reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../../../api/api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../../../../api/api_supported_versions.html">Supported API versions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../api-v2/api.html">v2 API reference</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../../../api.html">v3 API reference</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../../../bootstrap/bootstrap.html">Bootstrap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../listeners/listeners.html">Listeners</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../clusters/clusters.html">Clusters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../http_routes/http_routes.html">HTTP route management</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../../../../config/config.html">Extensions</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="../../../../../config/filter/filter.html">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../config/accesslog/accesslog.html">Access loggers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../config/rbac/rbac.html">RBAC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../config/health_checker/health_checker.html">Health checkers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../config/transport_socket/transport_socket.html">Transport sockets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../config/resource_monitor/resource_monitor.html">Resource monitors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../config/common/common.html">Common</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../config/compression/compression.html">Compression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../config/cluster/cluster.html">Cluster</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../config/grpc_credential/grpc_credential.html">Grpc Credentials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../config/retry/retry.html">Retry Predicates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../config/trace/trace.html">HTTP Tracers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../config/internal_redirect/internal_redirect.html">Internal Redirect Predicates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../config/endpoint/endpoint.html">Endpoint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../config/upstream/upstream.html">Upstream Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../config/wasm/wasm.html">WASM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../config/watchdog/watchdog.html">Watchdog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../config/descriptors/descriptors.html">Rate limit descriptors</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../admin/admin.html">Admin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../data/data.html">Envoy data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../service/service.html">Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../common_messages/common_messages.html">Common messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../types/types.html">Types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../api-docs/xds_protocol.html">xDS REST and gRPC protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../api/client_features.html">Well Known Client Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../faq/overview.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../version_history/version_history.html">Version history</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../index.html">envoy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../../../../api/api.html">API</a> &raquo;</li>
        
          <li><a href="../../../../../api.html">v3 API reference</a> &raquo;</li>
        
          <li><a href="../../../../../config/config.html">Extensions</a> &raquo;</li>
        
          <li><a href="../../../../../config/filter/filter.html">Filters</a> &raquo;</li>
        
          <li><a href="../../../../../config/filter/network/network.html">Network filters</a> &raquo;</li>
        
      <li>HTTP connection manager</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../../../_sources/api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="http-connection-manager">
<span id="envoy-v3-api-file-envoy-extensions-filters-network-http-connection-manager-v3-http-connection-manager-proto"></span><h1>HTTP connection manager<a class="headerlink" href="#http-connection-manager" title="Permalink to this headline">¶</a></h1>
<p id="extension-envoy-filters-network-http-connection-manager">This extension may be referenced by the qualified name <em>envoy.filters.network.http_connection_manager</em></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This extension is intended to be robust against untrusted downstream traffic. It assumes that the upstream is trusted.</p>
</div>
<p>HTTP connection manager <a class="reference internal" href="../../../../../../configuration/http/http_conn_man/http_conn_man.html#config-http-conn-man"><span class="std std-ref">configuration overview</span></a>.</p>
<div class="section" id="extensions-filters-network-http-connection-manager-v3-httpconnectionmanager">
<span id="envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager"></span><h2>extensions.filters.network.http_connection_manager.v3.HttpConnectionManager<a class="headerlink" href="#extensions-filters-network-http-connection-manager-v3-httpconnectionmanager" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#L38">[extensions.filters.network.http_connection_manager.v3.HttpConnectionManager proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;codec_type&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;stat_prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;rds&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;route_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;scoped_routes&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;http_filters&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;add_user_agent&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;tracing&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;common_http_protocol_options&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;http_protocol_options&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;http2_protocol_options&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;server_name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;server_header_transformation&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;max_request_headers_kb&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;stream_idle_timeout&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;request_timeout&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;request_headers_timeout&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;drain_timeout&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;delayed_close_timeout&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;access_log&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;use_remote_address&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;xff_num_trusted_hops&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;internal_address_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;skip_xff_append&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;via&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;generate_request_id&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;preserve_external_request_id&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;always_set_request_id_in_response&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;forward_client_cert_details&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;set_current_client_cert_details&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;proxy_100_continue&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;upgrade_configs&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;normalize_path&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;merge_slashes&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;request_id_extension&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;local_reply_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;strip_matching_host_port&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;strip_any_host_port&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;stream_error_on_invalid_http_message&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-codec-type">
<dt>codec_type</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-enum-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-codectype"><span class="std std-ref">extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.CodecType</span></a>) Supplies the type of codec that the connection manager should use.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-stat-prefix">
<dt>stat_prefix</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The human readable prefix to use when emitting statistics for the
connection manager. See the <a class="reference internal" href="../../../../../../configuration/http/http_conn_man/stats.html#config-http-conn-man-stats"><span class="std std-ref">statistics documentation</span></a> for
more information.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-rds">
<dt>rds</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-rds"><span class="std std-ref">extensions.filters.network.http_connection_manager.v3.Rds</span></a>) The connection manager’s route table will be dynamically loaded via the RDS API.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-rds"><span class="std std-ref">rds</span></a>, <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-route-config"><span class="std std-ref">route_config</span></a>, <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-scoped-routes"><span class="std std-ref">scoped_routes</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-route-config">
<dt>route_config</dt><dd><p>(<a class="reference internal" href="../../../../../config/route/v3/route.proto.html#envoy-v3-api-msg-config-route-v3-routeconfiguration"><span class="std std-ref">config.route.v3.RouteConfiguration</span></a>) The route table for the connection manager is static and is specified in this property.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-rds"><span class="std std-ref">rds</span></a>, <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-route-config"><span class="std std-ref">route_config</span></a>, <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-scoped-routes"><span class="std std-ref">scoped_routes</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-scoped-routes">
<dt>scoped_routes</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-scopedroutes"><span class="std std-ref">extensions.filters.network.http_connection_manager.v3.ScopedRoutes</span></a>) A route table will be dynamically assigned to each request based on request attributes
(e.g., the value of a header). The “routing scopes” (i.e., route tables) and “scope keys” are
specified in this message.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-rds"><span class="std std-ref">rds</span></a>, <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-route-config"><span class="std std-ref">route_config</span></a>, <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-scoped-routes"><span class="std std-ref">scoped_routes</span></a> must be set.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-http-filters">
<dt>http_filters</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-httpfilter"><span class="std std-ref">extensions.filters.network.http_connection_manager.v3.HttpFilter</span></a>) A list of individual HTTP filters that make up the filter chain for
requests made to the connection manager. <a class="reference internal" href="../../../../../../intro/arch_overview/http/http_filters.html#arch-overview-http-filters-ordering"><span class="std std-ref">Order matters</span></a>
as the filters are processed sequentially as request events happen.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-add-user-agent">
<dt>add_user_agent</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#boolvalue">BoolValue</a>) Whether the connection manager manipulates the <a class="reference internal" href="../../../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-user-agent"><span class="std std-ref">user-agent</span></a>
and <a class="reference internal" href="../../../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-downstream-service-cluster"><span class="std std-ref">x-envoy-downstream-service-cluster</span></a> headers. See the linked
documentation for more information. Defaults to false.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-tracing">
<dt>tracing</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-tracing"><span class="std std-ref">extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.Tracing</span></a>) Presence of the object defines whether the connection manager
emits <a class="reference internal" href="../../../../../../intro/arch_overview/observability/tracing.html#arch-overview-tracing"><span class="std std-ref">tracing</span></a> data to the <a class="reference internal" href="../../../../../config/trace/v3/http_tracer.proto.html#envoy-v3-api-msg-config-trace-v3-tracing"><span class="std std-ref">configured tracing provider</span></a>.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-common-http-protocol-options">
<dt>common_http_protocol_options</dt><dd><p>(<a class="reference internal" href="../../../../../config/core/v3/protocol.proto.html#envoy-v3-api-msg-config-core-v3-httpprotocoloptions"><span class="std std-ref">config.core.v3.HttpProtocolOptions</span></a>) Additional settings for HTTP requests handled by the connection manager. These will be
applicable to both HTTP1 and HTTP2 requests.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This field should be configured in the presence of untrusted <em>downstreams</em>.</p>
<p>Example configuration for untrusted environments:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">common_http_protocol_options</span><span class="p">:</span>
  <span class="nt">headers_with_underscores_action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">REJECT_REQUEST</span>
  <span class="nt">idle_timeout</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">900s</span>
</pre></div>
</div>
</div>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-http-protocol-options">
<dt>http_protocol_options</dt><dd><p>(<a class="reference internal" href="../../../../../config/core/v3/protocol.proto.html#envoy-v3-api-msg-config-core-v3-http1protocoloptions"><span class="std std-ref">config.core.v3.Http1ProtocolOptions</span></a>) Additional HTTP/1 settings that are passed to the HTTP/1 codec.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-http2-protocol-options">
<dt>http2_protocol_options</dt><dd><p>(<a class="reference internal" href="../../../../../config/core/v3/protocol.proto.html#envoy-v3-api-msg-config-core-v3-http2protocoloptions"><span class="std std-ref">config.core.v3.Http2ProtocolOptions</span></a>) Additional HTTP/2 settings that are passed directly to the HTTP/2 codec.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This field should be configured in the presence of untrusted <em>downstreams</em>.</p>
<p>Example configuration for untrusted environments:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">http2_protocol_options</span><span class="p">:</span>
  <span class="nt">initial_connection_window_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1048576.0</span>
  <span class="nt">initial_stream_window_size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">65536.0</span>
  <span class="nt">max_concurrent_streams</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100.0</span>
</pre></div>
</div>
</div>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-server-name">
<dt>server_name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) An optional override that the connection manager will write to the server
header in responses. If not set, the default is <em>envoy</em>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-server-header-transformation">
<dt>server_header_transformation</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-enum-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-serverheadertransformation"><span class="std std-ref">extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.ServerHeaderTransformation</span></a>) Defines the action to be applied to the Server header on the response path.
By default, Envoy will overwrite the header with the value specified in
server_name.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-max-request-headers-kb">
<dt>max_request_headers_kb</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#uint32value">UInt32Value</a>) The maximum request headers size for incoming connections.
If unconfigured, the default max request headers allowed is 60 KiB.
Requests that exceed this limit will receive a 431 response.
The max configurable limit is 96 KiB, based on current implementation
constraints.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-stream-idle-timeout">
<dt>stream_idle_timeout</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) The stream idle timeout for connections managed by the connection manager.
If not specified, this defaults to 5 minutes. The default value was selected
so as not to interfere with any smaller configured timeouts that may have
existed in configurations prior to the introduction of this feature, while
introducing robustness to TCP connections that terminate without a FIN.</p>
<p>This idle timeout applies to new streams and is overridable by the
<a class="reference internal" href="../../../../../config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-routeaction-idle-timeout"><span class="std std-ref">route-level idle_timeout</span></a>. Even on a stream in
which the override applies, prior to receipt of the initial request
headers, the <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-stream-idle-timeout"><span class="std std-ref">stream_idle_timeout</span></a>
applies. Each time an encode/decode event for headers or data is processed
for the stream, the timer will be reset. If the timeout fires, the stream
is terminated with a 408 Request Timeout error code if no upstream response
header has been received, otherwise a stream reset occurs.</p>
<p>This timeout also specifies the amount of time that Envoy will wait for the peer to open enough
window to write any remaining stream data once the entirety of stream data (local end stream is
true) has been buffered pending available window. In other words, this timeout defends against
a peer that does not release enough window to completely write the stream, even though all
data has been proxied within available flow control windows. If the timeout is hit in this
case, the <a class="reference internal" href="../../../../../../configuration/http/http_conn_man/stats.html#config-http-conn-man-stats-per-codec"><span class="std std-ref">tx_flush_timeout</span></a> counter will be
incremented. Note that <a class="reference internal" href="../../../../../config/core/v3/protocol.proto.html#envoy-v3-api-field-config-core-v3-httpprotocoloptions-max-stream-duration"><span class="std std-ref">max_stream_duration</span></a> does not apply to
this corner case.</p>
<p>If the <a class="reference internal" href="../../../../../../configuration/operations/overload_manager/overload_manager.html#config-overload-manager-overload-actions"><span class="std std-ref">overload action</span></a> “envoy.overload_actions.reduce_timeouts”
is configured, this timeout is scaled according to the value for
<a class="reference internal" href="../../../../../config/overload/v3/overload.proto.html#envoy-v3-api-enum-value-config-overload-v3-scaletimersoverloadactionconfig-timertype-http-downstream-stream-idle"><span class="std std-ref">HTTP_DOWNSTREAM_STREAM_IDLE</span></a>.</p>
<p>Note that it is possible to idle timeout even if the wire traffic for a stream is non-idle, due
to the granularity of events presented to the connection manager. For example, while receiving
very large request headers, it may be the case that there is traffic regularly arriving on the
wire while the connection manage is only able to observe the end-of-headers event, hence the
stream may still idle timeout.</p>
<p>A value of 0 will completely disable the connection manager stream idle
timeout, although per-route idle timeout overrides will continue to apply.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This field should be configured in the presence of untrusted <em>downstreams</em>.</p>
<p>Example configuration for untrusted environments:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">stream_idle_timeout</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">300s</span>
</pre></div>
</div>
</div>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-request-timeout">
<dt>request_timeout</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) The amount of time that Envoy will wait for the entire request to be received.
The timer is activated when the request is initiated, and is disarmed when the last byte of the
request is sent upstream (i.e. all decoding filters have processed the request), OR when the
response is initiated. If not specified or set to 0, this timeout is disabled.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This field should be configured in the presence of untrusted <em>downstreams</em>.</p>
<p>This timeout is not compatible with streaming requests.</p>
<p>Example configuration for untrusted environments:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">request_timeout</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">300s</span>
</pre></div>
</div>
</div>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-request-headers-timeout">
<dt>request_headers_timeout</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) The amount of time that Envoy will wait for the request headers to be received. The timer is
activated when the first byte of the headers is received, and is disarmed when the last byte of
the headers has been received. If not specified or set to 0, this timeout is disabled.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This field should be configured in the presence of untrusted <em>downstreams</em>.</p>
<p>Example configuration for untrusted environments:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">request_headers_timeout</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10s</span>
</pre></div>
</div>
</div>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-drain-timeout">
<dt>drain_timeout</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) The time that Envoy will wait between sending an HTTP/2 “shutdown
notification” (GOAWAY frame with max stream ID) and a final GOAWAY frame.
This is used so that Envoy provides a grace period for new streams that
race with the final GOAWAY frame. During this grace period, Envoy will
continue to accept new streams. After the grace period, a final GOAWAY
frame is sent and Envoy will start refusing new streams. Draining occurs
both when a connection hits the idle timeout or during general server
draining. The default grace period is 5000 milliseconds (5 seconds) if this
option is not specified.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-delayed-close-timeout">
<dt>delayed_close_timeout</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) The delayed close timeout is for downstream connections managed by the HTTP connection manager.
It is defined as a grace period after connection close processing has been locally initiated
during which Envoy will wait for the peer to close (i.e., a TCP FIN/RST is received by Envoy
from the downstream connection) prior to Envoy closing the socket associated with that
connection.
NOTE: This timeout is enforced even when the socket associated with the downstream connection
is pending a flush of the write buffer. However, any progress made writing data to the socket
will restart the timer associated with this timeout. This means that the total grace period for
a socket in this state will be
&lt;total_time_waiting_for_write_buffer_flushes&gt;+&lt;delayed_close_timeout&gt;.</p>
<p>Delaying Envoy’s connection close and giving the peer the opportunity to initiate the close
sequence mitigates a race condition that exists when downstream clients do not drain/process
data in a connection’s receive buffer after a remote close has been detected via a socket
write(). This race leads to such clients failing to process the response code sent by Envoy,
which could result in erroneous downstream processing.</p>
<p>If the timeout triggers, Envoy will close the connection’s socket.</p>
<p>The default timeout is 1000 ms if this option is not specified.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To be useful in avoiding the race condition described above, this timeout must be set
to <em>at least</em> &lt;max round trip time expected between clients and Envoy&gt;+&lt;100ms to account for
a reasonable “worst” case processing time for a full iteration of Envoy’s event loop&gt;.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>A value of 0 will completely disable delayed close processing. When disabled, the downstream
connection’s socket will be closed immediately after the write flush is completed or will
never close if the write flush does not complete.</p>
</div>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-access-log">
<dt>access_log</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="../../../../../config/accesslog/v3/accesslog.proto.html#envoy-v3-api-msg-config-accesslog-v3-accesslog"><span class="std std-ref">config.accesslog.v3.AccessLog</span></a>) Configuration for <a class="reference internal" href="../../../../../../intro/arch_overview/observability/access_logging.html#arch-overview-access-logs"><span class="std std-ref">HTTP access logs</span></a>
emitted by the connection manager.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-use-remote-address">
<dt>use_remote_address</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#boolvalue">BoolValue</a>) If set to true, the connection manager will use the real remote address
of the client connection when determining internal versus external origin and manipulating
various headers. If set to false or absent, the connection manager will use the
<a class="reference internal" href="../../../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-x-forwarded-for"><span class="std std-ref">x-forwarded-for</span></a> HTTP header. See the documentation for
<a class="reference internal" href="../../../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-x-forwarded-for"><span class="std std-ref">x-forwarded-for</span></a>,
<a class="reference internal" href="../../../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-x-envoy-internal"><span class="std std-ref">x-envoy-internal</span></a>, and
<a class="reference internal" href="../../../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-x-envoy-external-address"><span class="std std-ref">x-envoy-external-address</span></a> for more information.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This field should be configured in the presence of untrusted <em>downstreams</em>.</p>
<p>Example configuration for untrusted environments:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">use_remote_address</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</div>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-xff-num-trusted-hops">
<dt>xff_num_trusted_hops</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">uint32</a>) The number of additional ingress proxy hops from the right side of the
<a class="reference internal" href="../../../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-x-forwarded-for"><span class="std std-ref">x-forwarded-for</span></a> HTTP header to trust when
determining the origin client’s IP address. The default is zero if this option
is not specified. See the documentation for
<a class="reference internal" href="../../../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-x-forwarded-for"><span class="std std-ref">x-forwarded-for</span></a> for more information.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-internal-address-config">
<dt>internal_address_config</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-internaladdressconfig"><span class="std std-ref">extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.InternalAddressConfig</span></a>) Configures what network addresses are considered internal for stats and header sanitation
purposes. If unspecified, only RFC1918 IP addresses will be considered internal.
See the documentation for <a class="reference internal" href="../../../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-x-envoy-internal"><span class="std std-ref">x-envoy-internal</span></a> for more
information about internal/external addresses.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-skip-xff-append">
<dt>skip_xff_append</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) If set, Envoy will not append the remote address to the
<a class="reference internal" href="../../../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-x-forwarded-for"><span class="std std-ref">x-forwarded-for</span></a> HTTP header. This may be used in
conjunction with HTTP filters that explicitly manipulate XFF after the HTTP connection manager
has mutated the request headers. While <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-use-remote-address"><span class="std std-ref">use_remote_address</span></a>
will also suppress XFF addition, it has consequences for logging and other
Envoy uses of the remote address, so <em>skip_xff_append</em> should be used
when only an elision of XFF addition is intended.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-via">
<dt>via</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Via header value to append to request and response headers. If this is
empty, no via header will be appended.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-generate-request-id">
<dt>generate_request_id</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#boolvalue">BoolValue</a>) Whether the connection manager will generate the <a class="reference internal" href="../../../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-x-request-id"><span class="std std-ref">x-request-id</span></a> header if it does not exist. This defaults to
true. Generating a random UUID4 is expensive so in high throughput scenarios where this feature
is not desired it can be disabled.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-preserve-external-request-id">
<dt>preserve_external_request_id</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) Whether the connection manager will keep the <a class="reference internal" href="../../../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-x-request-id"><span class="std std-ref">x-request-id</span></a> header if passed for a request that is edge
(Edge request is the request from external clients to front Envoy) and not reset it, which
is the current Envoy behaviour. This defaults to false.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-always-set-request-id-in-response">
<dt>always_set_request_id_in_response</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) If set, Envoy will always set <a class="reference internal" href="../../../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-x-request-id"><span class="std std-ref">x-request-id</span></a> header in response.
If this is false or not set, the request ID is returned in responses only if tracing is forced using
<a class="reference internal" href="../../../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-x-envoy-force-trace"><span class="std std-ref">x-envoy-force-trace</span></a> header.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-forward-client-cert-details">
<dt>forward_client_cert_details</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-enum-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-forwardclientcertdetails"><span class="std std-ref">extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.ForwardClientCertDetails</span></a>) How to handle the <a class="reference internal" href="../../../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-x-forwarded-client-cert"><span class="std std-ref">x-forwarded-client-cert</span></a> (XFCC) HTTP
header.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-set-current-client-cert-details">
<dt>set_current_client_cert_details</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-setcurrentclientcertdetails"><span class="std std-ref">extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.SetCurrentClientCertDetails</span></a>) This field is valid only when <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-forward-client-cert-details"><span class="std std-ref">forward_client_cert_details</span></a>
is APPEND_FORWARD or SANITIZE_SET and the client connection is mTLS. It specifies the fields in
the client certificate to be forwarded. Note that in the
<a class="reference internal" href="../../../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-x-forwarded-client-cert"><span class="std std-ref">x-forwarded-client-cert</span></a> header, <em>Hash</em> is always set, and
<em>By</em> is always set when the client certificate presents the URI type Subject Alternative Name
value.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-proxy-100-continue">
<dt>proxy_100_continue</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) If proxy_100_continue is true, Envoy will proxy incoming “Expect:
100-continue” headers upstream, and forward “100 Continue” responses
downstream. If this is false or not set, Envoy will instead strip the
“Expect: 100-continue” header, and send a “100 Continue” response itself.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-upgrade-configs">
<dt>upgrade_configs</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-upgradeconfig"><span class="std std-ref">extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.UpgradeConfig</span></a>)</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-normalize-path">
<dt>normalize_path</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#boolvalue">BoolValue</a>) Should paths be normalized according to RFC 3986 before any processing of
requests by HTTP filters or routing? This affects the upstream <em>:path</em> header
as well. For paths that fail this check, Envoy will respond with 400 to
paths that are malformed. This defaults to false currently but will default
true in the future. When not specified, this value may be overridden by the
runtime variable
<a class="reference internal" href="../../../../../../configuration/http/http_conn_man/runtime.html#config-http-conn-man-runtime-normalize-path"><span class="std std-ref">http_connection_manager.normalize_path</span></a>.
See <a class="reference external" href="https://tools.ietf.org/html/rfc3986#section-6">Normalization and Comparison</a>
for details of normalization.
Note that Envoy does not perform
<a class="reference external" href="https://tools.ietf.org/html/rfc3986#section-6.2.2.1">case normalization</a></p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-merge-slashes">
<dt>merge_slashes</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) Determines if adjacent slashes in the path are merged into one before any processing of
requests by HTTP filters or routing. This affects the upstream <em>:path</em> header as well. Without
setting this option, incoming requests with path <cite>//dir///file</cite> will not match against route
with <cite>prefix</cite> match set to <cite>/dir</cite>. Defaults to <cite>false</cite>. Note that slash merging is not part of
<a class="reference external" href="https://tools.ietf.org/html/rfc3986">HTTP spec</a> and is provided for convenience.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-request-id-extension">
<dt>request_id_extension</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-requestidextension"><span class="std std-ref">extensions.filters.network.http_connection_manager.v3.RequestIDExtension</span></a>) The configuration of the request ID extension. This includes operations such as
generation, validation, and associated tracing operations.</p>
<p>If not set, Envoy uses the default UUID-based behavior:</p>
<ol class="arabic simple">
<li><p>Request ID is propagated using <em>x-request-id</em> header.</p></li>
<li><p>Request ID is a universally unique identifier (UUID).</p></li>
<li><p>Tracing decision (sampled, forced, etc) is set in 14th byte of the UUID.</p></li>
</ol>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-local-reply-config">
<dt>local_reply_config</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-localreplyconfig"><span class="std std-ref">extensions.filters.network.http_connection_manager.v3.LocalReplyConfig</span></a>) The configuration to customize local reply returned by Envoy. It can customize status code,
body text and response content type. If not specified, status code and text body are hard
coded in Envoy, the response content type is plain text.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-strip-matching-host-port">
<dt>strip_matching_host_port</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) Determines if the port part should be removed from host/authority header before any processing
of request by HTTP filters or routing. The port would be removed only if it is equal to the <a class="reference internal" href="../../../../../config/listener/v3/listener.proto.html#envoy-v3-api-field-config-listener-v3-listener-address"><span class="std std-ref">listener’s</span></a>
local port and request method is not CONNECT. This affects the upstream host header as well.
Without setting this option, incoming requests with host <cite>example:443</cite> will not match against
route with <a class="reference internal" href="../../../../../config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-virtualhost-domains"><span class="std std-ref">domains</span></a> match set to <cite>example</cite>. Defaults to <cite>false</cite>. Note that port removal is not part
of <a class="reference external" href="https://tools.ietf.org/html/rfc3986">HTTP spec</a> and is provided for convenience.
Only one of <cite>strip_matching_host_port</cite> or <cite>strip_any_host_port</cite> can be set.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-strip-any-host-port">
<dt>strip_any_host_port</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) Determines if the port part should be removed from host/authority header before any processing
of request by HTTP filters or routing. The port would be removed only if request method is not CONNECT.
This affects the upstream host header as well.
Without setting this option, incoming requests with host <cite>example:443</cite> will not match against
route with <a class="reference internal" href="../../../../../config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-virtualhost-domains"><span class="std std-ref">domains</span></a> match set to <cite>example</cite>. Defaults to <cite>false</cite>. Note that port removal is not part
of <a class="reference external" href="https://tools.ietf.org/html/rfc3986">HTTP spec</a> and is provided for convenience.
Only one of <cite>strip_matching_host_port</cite> or <cite>strip_any_host_port</cite> can be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-stream-error-on-invalid-http-message">
<dt>stream_error_on_invalid_http_message</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#boolvalue">BoolValue</a>) Governs Envoy’s behavior when receiving invalid HTTP from downstream.
If this option is false (default), Envoy will err on the conservative side handling HTTP
errors, terminating both HTTP/1.1 and HTTP/2 connections when receiving an invalid request.
If this option is set to true, Envoy will be more permissive, only resetting the invalid
stream in the case of HTTP/2 and leaving the connection open where possible (if the entire
request is read for HTTP/1.1)
In general this should be true for deployments receiving trusted traffic (L2 Envoys,
company-internal mesh) and false when receiving untrusted traffic (edge deployments).</p>
<p>If different behaviors for invalid_http_message for HTTP/1 and HTTP/2 are
desired, one should use the new HTTP/1 option <a class="reference internal" href="../../../../../config/core/v3/protocol.proto.html#envoy-v3-api-field-config-core-v3-http1protocoloptions-override-stream-error-on-invalid-http-message"><span class="std std-ref">override_stream_error_on_invalid_http_message</span></a> or the new HTTP/2 option
<a class="reference internal" href="../../../../../config/core/v3/protocol.proto.html#envoy-v3-api-field-config-core-v3-http2protocoloptions-override-stream-error-on-invalid-http-message"><span class="std std-ref">override_stream_error_on_invalid_http_message</span></a>
<em>not</em> the deprecated but similarly named <a class="reference internal" href="../../../../../config/core/v3/protocol.proto.html#envoy-v3-api-field-config-core-v3-http2protocoloptions-stream-error-on-invalid-http-messaging"><span class="std std-ref">stream_error_on_invalid_http_messaging</span></a></p>
</dd>
</dl>
</div>
<div class="section" id="extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-tracing">
<span id="envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-tracing"></span><h2>extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.Tracing<a class="headerlink" href="#extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-tracing" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#L101">[extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.Tracing proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;client_sampling&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;random_sampling&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;overall_sampling&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;verbose&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;max_path_tag_length&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;custom_tags&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;provider&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-tracing-client-sampling">
<dt>client_sampling</dt><dd><p>(<a class="reference internal" href="../../../../../type/v3/percent.proto.html#envoy-v3-api-msg-type-v3-percent"><span class="std std-ref">type.v3.Percent</span></a>) Target percentage of requests managed by this HTTP connection manager that will be force
traced if the <a class="reference internal" href="../../../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-x-client-trace-id"><span class="std std-ref">x-client-trace-id</span></a>
header is set. This field is a direct analog for the runtime variable
‘tracing.client_sampling’ in the <a class="reference internal" href="../../../../../../configuration/http/http_conn_man/runtime.html#config-http-conn-man-runtime"><span class="std std-ref">HTTP Connection Manager</span></a>.
Default: 100%</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-tracing-random-sampling">
<dt>random_sampling</dt><dd><p>(<a class="reference internal" href="../../../../../type/v3/percent.proto.html#envoy-v3-api-msg-type-v3-percent"><span class="std std-ref">type.v3.Percent</span></a>) Target percentage of requests managed by this HTTP connection manager that will be randomly
selected for trace generation, if not requested by the client or not forced. This field is
a direct analog for the runtime variable ‘tracing.random_sampling’ in the
<a class="reference internal" href="../../../../../../configuration/http/http_conn_man/runtime.html#config-http-conn-man-runtime"><span class="std std-ref">HTTP Connection Manager</span></a>.
Default: 100%</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-tracing-overall-sampling">
<dt>overall_sampling</dt><dd><p>(<a class="reference internal" href="../../../../../type/v3/percent.proto.html#envoy-v3-api-msg-type-v3-percent"><span class="std std-ref">type.v3.Percent</span></a>) Target percentage of requests managed by this HTTP connection manager that will be traced
after all other sampling checks have been applied (client-directed, force tracing, random
sampling). This field functions as an upper limit on the total configured sampling rate. For
instance, setting client_sampling to 100% but overall_sampling to 1% will result in only 1%
of client requests with the appropriate headers to be force traced. This field is a direct
analog for the runtime variable ‘tracing.global_enabled’ in the
<a class="reference internal" href="../../../../../../configuration/http/http_conn_man/runtime.html#config-http-conn-man-runtime"><span class="std std-ref">HTTP Connection Manager</span></a>.
Default: 100%</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-tracing-verbose">
<dt>verbose</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) Whether to annotate spans with additional data. If true, spans will include logs for stream
events.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-tracing-max-path-tag-length">
<dt>max_path_tag_length</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#uint32value">UInt32Value</a>) Maximum length of the request path to extract and include in the HttpUrl tag. Used to
truncate lengthy request paths to meet the needs of a tracing backend.
Default: 256</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-tracing-custom-tags">
<dt>custom_tags</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="../../../../../type/tracing/v3/custom_tag.proto.html#envoy-v3-api-msg-type-tracing-v3-customtag"><span class="std std-ref">type.tracing.v3.CustomTag</span></a>) A list of custom tags with unique tag name to create tags for the active span.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-tracing-provider">
<dt>provider</dt><dd><p>(<a class="reference internal" href="../../../../../config/trace/v3/http_tracer.proto.html#envoy-v3-api-msg-config-trace-v3-tracing-http"><span class="std std-ref">config.trace.v3.Tracing.Http</span></a>) Configuration for an external tracing provider.
If not specified, no tracing will be performed.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Please be aware that <em>envoy.tracers.opencensus</em> provider can only be configured once
in Envoy lifetime.
Any attempts to reconfigure it or to use different configurations for different HCM filters
will be rejected.
Such a constraint is inherent to OpenCensus itself. It cannot be overcome without changes
on OpenCensus side.</p>
</div>
</dd>
</dl>
</div>
<div class="section" id="enum-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-tracing-operationname">
<span id="envoy-v3-api-enum-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-tracing-operationname"></span><h2>Enum extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.Tracing.OperationName<a class="headerlink" href="#enum-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-tracing-operationname" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#L105">[extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.Tracing.OperationName proto]</a></p>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-tracing-operationname-ingress">
<dt>INGRESS</dt><dd><p><em>(DEFAULT)</em> ⁣The HTTP listener is used for ingress/incoming requests.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-tracing-operationname-egress">
<dt>EGRESS</dt><dd><p>⁣The HTTP listener is used for egress/outgoing requests.</p>
</dd>
</dl>
</div>
<div class="section" id="extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-internaladdressconfig">
<span id="envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-internaladdressconfig"></span><h2>extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.InternalAddressConfig<a class="headerlink" href="#extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-internaladdressconfig" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#L167">[extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.InternalAddressConfig proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;unix_sockets&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-internaladdressconfig-unix-sockets">
<dt>unix_sockets</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) Whether unix socket addresses should be considered internal.</p>
</dd>
</dl>
</div>
<div class="section" id="extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-setcurrentclientcertdetails">
<span id="envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-setcurrentclientcertdetails"></span><h2>extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.SetCurrentClientCertDetails<a class="headerlink" href="#extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-setcurrentclientcertdetails" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#L177">[extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.SetCurrentClientCertDetails proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;subject&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;cert&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;chain&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;dns&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-setcurrentclientcertdetails-subject">
<dt>subject</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#boolvalue">BoolValue</a>) Whether to forward the subject of the client cert. Defaults to false.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-setcurrentclientcertdetails-cert">
<dt>cert</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) Whether to forward the entire client cert in URL encoded PEM format. This will appear in the
XFCC header comma separated from other values with the value Cert=”PEM”.
Defaults to false.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-setcurrentclientcertdetails-chain">
<dt>chain</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) Whether to forward the entire client cert chain (including the leaf cert) in URL encoded PEM
format. This will appear in the XFCC header comma separated from other values with the value
Chain=”PEM”.
Defaults to false.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-setcurrentclientcertdetails-dns">
<dt>dns</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) Whether to forward the DNS type Subject Alternative Names of the client cert.
Defaults to false.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-setcurrentclientcertdetails-uri">
<dt>uri</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) Whether to forward the URI type Subject Alternative Name of the client cert. Defaults to
false.</p>
</dd>
</dl>
</div>
<div class="section" id="extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-upgradeconfig">
<span id="envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-upgradeconfig"></span><h2>extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.UpgradeConfig<a class="headerlink" href="#extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-upgradeconfig" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#L219">[extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.UpgradeConfig proto]</a></p>
<p>The configuration for HTTP upgrades.
For each upgrade type desired, an UpgradeConfig must be added.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The current implementation of upgrade headers does not handle
multi-valued upgrade headers. Support for multi-valued headers may be
added in the future if needed.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The current implementation of upgrade headers does not work with HTTP/2
upstreams.</p>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;upgrade_type&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;filters&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;enabled&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-upgradeconfig-upgrade-type">
<dt>upgrade_type</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) The case-insensitive name of this upgrade, e.g. “websocket”.
For each upgrade type present in upgrade_configs, requests with
Upgrade: [upgrade_type]
will be proxied upstream.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-upgradeconfig-filters">
<dt>filters</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-httpfilter"><span class="std std-ref">extensions.filters.network.http_connection_manager.v3.HttpFilter</span></a>) If present, this represents the filter chain which will be created for
this type of upgrade. If no filters are present, the filter chain for
HTTP connections will be used for this upgrade type.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-upgradeconfig-enabled">
<dt>enabled</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#boolvalue">BoolValue</a>) Determines if upgrades are enabled or disabled by default. Defaults to true.
This can be overridden on a per-route basis with <a class="reference internal" href="../../../../../config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-routeaction-upgrade-configs"><span class="std std-ref">cluster</span></a> as documented in the
<a class="reference internal" href="../../../../../../intro/arch_overview/http/upgrades.html#arch-overview-upgrades"><span class="std std-ref">upgrade documentation</span></a>.</p>
</dd>
</dl>
</div>
<div class="section" id="enum-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-codectype">
<span id="envoy-v3-api-enum-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-codectype"></span><h2>Enum extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.CodecType<a class="headerlink" href="#enum-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-codectype" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#L42">[extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.CodecType proto]</a></p>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-codectype-auto">
<dt>AUTO</dt><dd><p><em>(DEFAULT)</em> ⁣For every new connection, the connection manager will determine which
codec to use. This mode supports both ALPN for TLS listeners as well as
protocol inference for plaintext listeners. If ALPN data is available, it
is preferred, otherwise protocol inference is used. In almost all cases,
this is the right option to choose for this setting.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-codectype-http1">
<dt>HTTP1</dt><dd><p>⁣The connection manager will assume that the client is speaking HTTP/1.1.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-codectype-http2">
<dt>HTTP2</dt><dd><p>⁣The connection manager will assume that the client is speaking HTTP/2
(Envoy does not require HTTP/2 to take place over TLS or to use ALPN.
Prior knowledge is allowed).</p>
</dd>
</dl>
</div>
<div class="section" id="enum-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-serverheadertransformation">
<span id="envoy-v3-api-enum-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-serverheadertransformation"></span><h2>Enum extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.ServerHeaderTransformation<a class="headerlink" href="#enum-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-serverheadertransformation" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#L64">[extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.ServerHeaderTransformation proto]</a></p>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-serverheadertransformation-overwrite">
<dt>OVERWRITE</dt><dd><p><em>(DEFAULT)</em> ⁣Overwrite any Server header with the contents of server_name.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-serverheadertransformation-append-if-absent">
<dt>APPEND_IF_ABSENT</dt><dd><p>⁣If no Server header is present, append Server server_name
If a Server header is present, pass it through.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-serverheadertransformation-pass-through">
<dt>PASS_THROUGH</dt><dd><p>⁣Pass through the value of the server header, and do not append a header
if none is present.</p>
</dd>
</dl>
</div>
<div class="section" id="enum-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-forwardclientcertdetails">
<span id="envoy-v3-api-enum-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-forwardclientcertdetails"></span><h2>Enum extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.ForwardClientCertDetails<a class="headerlink" href="#enum-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-forwardclientcertdetails" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#L79">[extensions.filters.network.http_connection_manager.v3.HttpConnectionManager.ForwardClientCertDetails proto]</a></p>
<p>How to handle the <a class="reference internal" href="../../../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-x-forwarded-client-cert"><span class="std std-ref">x-forwarded-client-cert</span></a> (XFCC) HTTP
header.</p>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-forwardclientcertdetails-sanitize">
<dt>SANITIZE</dt><dd><p><em>(DEFAULT)</em> ⁣Do not send the XFCC header to the next hop. This is the default value.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-forwardclientcertdetails-forward-only">
<dt>FORWARD_ONLY</dt><dd><p>⁣When the client connection is mTLS (Mutual TLS), forward the XFCC header
in the request.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-forwardclientcertdetails-append-forward">
<dt>APPEND_FORWARD</dt><dd><p>⁣When the client connection is mTLS, append the client certificate
information to the request’s XFCC header and forward it.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-forwardclientcertdetails-sanitize-set">
<dt>SANITIZE_SET</dt><dd><p>⁣When the client connection is mTLS, reset the XFCC header with the client
certificate information and send it to the next hop.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-forwardclientcertdetails-always-forward-only">
<dt>ALWAYS_FORWARD_ONLY</dt><dd><p>⁣Always forward the XFCC header in the request, regardless of whether the
client connection is mTLS.</p>
</dd>
</dl>
</div>
<div class="section" id="extensions-filters-network-http-connection-manager-v3-localreplyconfig">
<span id="envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-localreplyconfig"></span><h2>extensions.filters.network.http_connection_manager.v3.LocalReplyConfig<a class="headerlink" href="#extensions-filters-network-http-connection-manager-v3-localreplyconfig" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#L588">[extensions.filters.network.http_connection_manager.v3.LocalReplyConfig proto]</a></p>
<p>The configuration to customize local reply returned by Envoy.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;mappers&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;body_format&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-localreplyconfig-mappers">
<dt>mappers</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-responsemapper"><span class="std std-ref">extensions.filters.network.http_connection_manager.v3.ResponseMapper</span></a>) Configuration of list of mappers which allows to filter and change local response.
The mappers will be checked by the specified order until one is matched.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-localreplyconfig-body-format">
<dt>body_format</dt><dd><p>(<a class="reference internal" href="../../../../../config/core/v3/substitution_format_string.proto.html#envoy-v3-api-msg-config-core-v3-substitutionformatstring"><span class="std std-ref">config.core.v3.SubstitutionFormatString</span></a>) The configuration to form response body from the <a class="reference internal" href="../../../../../../configuration/observability/access_log/usage.html#config-access-log-command-operators"><span class="std std-ref">command operators</span></a>
and to specify response content type as one of: plain/text or application/json.</p>
<p>Example one: “plain/text” <code class="docutils literal notranslate"><span class="pre">body_format</span></code>.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">text_format</span><span class="p">:</span> <span class="s">&quot;%LOCAL_REPLY_BODY%:%RESPONSE_CODE%:path=%REQ(:path)%\n&quot;</span>
</pre></div>
</div>
<p>The following response body in “plain/text” format will be generated for a request with
local reply body of “upstream connection error”, response_code=503 and path=/foo.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>upstream connect error:503:path=/foo
</pre></div>
</div>
<p>Example two: “application/json” <code class="docutils literal notranslate"><span class="pre">body_format</span></code>.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">json_format</span><span class="p">:</span>
  <span class="nt">status</span><span class="p">:</span> <span class="s">&quot;%RESPONSE_CODE%&quot;</span>
  <span class="nt">message</span><span class="p">:</span> <span class="s">&quot;%LOCAL_REPLY_BODY%&quot;</span>
  <span class="nt">path</span><span class="p">:</span> <span class="s">&quot;%REQ(:path)%&quot;</span>
</pre></div>
</div>
<p>The following response body in “application/json” format would be generated for a request with
local reply body of “upstream connection error”, response_code=503 and path=/foo.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;status&quot;</span><span class="p">:</span> <span class="mi">503</span><span class="p">,</span>
  <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;upstream connection error&quot;</span><span class="p">,</span>
  <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/foo&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="extensions-filters-network-http-connection-manager-v3-responsemapper">
<span id="envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-responsemapper"></span><h2>extensions.filters.network.http_connection_manager.v3.ResponseMapper<a class="headerlink" href="#extensions-filters-network-http-connection-manager-v3-responsemapper" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#L636">[extensions.filters.network.http_connection_manager.v3.ResponseMapper proto]</a></p>
<p>The configuration to filter and change local response.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;filter&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;status_code&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;body_format_override&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;headers_to_add&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-responsemapper-filter">
<dt>filter</dt><dd><p>(<a class="reference internal" href="../../../../../config/accesslog/v3/accesslog.proto.html#envoy-v3-api-msg-config-accesslog-v3-accesslogfilter"><span class="std std-ref">config.accesslog.v3.AccessLogFilter</span></a>, <em>REQUIRED</em>) Filter to determine if this mapper should apply.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-responsemapper-status-code">
<dt>status_code</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#uint32value">UInt32Value</a>) The new response status code if specified.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-responsemapper-body">
<dt>body</dt><dd><p>(<a class="reference internal" href="../../../../../config/core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-datasource"><span class="std std-ref">config.core.v3.DataSource</span></a>) The new local reply body text if specified. It will be used in the <cite>%LOCAL_REPLY_BODY%</cite>
command operator in the <cite>body_format</cite>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-responsemapper-body-format-override">
<dt>body_format_override</dt><dd><p>(<a class="reference internal" href="../../../../../config/core/v3/substitution_format_string.proto.html#envoy-v3-api-msg-config-core-v3-substitutionformatstring"><span class="std std-ref">config.core.v3.SubstitutionFormatString</span></a>) A per mapper <cite>body_format</cite> to override the <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-localreplyconfig-body-format"><span class="std std-ref">body_format</span></a>.
It will be used when this mapper is matched.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-responsemapper-headers-to-add">
<dt>headers_to_add</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="../../../../../config/core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-headervalueoption"><span class="std std-ref">config.core.v3.HeaderValueOption</span></a>) HTTP headers to add to a local reply. This allows the response mapper to append, to add
or to override headers of any local reply before it is sent to a downstream client.</p>
</dd>
</dl>
</div>
<div class="section" id="extensions-filters-network-http-connection-manager-v3-rds">
<span id="envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-rds"></span><h2>extensions.filters.network.http_connection_manager.v3.Rds<a class="headerlink" href="#extensions-filters-network-http-connection-manager-v3-rds" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#L657">[extensions.filters.network.http_connection_manager.v3.Rds proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;config_source&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;route_config_name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-rds-config-source">
<dt>config_source</dt><dd><p>(<a class="reference internal" href="../../../../../config/core/v3/config_source.proto.html#envoy-v3-api-msg-config-core-v3-configsource"><span class="std std-ref">config.core.v3.ConfigSource</span></a>, <em>REQUIRED</em>) Configuration source specifier for RDS.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-rds-route-config-name">
<dt>route_config_name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) The name of the route configuration. This name will be passed to the RDS
API. This allows an Envoy configuration with multiple HTTP listeners (and
associated HTTP connection manager filters) to use different route
configurations.</p>
</dd>
</dl>
</div>
<div class="section" id="extensions-filters-network-http-connection-manager-v3-scopedrouteconfigurationslist">
<span id="envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-scopedrouteconfigurationslist"></span><h2>extensions.filters.network.http_connection_manager.v3.ScopedRouteConfigurationsList<a class="headerlink" href="#extensions-filters-network-http-connection-manager-v3-scopedrouteconfigurationslist" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#L672">[extensions.filters.network.http_connection_manager.v3.ScopedRouteConfigurationsList proto]</a></p>
<p>This message is used to work around the limitations with ‘oneof’ and repeated fields.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;scoped_route_configurations&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedrouteconfigurationslist-scoped-route-configurations">
<dt>scoped_route_configurations</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="../../../../../config/route/v3/scoped_route.proto.html#envoy-v3-api-msg-config-route-v3-scopedrouteconfiguration"><span class="std std-ref">config.route.v3.ScopedRouteConfiguration</span></a>, <em>REQUIRED</em>)</p>
</dd>
</dl>
</div>
<div class="section" id="extensions-filters-network-http-connection-manager-v3-scopedroutes">
<span id="envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-scopedroutes"></span><h2>extensions.filters.network.http_connection_manager.v3.ScopedRoutes<a class="headerlink" href="#extensions-filters-network-http-connection-manager-v3-scopedroutes" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#L681">[extensions.filters.network.http_connection_manager.v3.ScopedRoutes proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;scope_key_builder&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;rds_config_source&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;scoped_route_configurations_list&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;scoped_rds&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-name">
<dt>name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The name assigned to the scoped routing configuration.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-scope-key-builder">
<dt>scope_key_builder</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder"><span class="std std-ref">extensions.filters.network.http_connection_manager.v3.ScopedRoutes.ScopeKeyBuilder</span></a>, <em>REQUIRED</em>) The algorithm to use for constructing a scope key for each request.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-rds-config-source">
<dt>rds_config_source</dt><dd><p>(<a class="reference internal" href="../../../../../config/core/v3/config_source.proto.html#envoy-v3-api-msg-config-core-v3-configsource"><span class="std std-ref">config.core.v3.ConfigSource</span></a>, <em>REQUIRED</em>) Configuration source specifier for RDS.
This config source is used to subscribe to RouteConfiguration resources specified in
ScopedRouteConfiguration messages.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-scoped-route-configurations-list">
<dt>scoped_route_configurations_list</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-scopedrouteconfigurationslist"><span class="std std-ref">extensions.filters.network.http_connection_manager.v3.ScopedRouteConfigurationsList</span></a>) The set of routing scopes corresponding to the HCM. A scope is assigned to a request by
matching a key constructed from the request’s attributes according to the algorithm specified
by the
<a class="reference internal" href="#envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder"><span class="std std-ref">ScopeKeyBuilder</span></a>
in this message.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-scoped-route-configurations-list"><span class="std std-ref">scoped_route_configurations_list</span></a>, <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-scoped-rds"><span class="std std-ref">scoped_rds</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-scoped-rds">
<dt>scoped_rds</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-scopedrds"><span class="std std-ref">extensions.filters.network.http_connection_manager.v3.ScopedRds</span></a>) The set of routing scopes associated with the HCM will be dynamically loaded via the SRDS
API. A scope is assigned to a request by matching a key constructed from the request’s
attributes according to the algorithm specified by the
<a class="reference internal" href="#envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder"><span class="std std-ref">ScopeKeyBuilder</span></a>
in this message.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-scoped-route-configurations-list"><span class="std std-ref">scoped_route_configurations_list</span></a>, <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-scoped-rds"><span class="std std-ref">scoped_rds</span></a> must be set.</p>
</dd>
</dl>
</div>
<div class="section" id="extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder">
<span id="envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder"></span><h2>extensions.filters.network.http_connection_manager.v3.ScopedRoutes.ScopeKeyBuilder<a class="headerlink" href="#extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#L694">[extensions.filters.network.http_connection_manager.v3.ScopedRoutes.ScopeKeyBuilder proto]</a></p>
<p>Specifies the mechanism for constructing “scope keys” based on HTTP request attributes. These
keys are matched against a set of <a class="reference internal" href="../../../../../config/route/v3/scoped_route.proto.html#envoy-v3-api-msg-config-route-v3-scopedrouteconfiguration-key"><span class="std std-ref">Key</span></a>
objects assembled from <a class="reference internal" href="../../../../../config/route/v3/scoped_route.proto.html#envoy-v3-api-msg-config-route-v3-scopedrouteconfiguration"><span class="std std-ref">ScopedRouteConfiguration</span></a>
messages distributed via SRDS (the Scoped Route Discovery Service) or assigned statically via
<a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-scoped-route-configurations-list"><span class="std std-ref">scoped_route_configurations_list</span></a>.</p>
<p>Upon receiving a request’s headers, the Router will build a key using the algorithm specified
by this message. This key will be used to look up the routing table (i.e., the
<a class="reference internal" href="../../../../../config/route/v3/route.proto.html#envoy-v3-api-msg-config-route-v3-routeconfiguration"><span class="std std-ref">RouteConfiguration</span></a>) to use for the request.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;fragments&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragments">
<dt>fragments</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder"><span class="std std-ref">extensions.filters.network.http_connection_manager.v3.ScopedRoutes.ScopeKeyBuilder.FragmentBuilder</span></a>, <em>REQUIRED</em>) The final(built) scope key consists of the ordered union of these fragments, which are compared in order with the
fragments of a <a class="reference internal" href="../../../../../config/route/v3/scoped_route.proto.html#envoy-v3-api-msg-config-route-v3-scopedrouteconfiguration"><span class="std std-ref">ScopedRouteConfiguration</span></a>.
A missing fragment during comparison will make the key invalid, i.e., the computed key doesn’t match any key.</p>
</dd>
</dl>
</div>
<div class="section" id="extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder">
<span id="envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder"></span><h2>extensions.filters.network.http_connection_manager.v3.ScopedRoutes.ScopeKeyBuilder.FragmentBuilder<a class="headerlink" href="#extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#L699">[extensions.filters.network.http_connection_manager.v3.ScopedRoutes.ScopeKeyBuilder.FragmentBuilder proto]</a></p>
<p>Specifies the mechanism for constructing key fragments which are composed into scope keys.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;header_value_extractor&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder-header-value-extractor">
<dt>header_value_extractor</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder-headervalueextractor"><span class="std std-ref">extensions.filters.network.http_connection_manager.v3.ScopedRoutes.ScopeKeyBuilder.FragmentBuilder.HeaderValueExtractor</span></a>, <em>REQUIRED</em>) Specifies how a header field’s value should be extracted.</p>
</dd>
</dl>
</div>
<div class="section" id="extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder-headervalueextractor">
<span id="envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder-headervalueextractor"></span><h2>extensions.filters.network.http_connection_manager.v3.ScopedRoutes.ScopeKeyBuilder.FragmentBuilder.HeaderValueExtractor<a class="headerlink" href="#extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder-headervalueextractor" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#L721">[extensions.filters.network.http_connection_manager.v3.ScopedRoutes.ScopeKeyBuilder.FragmentBuilder.HeaderValueExtractor proto]</a></p>
<p>Specifies how the value of a header should be extracted.
The following example maps the structure of a header to the fields in this message.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>          <span class="o">&lt;</span><span class="mi">0</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span>   <span class="o">&lt;--</span> <span class="n">index</span>
<span class="n">X</span><span class="o">-</span><span class="n">Header</span><span class="p">:</span> <span class="n">a</span><span class="o">=</span><span class="n">b</span><span class="p">;</span><span class="n">c</span><span class="o">=</span><span class="n">d</span>
<span class="o">|</span>         <span class="o">||</span> <span class="o">|</span>
<span class="o">|</span>         <span class="o">||</span> \<span class="o">----&gt;</span> <span class="o">&lt;</span><span class="n">element_separator</span><span class="o">&gt;</span>
<span class="o">|</span>         <span class="o">||</span>
<span class="o">|</span>         <span class="o">|</span>\<span class="o">----&gt;</span> <span class="o">&lt;</span><span class="n">element</span><span class="o">.</span><span class="n">separator</span><span class="o">&gt;</span>
<span class="o">|</span>         <span class="o">|</span>
<span class="o">|</span>         \<span class="o">----&gt;</span> <span class="o">&lt;</span><span class="n">element</span><span class="o">.</span><span class="n">key</span><span class="o">&gt;</span>
<span class="o">|</span>
\<span class="o">----&gt;</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>

<span class="n">Each</span> <span class="s1">&#39;a=b&#39;</span> <span class="n">key</span><span class="o">-</span><span class="n">value</span> <span class="n">pair</span> <span class="n">constitutes</span> <span class="n">an</span> <span class="s1">&#39;element&#39;</span> <span class="n">of</span> <span class="n">the</span> <span class="n">header</span> <span class="n">field</span><span class="o">.</span>
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;element_separator&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;element&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder-headervalueextractor-name">
<dt>name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The name of the header field to extract the value from.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the header appears multiple times only the first value is used.</p>
</div>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder-headervalueextractor-element-separator">
<dt>element_separator</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) The element separator (e.g., ‘;’ separates ‘a;b;c;d’).
Default: empty string. This causes the entirety of the header field to be extracted.
If this field is set to an empty string and ‘index’ is used in the oneof below, ‘index’
must be set to 0.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder-headervalueextractor-index">
<dt>index</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">uint32</a>) Specifies the zero based index of the element to extract.
Note Envoy concatenates multiple values of the same header key into a comma separated
string, the splitting always happens after the concatenation.</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder-headervalueextractor-index"><span class="std std-ref">index</span></a>, <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder-headervalueextractor-element"><span class="std std-ref">element</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder-headervalueextractor-element">
<dt>element</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder-headervalueextractor-kvelement"><span class="std std-ref">extensions.filters.network.http_connection_manager.v3.ScopedRoutes.ScopeKeyBuilder.FragmentBuilder.HeaderValueExtractor.KvElement</span></a>) Specifies the key value pair to extract the value from.</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder-headervalueextractor-index"><span class="std std-ref">index</span></a>, <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder-headervalueextractor-element"><span class="std std-ref">element</span></a> may be set.</p>
</dd>
</dl>
</div>
<div class="section" id="extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder-headervalueextractor-kvelement">
<span id="envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder-headervalueextractor-kvelement"></span><h2>extensions.filters.network.http_connection_manager.v3.ScopedRoutes.ScopeKeyBuilder.FragmentBuilder.HeaderValueExtractor.KvElement<a class="headerlink" href="#extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder-headervalueextractor-kvelement" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#L727">[extensions.filters.network.http_connection_manager.v3.ScopedRoutes.ScopeKeyBuilder.FragmentBuilder.HeaderValueExtractor.KvElement proto]</a></p>
<p>Specifies a header field’s key value pair to match on.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;separator&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder-headervalueextractor-kvelement-separator">
<dt>separator</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The separator between key and value (e.g., ‘=’ separates ‘k=v;…’).
If an element is an empty string, the element is ignored.
If an element contains no separator, the whole element is parsed as key and the
fragment value is an empty string.
If there are multiple values for a matched key, the first value is returned.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedroutes-scopekeybuilder-fragmentbuilder-headervalueextractor-kvelement-key">
<dt>key</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The key to match on.</p>
</dd>
</dl>
</div>
<div class="section" id="extensions-filters-network-http-connection-manager-v3-scopedrds">
<span id="envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-scopedrds"></span><h2>extensions.filters.network.http_connection_manager.v3.ScopedRds<a class="headerlink" href="#extensions-filters-network-http-connection-manager-v3-scopedrds" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#L811">[extensions.filters.network.http_connection_manager.v3.ScopedRds proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;scoped_rds_config_source&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-scopedrds-scoped-rds-config-source">
<dt>scoped_rds_config_source</dt><dd><p>(<a class="reference internal" href="../../../../../config/core/v3/config_source.proto.html#envoy-v3-api-msg-config-core-v3-configsource"><span class="std std-ref">config.core.v3.ConfigSource</span></a>, <em>REQUIRED</em>) Configuration source specifier for scoped RDS.</p>
</dd>
</dl>
</div>
<div class="section" id="extensions-filters-network-http-connection-manager-v3-httpfilter">
<span id="envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-httpfilter"></span><h2>extensions.filters.network.http_connection_manager.v3.HttpFilter<a class="headerlink" href="#extensions-filters-network-http-connection-manager-v3-httpfilter" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#L821">[extensions.filters.network.http_connection_manager.v3.HttpFilter proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;typed_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;config_discovery&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpfilter-name">
<dt>name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The name of the filter configuration. The name is used as a fallback to
select an extension if the type of the configuration proto is not
sufficient. It also serves as a resource name in ExtensionConfigDS.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpfilter-typed-config">
<dt>typed_config</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#any">Any</a>) Filter specific configuration which depends on the filter being instantiated. See the supported
filters for further documentation.</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpfilter-typed-config"><span class="std std-ref">typed_config</span></a>, <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpfilter-config-discovery"><span class="std std-ref">config_discovery</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpfilter-config-discovery">
<dt>config_discovery</dt><dd><p>(<a class="reference internal" href="../../../../../config/core/v3/extension.proto.html#envoy-v3-api-msg-config-core-v3-extensionconfigsource"><span class="std std-ref">config.core.v3.ExtensionConfigSource</span></a>) Configuration source specifier for an extension configuration discovery service.
In case of a failure and without the default configuration, the HTTP listener responds with code 500.
Extension configs delivered through this mechanism are not expected to require warming (see <a class="reference external" href="https://github.com/envoyproxy/envoy/issues/12061">https://github.com/envoyproxy/envoy/issues/12061</a>).</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpfilter-typed-config"><span class="std std-ref">typed_config</span></a>, <a class="reference internal" href="#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpfilter-config-discovery"><span class="std std-ref">config_discovery</span></a> may be set.</p>
</dd>
</dl>
</div>
<div class="section" id="extensions-filters-network-http-connection-manager-v3-requestidextension">
<span id="envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-requestidextension"></span><h2>extensions.filters.network.http_connection_manager.v3.RequestIDExtension<a class="headerlink" href="#extensions-filters-network-http-connection-manager-v3-requestidextension" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#L846">[extensions.filters.network.http_connection_manager.v3.RequestIDExtension proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;typed_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-requestidextension-typed-config">
<dt>typed_config</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#any">Any</a>) Request ID extension specific configuration.</p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../kafka_broker/v3/kafka_broker.proto.html" class="btn btn-neutral float-right" title="Kafka Broker" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../../ext_authz/v3/ext_authz.proto.html" class="btn btn-neutral float-left" title="Network External Authorization" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2016-2021, Envoy Project Authors

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>