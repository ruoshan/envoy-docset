

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>HTTP route components &mdash; envoy 1.17.0-5c801b documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/envoy.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/sphinx_tabs/semantic-ui-2.4.1/segment.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/sphinx_tabs/semantic-ui-2.4.1/menu.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/sphinx_tabs/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/copybutton.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
        <script src="../../../../_static/clipboard.min.js"></script>
        <script src="../../../../_static/copybutton.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Extensions" href="../../config.html" />
    <link rel="prev" title="HTTP scoped routing configuration" href="scoped_route.proto.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html">
          

          
            
            <img src="../../../../_static/envoy-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.17.0-5c801b
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../start/start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../configuration/configuration.html">Configuration reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../api/api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../../api/api_supported_versions.html">Supported API versions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../api-v2/api.html">v2 API reference</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../api.html">v3 API reference</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../bootstrap/bootstrap.html">Bootstrap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../listeners/listeners.html">Listeners</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../clusters/clusters.html">Clusters</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../../http_routes/http_routes.html">HTTP route management</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="route.proto.html">HTTP route configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="scoped_route.proto.html">HTTP scoped routing configuration</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">HTTP route components</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../config.html">Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../admin/admin.html">Admin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../data/data.html">Envoy data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../service/service.html">Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../common_messages/common_messages.html">Common messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../types/types.html">Types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../api-docs/xds_protocol.html">xDS REST and gRPC protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../api/client_features.html">Well Known Client Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../faq/overview.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../version_history/version_history.html">Version history</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">envoy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../../api/api.html">API</a> &raquo;</li>
        
          <li><a href="../../../api.html">v3 API reference</a> &raquo;</li>
        
          <li><a href="../../../http_routes/http_routes.html">HTTP route management</a> &raquo;</li>
        
      <li>HTTP route components</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../_sources/api-v3/config/route/v3/route_components.proto.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="http-route-components">
<span id="envoy-v3-api-file-envoy-config-route-v3-route-components-proto"></span><h1>HTTP route components<a class="headerlink" href="#http-route-components" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Routing <a class="reference internal" href="../../../../intro/arch_overview/http/http_routing.html#arch-overview-http-routing"><span class="std std-ref">architecture overview</span></a></p></li>
<li><p>HTTP <a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router"><span class="std std-ref">router filter</span></a></p></li>
</ul>
<div class="section" id="config-route-v3-virtualhost">
<span id="envoy-v3-api-msg-config-route-v3-virtualhost"></span><h2>config.route.v3.VirtualHost<a class="headerlink" href="#config-route-v3-virtualhost" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L40">[config.route.v3.VirtualHost proto]</a></p>
<p>The top level element in the routing configuration is a virtual host. Each virtual host has
a logical name as well as a set of domains that get routed to it based on the incoming request’s
host header. This allows a single listener to service multiple top level domain path trees. Once
a virtual host is selected based on the domain, the routes are processed in order to see which
upstream cluster to route to or whether to perform a redirect.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;domains&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;routes&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;require_tls&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;virtual_clusters&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;rate_limits&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;request_headers_to_add&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;request_headers_to_remove&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;response_headers_to_add&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;response_headers_to_remove&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;cors&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;typed_per_filter_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;include_request_attempt_count&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;include_attempt_count_in_response&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;retry_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;hedge_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;per_request_buffer_limit_bytes&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-virtualhost-name">
<dt>name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The logical name of the virtual host. This is used when emitting certain
statistics but is not relevant for routing.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-virtualhost-domains">
<dt>domains</dt><dd><p>(<strong>repeated</strong> <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) A list of domains (host/authority header) that will be matched to this
virtual host. Wildcard hosts are supported in the suffix or prefix form.</p>
<dl class="simple">
<dt>Domain search order:</dt><dd><ol class="arabic simple">
<li><p>Exact domain names: <code class="docutils literal notranslate"><span class="pre">www.foo.com</span></code>.</p></li>
<li><p>Suffix domain wildcards: <code class="docutils literal notranslate"><span class="pre">*.foo.com</span></code> or <code class="docutils literal notranslate"><span class="pre">*-bar.foo.com</span></code>.</p></li>
<li><p>Prefix domain wildcards: <code class="docutils literal notranslate"><span class="pre">foo.*</span></code> or <code class="docutils literal notranslate"><span class="pre">foo-*</span></code>.</p></li>
<li><p>Special wildcard <code class="docutils literal notranslate"><span class="pre">*</span></code> matching any domain.</p></li>
</ol>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The wildcard will not match the empty string.
e.g. <code class="docutils literal notranslate"><span class="pre">*-bar.foo.com</span></code> will match <code class="docutils literal notranslate"><span class="pre">baz-bar.foo.com</span></code> but not <code class="docutils literal notranslate"><span class="pre">-bar.foo.com</span></code>.
The longest wildcards match first.
Only a single virtual host in the entire route configuration can match on <code class="docutils literal notranslate"><span class="pre">*</span></code>. A domain
must be unique across all virtual hosts or the config will fail to load.</p>
</div>
<p>Domains cannot contain control characters. This is validated by the well_known_regex HTTP_HEADER_VALUE.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-virtualhost-routes">
<dt>routes</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-route"><span class="std std-ref">config.route.v3.Route</span></a>) The list of routes that will be matched, in order, for incoming requests.
The first route that matches will be used.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-virtualhost-require-tls">
<dt>require_tls</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-enum-config-route-v3-virtualhost-tlsrequirementtype"><span class="std std-ref">config.route.v3.VirtualHost.TlsRequirementType</span></a>) Specifies the type of TLS enforcement the virtual host expects. If this option is not
specified, there is no TLS requirement for the virtual host.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-virtualhost-virtual-clusters">
<dt>virtual_clusters</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-virtualcluster"><span class="std std-ref">config.route.v3.VirtualCluster</span></a>) A list of virtual clusters defined for this virtual host. Virtual clusters
are used for additional statistics gathering.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-virtualhost-rate-limits">
<dt>rate_limits</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-ratelimit"><span class="std std-ref">config.route.v3.RateLimit</span></a>) Specifies a set of rate limit configurations that will be applied to the
virtual host.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-virtualhost-request-headers-to-add">
<dt>request_headers_to_add</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="../../core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-headervalueoption"><span class="std std-ref">config.core.v3.HeaderValueOption</span></a>) Specifies a list of HTTP headers that should be added to each request
handled by this virtual host. Headers specified at this level are applied
after headers from enclosed <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-route"><span class="std std-ref">config.route.v3.Route</span></a> and before headers from the
enclosing <a class="reference internal" href="route.proto.html#envoy-v3-api-msg-config-route-v3-routeconfiguration"><span class="std std-ref">config.route.v3.RouteConfiguration</span></a>. For more information, including
details on header value syntax, see the documentation on <a class="reference internal" href="../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-custom-request-headers"><span class="std std-ref">custom request headers</span></a>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-virtualhost-request-headers-to-remove">
<dt>request_headers_to_remove</dt><dd><p>(<strong>repeated</strong> <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Specifies a list of HTTP headers that should be removed from each request
handled by this virtual host.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-virtualhost-response-headers-to-add">
<dt>response_headers_to_add</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="../../core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-headervalueoption"><span class="std std-ref">config.core.v3.HeaderValueOption</span></a>) Specifies a list of HTTP headers that should be added to each response
handled by this virtual host. Headers specified at this level are applied
after headers from enclosed <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-route"><span class="std std-ref">config.route.v3.Route</span></a> and before headers from the
enclosing <a class="reference internal" href="route.proto.html#envoy-v3-api-msg-config-route-v3-routeconfiguration"><span class="std std-ref">config.route.v3.RouteConfiguration</span></a>. For more information, including
details on header value syntax, see the documentation on <a class="reference internal" href="../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-custom-request-headers"><span class="std std-ref">custom request headers</span></a>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-virtualhost-response-headers-to-remove">
<dt>response_headers_to_remove</dt><dd><p>(<strong>repeated</strong> <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Specifies a list of HTTP headers that should be removed from each response
handled by this virtual host.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-virtualhost-cors">
<dt>cors</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-corspolicy"><span class="std std-ref">config.route.v3.CorsPolicy</span></a>) Indicates that the virtual host has a CORS policy.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-virtualhost-typed-per-filter-config">
<dt>typed_per_filter_config</dt><dd><p>(<strong>repeated</strong> map&lt;<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#any">Any</a>&gt;) The per_filter_config field can be used to provide virtual host-specific
configurations for filters. The key should match the filter name, such as
<em>envoy.filters.http.buffer</em> for the HTTP buffer filter. Use of this field is filter
specific; see the <a class="reference internal" href="../../../../configuration/http/http_filters/http_filters.html#config-http-filters"><span class="std std-ref">HTTP filter documentation</span></a>
for if and how it is utilized.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-virtualhost-include-request-attempt-count">
<dt>include_request_attempt_count</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) Decides whether the <a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router-x-envoy-attempt-count"><span class="std std-ref">x-envoy-attempt-count</span></a> header should be included
in the upstream request. Setting this option will cause it to override any existing header
value, so in the case of two Envoys on the request path with this option enabled, the upstream
will see the attempt count as perceived by the second Envoy. Defaults to false.
This header is unaffected by the
<a class="reference internal" href="../../../extensions/filters/http/router/v3/router.proto.html#envoy-v3-api-field-extensions-filters-http-router-v3-router-suppress-envoy-headers"><span class="std std-ref">suppress_envoy_headers</span></a> flag.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-virtualhost-include-attempt-count-in-response">
<dt>include_attempt_count_in_response</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) Decides whether the <a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router-x-envoy-attempt-count"><span class="std std-ref">x-envoy-attempt-count</span></a> header should be included
in the downstream response. Setting this option will cause the router to override any existing header
value, so in the case of two Envoys on the request path with this option enabled, the downstream
will see the attempt count as perceived by the Envoy closest upstream from itself. Defaults to false.
This header is unaffected by the
<a class="reference internal" href="../../../extensions/filters/http/router/v3/router.proto.html#envoy-v3-api-field-extensions-filters-http-router-v3-router-suppress-envoy-headers"><span class="std std-ref">suppress_envoy_headers</span></a> flag.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-virtualhost-retry-policy">
<dt>retry_policy</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-retrypolicy"><span class="std std-ref">config.route.v3.RetryPolicy</span></a>) Indicates the retry policy for all routes in this virtual host. Note that setting a
route level entry will take precedence over this config and it’ll be treated
independently (e.g.: values are not inherited).</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-virtualhost-hedge-policy">
<dt>hedge_policy</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-hedgepolicy"><span class="std std-ref">config.route.v3.HedgePolicy</span></a>) Indicates the hedge policy for all routes in this virtual host. Note that setting a
route level entry will take precedence over this config and it’ll be treated
independently (e.g.: values are not inherited).</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-virtualhost-per-request-buffer-limit-bytes">
<dt>per_request_buffer_limit_bytes</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#uint32value">UInt32Value</a>) The maximum bytes which will be buffered for retries and shadowing.
If set and a route-specific limit is not set, the bytes actually buffered will be the minimum
value of this and the listener per_connection_buffer_limit_bytes.</p>
</dd>
</dl>
</div>
<div class="section" id="enum-config-route-v3-virtualhost-tlsrequirementtype">
<span id="envoy-v3-api-enum-config-route-v3-virtualhost-tlsrequirementtype"></span><h2>Enum config.route.v3.VirtualHost.TlsRequirementType<a class="headerlink" href="#enum-config-route-v3-virtualhost-tlsrequirementtype" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L43">[config.route.v3.VirtualHost.TlsRequirementType proto]</a></p>
<dl class="simple" id="envoy-v3-api-enum-value-config-route-v3-virtualhost-tlsrequirementtype-none">
<dt>NONE</dt><dd><p><em>(DEFAULT)</em> ⁣No TLS requirement for the virtual host.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-route-v3-virtualhost-tlsrequirementtype-external-only">
<dt>EXTERNAL_ONLY</dt><dd><p>⁣External requests must use TLS. If a request is external and it is not
using TLS, a 301 redirect will be sent telling the client to use HTTPS.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-route-v3-virtualhost-tlsrequirementtype-all">
<dt>ALL</dt><dd><p>⁣All requests must use TLS. If a request is not using TLS, a 301 redirect
will be sent telling the client to use HTTPS.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-filteraction">
<span id="envoy-v3-api-msg-config-route-v3-filteraction"></span><h2>config.route.v3.FilterAction<a class="headerlink" href="#config-route-v3-filteraction" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L189">[config.route.v3.FilterAction proto]</a></p>
<p>A filter-defined action type.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-filteraction-action">
<dt>action</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#any">Any</a>)</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-route">
<span id="envoy-v3-api-msg-config-route-v3-route"></span><h2>config.route.v3.Route<a class="headerlink" href="#config-route-v3-route" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L203">[config.route.v3.Route proto]</a></p>
<p>A route is both a specification of how to match a request as well as an indication of what to do
next (e.g., redirect, forward, rewrite, etc.).</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Envoy supports routing on HTTP method via <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-headermatcher"><span class="std std-ref">header matching</span></a>.</p>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;match&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;route&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;redirect&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;direct_response&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;metadata&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;decorator&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;typed_per_filter_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;request_headers_to_add&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;request_headers_to_remove&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;response_headers_to_add&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;response_headers_to_remove&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;tracing&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;per_request_buffer_limit_bytes&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-route-name">
<dt>name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Name for the route.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-route-match">
<dt>match</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-routematch"><span class="std std-ref">config.route.v3.RouteMatch</span></a>, <em>REQUIRED</em>) Route matching parameters.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-route-route">
<dt>route</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-routeaction"><span class="std std-ref">config.route.v3.RouteAction</span></a>) Route request to some upstream cluster.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-route-route"><span class="std std-ref">route</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-route-redirect"><span class="std std-ref">redirect</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-route-direct-response"><span class="std std-ref">direct_response</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-route-redirect">
<dt>redirect</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-redirectaction"><span class="std std-ref">config.route.v3.RedirectAction</span></a>) Return a redirect.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-route-route"><span class="std std-ref">route</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-route-redirect"><span class="std std-ref">redirect</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-route-direct-response"><span class="std std-ref">direct_response</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-route-direct-response">
<dt>direct_response</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-directresponseaction"><span class="std std-ref">config.route.v3.DirectResponseAction</span></a>) Return an arbitrary HTTP response directly, without proxying.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-route-route"><span class="std std-ref">route</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-route-redirect"><span class="std std-ref">redirect</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-route-direct-response"><span class="std std-ref">direct_response</span></a> must be set.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-route-metadata">
<dt>metadata</dt><dd><p>(<a class="reference internal" href="../../core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-metadata"><span class="std std-ref">config.core.v3.Metadata</span></a>) The Metadata field can be used to provide additional information
about the route. It can be used for configuration, stats, and logging.
The metadata should go under the filter namespace that will need it.
For instance, if the metadata is intended for the Router filter,
the filter name should be specified as <em>envoy.filters.http.router</em>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-route-decorator">
<dt>decorator</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-decorator"><span class="std std-ref">config.route.v3.Decorator</span></a>) Decorator for the matched route.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-route-typed-per-filter-config">
<dt>typed_per_filter_config</dt><dd><p>(<strong>repeated</strong> map&lt;<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#any">Any</a>&gt;) The typed_per_filter_config field can be used to provide route-specific
configurations for filters. The key should match the filter name, such as
<em>envoy.filters.http.buffer</em> for the HTTP buffer filter. Use of this field is filter
specific; see the <a class="reference internal" href="../../../../configuration/http/http_filters/http_filters.html#config-http-filters"><span class="std std-ref">HTTP filter documentation</span></a> for
if and how it is utilized.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-route-request-headers-to-add">
<dt>request_headers_to_add</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="../../core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-headervalueoption"><span class="std std-ref">config.core.v3.HeaderValueOption</span></a>) Specifies a set of headers that will be added to requests matching this
route. Headers specified at this level are applied before headers from the
enclosing <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-virtualhost"><span class="std std-ref">config.route.v3.VirtualHost</span></a> and
<a class="reference internal" href="route.proto.html#envoy-v3-api-msg-config-route-v3-routeconfiguration"><span class="std std-ref">config.route.v3.RouteConfiguration</span></a>. For more information, including details on
header value syntax, see the documentation on <a class="reference internal" href="../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-custom-request-headers"><span class="std std-ref">custom request headers</span></a>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-route-request-headers-to-remove">
<dt>request_headers_to_remove</dt><dd><p>(<strong>repeated</strong> <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Specifies a list of HTTP headers that should be removed from each request
matching this route.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-route-response-headers-to-add">
<dt>response_headers_to_add</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="../../core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-headervalueoption"><span class="std std-ref">config.core.v3.HeaderValueOption</span></a>) Specifies a set of headers that will be added to responses to requests
matching this route. Headers specified at this level are applied before
headers from the enclosing <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-virtualhost"><span class="std std-ref">config.route.v3.VirtualHost</span></a> and
<a class="reference internal" href="route.proto.html#envoy-v3-api-msg-config-route-v3-routeconfiguration"><span class="std std-ref">config.route.v3.RouteConfiguration</span></a>. For more information, including
details on header value syntax, see the documentation on
<a class="reference internal" href="../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-custom-request-headers"><span class="std std-ref">custom request headers</span></a>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-route-response-headers-to-remove">
<dt>response_headers_to_remove</dt><dd><p>(<strong>repeated</strong> <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Specifies a list of HTTP headers that should be removed from each response
to requests matching this route.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-route-tracing">
<dt>tracing</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-tracing"><span class="std std-ref">config.route.v3.Tracing</span></a>) Presence of the object defines whether the connection manager’s tracing configuration
is overridden by this route specific instance.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-route-per-request-buffer-limit-bytes">
<dt>per_request_buffer_limit_bytes</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#uint32value">UInt32Value</a>) The maximum bytes which will be buffered for retries and shadowing.
If set, the bytes actually buffered will be the minimum value of this and the
listener per_connection_buffer_limit_bytes.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-weightedcluster">
<span id="envoy-v3-api-msg-config-route-v3-weightedcluster"></span><h2>config.route.v3.WeightedCluster<a class="headerlink" href="#config-route-v3-weightedcluster" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L299">[config.route.v3.WeightedCluster proto]</a></p>
<p>Compared to the <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-cluster"><span class="std std-ref">cluster</span></a> field that specifies a
single upstream cluster as the target of a request, the <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-weighted-clusters"><span class="std std-ref">weighted_clusters</span></a> option allows for specification of
multiple upstream clusters along with weights that indicate the percentage of
traffic to be forwarded to each cluster. The router selects an upstream cluster based on the
weights.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;clusters&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;total_weight&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;runtime_key_prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-weightedcluster-clusters">
<dt>clusters</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-weightedcluster-clusterweight"><span class="std std-ref">config.route.v3.WeightedCluster.ClusterWeight</span></a>, <em>REQUIRED</em>) Specifies one or more upstream clusters associated with the route.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-weightedcluster-total-weight">
<dt>total_weight</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#uint32value">UInt32Value</a>) Specifies the total weight across all clusters. The sum of all cluster weights must equal this
value, which must be greater than 0. Defaults to 100.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-weightedcluster-runtime-key-prefix">
<dt>runtime_key_prefix</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Specifies the runtime key prefix that should be used to construct the
runtime keys associated with each cluster. When the <em>runtime_key_prefix</em> is
specified, the router will look for weights associated with each upstream
cluster under the key <em>runtime_key_prefix</em> + “.” + <em>cluster[i].name</em> where
<em>cluster[i]</em> denotes an entry in the clusters array field. If the runtime
key for the cluster does not exist, the value specified in the
configuration file will be used as the default weight. See the <a class="reference internal" href="../../../../operations/runtime.html#operations-runtime"><span class="std std-ref">runtime documentation</span></a> for how key names map to the underlying implementation.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-weightedcluster-clusterweight">
<span id="envoy-v3-api-msg-config-route-v3-weightedcluster-clusterweight"></span><h2>config.route.v3.WeightedCluster.ClusterWeight<a class="headerlink" href="#config-route-v3-weightedcluster-clusterweight" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L303">[config.route.v3.WeightedCluster.ClusterWeight proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;weight&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;metadata_match&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;request_headers_to_add&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;request_headers_to_remove&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;response_headers_to_add&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;response_headers_to_remove&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;typed_per_filter_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-weightedcluster-clusterweight-name">
<dt>name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) Name of the upstream cluster. The cluster must exist in the
<a class="reference internal" href="../../../../configuration/upstream/cluster_manager/cluster_manager.html#config-cluster-manager"><span class="std std-ref">cluster manager configuration</span></a>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-weightedcluster-clusterweight-weight">
<dt>weight</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#uint32value">UInt32Value</a>) An integer between 0 and <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-weightedcluster-total-weight"><span class="std std-ref">total_weight</span></a>. When a request matches the route,
the choice of an upstream cluster is determined by its weight. The sum of weights across all
entries in the clusters array must add up to the total_weight, which defaults to 100.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-weightedcluster-clusterweight-metadata-match">
<dt>metadata_match</dt><dd><p>(<a class="reference internal" href="../../core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-metadata"><span class="std std-ref">config.core.v3.Metadata</span></a>) Optional endpoint metadata match criteria used by the subset load balancer. Only endpoints in
the upstream cluster with metadata matching what is set in this field will be considered for
load balancing. Note that this will be merged with what’s provided in
<a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-metadata-match"><span class="std std-ref">RouteAction.metadata_match</span></a>, with
values here taking precedence. The filter name should be specified as <em>envoy.lb</em>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-weightedcluster-clusterweight-request-headers-to-add">
<dt>request_headers_to_add</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="../../core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-headervalueoption"><span class="std std-ref">config.core.v3.HeaderValueOption</span></a>) Specifies a list of headers to be added to requests when this cluster is selected
through the enclosing <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-routeaction"><span class="std std-ref">config.route.v3.RouteAction</span></a>.
Headers specified at this level are applied before headers from the enclosing
<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-route"><span class="std std-ref">config.route.v3.Route</span></a>, <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-virtualhost"><span class="std std-ref">config.route.v3.VirtualHost</span></a>, and
<a class="reference internal" href="route.proto.html#envoy-v3-api-msg-config-route-v3-routeconfiguration"><span class="std std-ref">config.route.v3.RouteConfiguration</span></a>. For more information, including details on
header value syntax, see the documentation on <a class="reference internal" href="../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-custom-request-headers"><span class="std std-ref">custom request headers</span></a>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-weightedcluster-clusterweight-request-headers-to-remove">
<dt>request_headers_to_remove</dt><dd><p>(<strong>repeated</strong> <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Specifies a list of HTTP headers that should be removed from each request when
this cluster is selected through the enclosing <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-routeaction"><span class="std std-ref">config.route.v3.RouteAction</span></a>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-weightedcluster-clusterweight-response-headers-to-add">
<dt>response_headers_to_add</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="../../core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-headervalueoption"><span class="std std-ref">config.core.v3.HeaderValueOption</span></a>) Specifies a list of headers to be added to responses when this cluster is selected
through the enclosing <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-routeaction"><span class="std std-ref">config.route.v3.RouteAction</span></a>.
Headers specified at this level are applied before headers from the enclosing
<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-route"><span class="std std-ref">config.route.v3.Route</span></a>, <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-virtualhost"><span class="std std-ref">config.route.v3.VirtualHost</span></a>, and
<a class="reference internal" href="route.proto.html#envoy-v3-api-msg-config-route-v3-routeconfiguration"><span class="std std-ref">config.route.v3.RouteConfiguration</span></a>. For more information, including details on
header value syntax, see the documentation on <a class="reference internal" href="../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-custom-request-headers"><span class="std std-ref">custom request headers</span></a>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-weightedcluster-clusterweight-response-headers-to-remove">
<dt>response_headers_to_remove</dt><dd><p>(<strong>repeated</strong> <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Specifies a list of headers to be removed from responses when this cluster is selected
through the enclosing <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-routeaction"><span class="std std-ref">config.route.v3.RouteAction</span></a>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-weightedcluster-clusterweight-typed-per-filter-config">
<dt>typed_per_filter_config</dt><dd><p>(<strong>repeated</strong> map&lt;<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#any">Any</a>&gt;) The per_filter_config field can be used to provide weighted cluster-specific
configurations for filters. The key should match the filter name, such as
<em>envoy.filters.http.buffer</em> for the HTTP buffer filter. Use of this field is filter
specific; see the <a class="reference internal" href="../../../../configuration/http/http_filters/http_filters.html#config-http-filters"><span class="std std-ref">HTTP filter documentation</span></a>
for if and how it is utilized.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-routematch">
<span id="envoy-v3-api-msg-config-route-v3-routematch"></span><h2>config.route.v3.RouteMatch<a class="headerlink" href="#config-route-v3-routematch" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L387">[config.route.v3.RouteMatch proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;safe_regex&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;connect_matcher&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;case_sensitive&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;runtime_fraction&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;headers&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;query_parameters&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;grpc&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;tls_context&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-v3-api-field-config-route-v3-routematch-prefix">
<dt>prefix</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) If specified, the route is a prefix rule meaning that the prefix must
match the beginning of the <em>:path</em> header.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routematch-prefix"><span class="std std-ref">prefix</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routematch-path"><span class="std std-ref">path</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routematch-safe-regex"><span class="std std-ref">safe_regex</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routematch-connect-matcher"><span class="std std-ref">connect_matcher</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routematch-path">
<dt>path</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) If specified, the route is an exact path rule meaning that the path must
exactly match the <em>:path</em> header once the query string is removed.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routematch-prefix"><span class="std std-ref">prefix</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routematch-path"><span class="std std-ref">path</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routematch-safe-regex"><span class="std std-ref">safe_regex</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routematch-connect-matcher"><span class="std std-ref">connect_matcher</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routematch-safe-regex">
<dt>safe_regex</dt><dd><p>(<a class="reference internal" href="../../../type/matcher/v3/regex.proto.html#envoy-v3-api-msg-type-matcher-v3-regexmatcher"><span class="std std-ref">type.matcher.v3.RegexMatcher</span></a>) If specified, the route is a regular expression rule meaning that the
regex must match the <em>:path</em> header once the query string is removed. The entire path
(without the query string) must match the regex. The rule will not match if only a
subsequence of the <em>:path</em> header matches the regex.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routematch-prefix"><span class="std std-ref">prefix</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routematch-path"><span class="std std-ref">path</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routematch-safe-regex"><span class="std std-ref">safe_regex</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routematch-connect-matcher"><span class="std std-ref">connect_matcher</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routematch-connect-matcher">
<dt>connect_matcher</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-routematch-connectmatcher"><span class="std std-ref">config.route.v3.RouteMatch.ConnectMatcher</span></a>) If this is used as the matcher, the matcher will only match CONNECT requests.
Note that this will not match HTTP/2 upgrade-style CONNECT requests
(WebSocket and the like) as they are normalized in Envoy as HTTP/1.1 style
upgrades.
This is the only way to match CONNECT requests for HTTP/1.1. For HTTP/2,
where Extended CONNECT requests may have a path, the path matchers will work if
there is a path present.
Note that CONNECT support is currently considered alpha in Envoy.
[#comment:TODO(htuch): Replace the above comment with an alpha tag.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routematch-prefix"><span class="std std-ref">prefix</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routematch-path"><span class="std std-ref">path</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routematch-safe-regex"><span class="std std-ref">safe_regex</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routematch-connect-matcher"><span class="std std-ref">connect_matcher</span></a> must be set.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routematch-case-sensitive">
<dt>case_sensitive</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#boolvalue">BoolValue</a>) Indicates that prefix/path matching should be case sensitive. The default
is true.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routematch-runtime-fraction">
<dt>runtime_fraction</dt><dd><p>(<a class="reference internal" href="../../core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-runtimefractionalpercent"><span class="std std-ref">config.core.v3.RuntimeFractionalPercent</span></a>) Indicates that the route should additionally match on a runtime key. Every time the route
is considered for a match, it must also fall under the percentage of matches indicated by
this field. For some fraction N/D, a random number in the range [0,D) is selected. If the
number is &lt;= the value of the numerator N, or if the key is not present, the default
value, the router continues to evaluate the remaining match criteria. A runtime_fraction
route configuration can be used to roll out route changes in a gradual manner without full
code/config deploys. Refer to the <a class="reference internal" href="../../../../configuration/http/http_conn_man/traffic_splitting.html#config-http-conn-man-route-table-traffic-splitting-shift"><span class="std std-ref">traffic shifting</span></a> docs for additional documentation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Parsing this field is implemented such that the runtime key’s data may be represented
as a FractionalPercent proto represented as JSON/YAML and may also be represented as an
integer with the assumption that the value is an integral percentage out of 100. For
instance, a runtime key lookup returning the value “42” would parse as a FractionalPercent
whose numerator is 42 and denominator is HUNDRED. This preserves legacy semantics.</p>
</div>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routematch-headers">
<dt>headers</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-headermatcher"><span class="std std-ref">config.route.v3.HeaderMatcher</span></a>) Specifies a set of headers that the route should match on. The router will
check the request’s headers against all the specified headers in the route
config. A match will happen if all the headers in the route are present in
the request with the same values (or based on presence if the value field
is not in the config).</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routematch-query-parameters">
<dt>query_parameters</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-queryparametermatcher"><span class="std std-ref">config.route.v3.QueryParameterMatcher</span></a>) Specifies a set of URL query parameters on which the route should
match. The router will check the query string from the <em>path</em> header
against all the specified query parameters. If the number of specified
query parameters is nonzero, they all must match the <em>path</em> header’s
query string for a match to occur.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routematch-grpc">
<dt>grpc</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-routematch-grpcroutematchoptions"><span class="std std-ref">config.route.v3.RouteMatch.GrpcRouteMatchOptions</span></a>) If specified, only gRPC requests will be matched. The router will check
that the content-type header has a application/grpc or one of the various
application/grpc+ values.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routematch-tls-context">
<dt>tls_context</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-routematch-tlscontextmatchoptions"><span class="std std-ref">config.route.v3.RouteMatch.TlsContextMatchOptions</span></a>) If specified, the client tls context will be matched against the defined
match options.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-routematch-grpcroutematchoptions">
<span id="envoy-v3-api-msg-config-route-v3-routematch-grpcroutematchoptions"></span><h2>config.route.v3.RouteMatch.GrpcRouteMatchOptions<a class="headerlink" href="#config-route-v3-routematch-grpcroutematchoptions" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L390">[config.route.v3.RouteMatch.GrpcRouteMatchOptions proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{}</span>
</pre></div>
</div>
</div>
<div class="section" id="config-route-v3-routematch-tlscontextmatchoptions">
<span id="envoy-v3-api-msg-config-route-v3-routematch-tlscontextmatchoptions"></span><h2>config.route.v3.RouteMatch.TlsContextMatchOptions<a class="headerlink" href="#config-route-v3-routematch-tlscontextmatchoptions" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L395">[config.route.v3.RouteMatch.TlsContextMatchOptions proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;presented&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;validated&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routematch-tlscontextmatchoptions-presented">
<dt>presented</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#boolvalue">BoolValue</a>) If specified, the route will match against whether or not a certificate is presented.
If not specified, certificate presentation status (true or false) will not be considered when route matching.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routematch-tlscontextmatchoptions-validated">
<dt>validated</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#boolvalue">BoolValue</a>) If specified, the route will match against whether or not a certificate is validated.
If not specified, certificate validation status (true or false) will not be considered when route matching.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-routematch-connectmatcher">
<span id="envoy-v3-api-msg-config-route-v3-routematch-connectmatcher"></span><h2>config.route.v3.RouteMatch.ConnectMatcher<a class="headerlink" href="#config-route-v3-routematch-connectmatcher" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L409">[config.route.v3.RouteMatch.ConnectMatcher proto]</a></p>
<p>An extensible message for matching CONNECT requests.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{}</span>
</pre></div>
</div>
</div>
<div class="section" id="config-route-v3-corspolicy">
<span id="envoy-v3-api-msg-config-route-v3-corspolicy"></span><h2>config.route.v3.CorsPolicy<a class="headerlink" href="#config-route-v3-corspolicy" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L502">[config.route.v3.CorsPolicy proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;allow_origin_string_match&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;allow_methods&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;allow_headers&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;expose_headers&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;max_age&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;allow_credentials&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;filter_enabled&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;shadow_enabled&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-corspolicy-allow-origin-string-match">
<dt>allow_origin_string_match</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="../../../type/matcher/v3/string.proto.html#envoy-v3-api-msg-type-matcher-v3-stringmatcher"><span class="std std-ref">type.matcher.v3.StringMatcher</span></a>) Specifies string patterns that match allowed origins. An origin is allowed if any of the
string matchers match.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-corspolicy-allow-methods">
<dt>allow_methods</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Specifies the content for the <em>access-control-allow-methods</em> header.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-corspolicy-allow-headers">
<dt>allow_headers</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Specifies the content for the <em>access-control-allow-headers</em> header.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-corspolicy-expose-headers">
<dt>expose_headers</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Specifies the content for the <em>access-control-expose-headers</em> header.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-corspolicy-max-age">
<dt>max_age</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Specifies the content for the <em>access-control-max-age</em> header.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-corspolicy-allow-credentials">
<dt>allow_credentials</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#boolvalue">BoolValue</a>) Specifies whether the resource allows credentials.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-corspolicy-filter-enabled">
<dt>filter_enabled</dt><dd><p>(<a class="reference internal" href="../../core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-runtimefractionalpercent"><span class="std std-ref">config.core.v3.RuntimeFractionalPercent</span></a>) Specifies the % of requests for which the CORS filter is enabled.</p>
<p>If neither <code class="docutils literal notranslate"><span class="pre">enabled</span></code>, <code class="docutils literal notranslate"><span class="pre">filter_enabled</span></code>, nor <code class="docutils literal notranslate"><span class="pre">shadow_enabled</span></code> are specified, the CORS
filter will be enabled for 100% of the requests.</p>
<p>If <a class="reference internal" href="../../core/v3/base.proto.html#envoy-v3-api-field-config-core-v3-runtimefractionalpercent-runtime-key"><span class="std std-ref">runtime_key</span></a> is
specified, Envoy will lookup the runtime key to get the percentage of requests to filter.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-corspolicy-shadow-enabled">
<dt>shadow_enabled</dt><dd><p>(<a class="reference internal" href="../../core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-runtimefractionalpercent"><span class="std std-ref">config.core.v3.RuntimeFractionalPercent</span></a>) Specifies the % of requests for which the CORS policies will be evaluated and tracked, but not
enforced.</p>
<p>This field is intended to be used when <code class="docutils literal notranslate"><span class="pre">filter_enabled</span></code> and <code class="docutils literal notranslate"><span class="pre">enabled</span></code> are off. One of those
fields have to explicitly disable the filter in order for this setting to take effect.</p>
<p>If <a class="reference internal" href="../../core/v3/base.proto.html#envoy-v3-api-field-config-core-v3-runtimefractionalpercent-runtime-key"><span class="std std-ref">runtime_key</span></a> is specified,
Envoy will lookup the runtime key to get the percentage of requests for which it will evaluate
and track the request’s <em>Origin</em> to determine if it’s valid but will not enforce any policies.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-routeaction">
<span id="envoy-v3-api-msg-config-route-v3-routeaction"></span><h2>config.route.v3.RouteAction<a class="headerlink" href="#config-route-v3-routeaction" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L552">[config.route.v3.RouteAction proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;cluster&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;cluster_header&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;weighted_clusters&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;cluster_not_found_response_code&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;metadata_match&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;prefix_rewrite&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;regex_rewrite&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;host_rewrite_literal&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;auto_host_rewrite&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;host_rewrite_header&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;host_rewrite_path_regex&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;timeout&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;idle_timeout&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;retry_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;request_mirror_policies&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;priority&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;rate_limits&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;include_vh_rate_limits&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;hash_policy&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;cors&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;max_grpc_timeout&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;grpc_timeout_offset&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;upgrade_configs&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;internal_redirect_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;internal_redirect_action&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;max_internal_redirects&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;hedge_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;max_stream_duration&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-v3-api-field-config-route-v3-routeaction-cluster">
<dt>cluster</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Indicates the upstream cluster to which the request should be routed
to.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-cluster"><span class="std std-ref">cluster</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-cluster-header"><span class="std std-ref">cluster_header</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-weighted-clusters"><span class="std std-ref">weighted_clusters</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routeaction-cluster-header">
<dt>cluster_header</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Envoy will determine the cluster to route to by reading the value of the
HTTP header named by cluster_header from the request headers. If the
header is not found or the referenced cluster does not exist, Envoy will
return a 404 response.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Internally, Envoy always uses the HTTP/2 <em>:authority</em> header to represent the HTTP/1
<em>Host</em> header. Thus, if attempting to match on <em>Host</em>, match on <em>:authority</em> instead.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the header appears multiple times only the first value is used.</p>
</div>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-cluster"><span class="std std-ref">cluster</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-cluster-header"><span class="std std-ref">cluster_header</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-weighted-clusters"><span class="std std-ref">weighted_clusters</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routeaction-weighted-clusters">
<dt>weighted_clusters</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-weightedcluster"><span class="std std-ref">config.route.v3.WeightedCluster</span></a>) Multiple upstream clusters can be specified for a given route. The
request is routed to one of the upstream clusters based on weights
assigned to each cluster. See
<a class="reference internal" href="../../../../configuration/http/http_conn_man/traffic_splitting.html#config-http-conn-man-route-table-traffic-splitting-split"><span class="std std-ref">traffic splitting</span></a>
for additional documentation.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-cluster"><span class="std std-ref">cluster</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-cluster-header"><span class="std std-ref">cluster_header</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-weighted-clusters"><span class="std std-ref">weighted_clusters</span></a> must be set.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-cluster-not-found-response-code">
<dt>cluster_not_found_response_code</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-enum-config-route-v3-routeaction-clusternotfoundresponsecode"><span class="std std-ref">config.route.v3.RouteAction.ClusterNotFoundResponseCode</span></a>) The HTTP status code to use when configured cluster is not found.
The default response code is 503 Service Unavailable.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-metadata-match">
<dt>metadata_match</dt><dd><p>(<a class="reference internal" href="../../core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-metadata"><span class="std std-ref">config.core.v3.Metadata</span></a>) Optional endpoint metadata match criteria used by the subset load balancer. Only endpoints
in the upstream cluster with metadata matching what’s set in this field will be considered
for load balancing. If using <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-weighted-clusters"><span class="std std-ref">weighted_clusters</span></a>, metadata will be merged, with values
provided there taking precedence. The filter name should be specified as <em>envoy.lb</em>.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routeaction-prefix-rewrite">
<dt>prefix_rewrite</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Indicates that during forwarding, the matched prefix (or path) should be
swapped with this value. This option allows application URLs to be rooted
at a different path from those exposed at the reverse proxy layer. The router filter will
place the original path before rewrite into the <a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router-x-envoy-original-path"><span class="std std-ref">x-envoy-original-path</span></a> header.</p>
<p>Only one of <em>prefix_rewrite</em> or
<a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-regex-rewrite"><span class="std std-ref">regex_rewrite</span></a>
may be specified.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Pay careful attention to the use of trailing slashes in the
<a class="reference internal" href="#envoy-v3-api-field-config-route-v3-route-match"><span class="std std-ref">route’s match</span></a> prefix value.
Stripping a prefix from a path requires multiple Routes to handle all cases. For example,
rewriting <em>/prefix</em> to <em>/</em> and <em>/prefix/etc</em> to <em>/etc</em> cannot be done in a single
<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-route"><span class="std std-ref">Route</span></a>, as shown by the below config entries:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">match</span><span class="p">:</span>
    <span class="nt">prefix</span><span class="p">:</span> <span class="s">&quot;/prefix/&quot;</span>
  <span class="nt">route</span><span class="p">:</span>
    <span class="nt">prefix_rewrite</span><span class="p">:</span> <span class="s">&quot;/&quot;</span>
<span class="p p-Indicator">-</span> <span class="nt">match</span><span class="p">:</span>
    <span class="nt">prefix</span><span class="p">:</span> <span class="s">&quot;/prefix&quot;</span>
  <span class="nt">route</span><span class="p">:</span>
    <span class="nt">prefix_rewrite</span><span class="p">:</span> <span class="s">&quot;/&quot;</span>
</pre></div>
</div>
<p>Having above entries in the config, requests to <em>/prefix</em> will be stripped to <em>/</em>, while
requests to <em>/prefix/etc</em> will be stripped to <em>/etc</em>.</p>
</div>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routeaction-regex-rewrite">
<dt>regex_rewrite</dt><dd><p>(<a class="reference internal" href="../../../type/matcher/v3/regex.proto.html#envoy-v3-api-msg-type-matcher-v3-regexmatchandsubstitute"><span class="std std-ref">type.matcher.v3.RegexMatchAndSubstitute</span></a>) Indicates that during forwarding, portions of the path that match the
pattern should be rewritten, even allowing the substitution of capture
groups from the pattern into the new path as specified by the rewrite
substitution string. This is useful to allow application paths to be
rewritten in a way that is aware of segments with variable content like
identifiers. The router filter will place the original path as it was
before the rewrite into the <a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router-x-envoy-original-path"><span class="std std-ref">x-envoy-original-path</span></a> header.</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-prefix-rewrite"><span class="std std-ref">prefix_rewrite</span></a>
or <em>regex_rewrite</em> may be specified.</p>
<p>Examples using Google’s <a class="reference external" href="https://github.com/google/re2">RE2</a> engine:</p>
<ul class="simple">
<li><p>The path pattern <code class="docutils literal notranslate"><span class="pre">^/service/([^/]+)(/.*)$</span></code> paired with a substitution
string of <code class="docutils literal notranslate"><span class="pre">\2/instance/\1</span></code> would transform <code class="docutils literal notranslate"><span class="pre">/service/foo/v1/api</span></code>
into <code class="docutils literal notranslate"><span class="pre">/v1/api/instance/foo</span></code>.</p></li>
<li><p>The pattern <code class="docutils literal notranslate"><span class="pre">one</span></code> paired with a substitution string of <code class="docutils literal notranslate"><span class="pre">two</span></code> would
transform <code class="docutils literal notranslate"><span class="pre">/xxx/one/yyy/one/zzz</span></code> into <code class="docutils literal notranslate"><span class="pre">/xxx/two/yyy/two/zzz</span></code>.</p></li>
<li><p>The pattern <code class="docutils literal notranslate"><span class="pre">^(.*?)one(.*)$</span></code> paired with a substitution string of
<code class="docutils literal notranslate"><span class="pre">\1two\2</span></code> would replace only the first occurrence of <code class="docutils literal notranslate"><span class="pre">one</span></code>,
transforming path <code class="docutils literal notranslate"><span class="pre">/xxx/one/yyy/one/zzz</span></code> into <code class="docutils literal notranslate"><span class="pre">/xxx/two/yyy/one/zzz</span></code>.</p></li>
<li><p>The pattern <code class="docutils literal notranslate"><span class="pre">(?i)/xxx/</span></code> paired with a substitution string of <code class="docutils literal notranslate"><span class="pre">/yyy/</span></code>
would do a case-insensitive match and transform path <code class="docutils literal notranslate"><span class="pre">/aaa/XxX/bbb</span></code> to
<code class="docutils literal notranslate"><span class="pre">/aaa/yyy/bbb</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routeaction-host-rewrite-literal">
<dt>host_rewrite_literal</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Indicates that during forwarding, the host header will be swapped with
this value.</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-host-rewrite-literal"><span class="std std-ref">host_rewrite_literal</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-auto-host-rewrite"><span class="std std-ref">auto_host_rewrite</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-host-rewrite-header"><span class="std std-ref">host_rewrite_header</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-host-rewrite-path-regex"><span class="std std-ref">host_rewrite_path_regex</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routeaction-auto-host-rewrite">
<dt>auto_host_rewrite</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#boolvalue">BoolValue</a>) Indicates that during forwarding, the host header will be swapped with
the hostname of the upstream host chosen by the cluster manager. This
option is applicable only when the destination cluster for a route is of
type <em>strict_dns</em> or <em>logical_dns</em>. Setting this to true with other cluster
types has no effect.</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-host-rewrite-literal"><span class="std std-ref">host_rewrite_literal</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-auto-host-rewrite"><span class="std std-ref">auto_host_rewrite</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-host-rewrite-header"><span class="std std-ref">host_rewrite_header</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-host-rewrite-path-regex"><span class="std std-ref">host_rewrite_path_regex</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routeaction-host-rewrite-header">
<dt>host_rewrite_header</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Indicates that during forwarding, the host header will be swapped with the content of given
downstream or <a class="reference internal" href="../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-custom-request-headers"><span class="std std-ref">custom</span></a> header.
If header value is empty, host header is left intact.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Pay attention to the potential security implications of using this option. Provided header
must come from trusted source.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the header appears multiple times only the first value is used.</p>
</div>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-host-rewrite-literal"><span class="std std-ref">host_rewrite_literal</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-auto-host-rewrite"><span class="std std-ref">auto_host_rewrite</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-host-rewrite-header"><span class="std std-ref">host_rewrite_header</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-host-rewrite-path-regex"><span class="std std-ref">host_rewrite_path_regex</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routeaction-host-rewrite-path-regex">
<dt>host_rewrite_path_regex</dt><dd><p>(<a class="reference internal" href="../../../type/matcher/v3/regex.proto.html#envoy-v3-api-msg-type-matcher-v3-regexmatchandsubstitute"><span class="std std-ref">type.matcher.v3.RegexMatchAndSubstitute</span></a>) Indicates that during forwarding, the host header will be swapped with
the result of the regex substitution executed on path value with query and fragment removed.
This is useful for transitioning variable content between path segment and subdomain.</p>
<p>For example with the following config:</p>
<blockquote>
<div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">host_rewrite_path_regex</span><span class="p">:</span>
  <span class="nt">pattern</span><span class="p">:</span>
    <span class="nt">google_re2</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
    <span class="nt">regex</span><span class="p">:</span> <span class="s">&quot;^/(.+)/.+$&quot;</span>
  <span class="nt">substitution</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">\1</span>
</pre></div>
</div>
</div></blockquote>
<p>Would rewrite the host header to <cite>envoyproxy.io</cite> given the path <cite>/envoyproxy.io/some/path</cite>.</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-host-rewrite-literal"><span class="std std-ref">host_rewrite_literal</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-auto-host-rewrite"><span class="std std-ref">auto_host_rewrite</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-host-rewrite-header"><span class="std std-ref">host_rewrite_header</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-host-rewrite-path-regex"><span class="std std-ref">host_rewrite_path_regex</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routeaction-timeout">
<dt>timeout</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) Specifies the upstream timeout for the route. If not specified, the default is 15s. This
spans between the point at which the entire downstream request (i.e. end-of-stream) has been
processed and when the upstream response has been completely processed. A value of 0 will
disable the route’s timeout.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This timeout includes all retries. See also
<a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router-x-envoy-upstream-rq-timeout-ms"><span class="std std-ref">x-envoy-upstream-rq-timeout-ms</span></a>,
<a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router-x-envoy-upstream-rq-per-try-timeout-ms"><span class="std std-ref">x-envoy-upstream-rq-per-try-timeout-ms</span></a>, and the
<a class="reference internal" href="../../../../intro/arch_overview/http/http_routing.html#arch-overview-http-routing-retry"><span class="std std-ref">retry overview</span></a>.</p>
</div>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routeaction-idle-timeout">
<dt>idle_timeout</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) Specifies the idle timeout for the route. If not specified, there is no per-route idle timeout,
although the connection manager wide <a class="reference internal" href="../../../extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto.html#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-stream-idle-timeout"><span class="std std-ref">stream_idle_timeout</span></a>
will still apply. A value of 0 will completely disable the route’s idle timeout, even if a
connection manager stream idle timeout is configured.</p>
<p>The idle timeout is distinct to <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-timeout"><span class="std std-ref">timeout</span></a>, which provides an upper bound
on the upstream response time; <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-idle-timeout"><span class="std std-ref">idle_timeout</span></a> instead bounds the amount
of time the request’s stream may be idle.</p>
<p>After header decoding, the idle timeout will apply on downstream and
upstream request events. Each time an encode/decode event for headers or
data is processed for the stream, the timer will be reset. If the timeout
fires, the stream is terminated with a 408 Request Timeout error code if no
upstream response header has been received, otherwise a stream reset
occurs.</p>
<p>If the <a class="reference internal" href="../../../../configuration/operations/overload_manager/overload_manager.html#config-overload-manager-overload-actions"><span class="std std-ref">overload action</span></a> “envoy.overload_actions.reduce_timeouts”
is configured, this timeout is scaled according to the value for
<a class="reference internal" href="../../overload/v3/overload.proto.html#envoy-v3-api-enum-value-config-overload-v3-scaletimersoverloadactionconfig-timertype-http-downstream-stream-idle"><span class="std std-ref">HTTP_DOWNSTREAM_STREAM_IDLE</span></a>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-retry-policy">
<dt>retry_policy</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-retrypolicy"><span class="std std-ref">config.route.v3.RetryPolicy</span></a>) Indicates that the route has a retry policy. Note that if this is set,
it’ll take precedence over the virtual host level retry policy entirely
(e.g.: policies are not merged, most internal one becomes the enforced policy).</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-request-mirror-policies">
<dt>request_mirror_policies</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-routeaction-requestmirrorpolicy"><span class="std std-ref">config.route.v3.RouteAction.RequestMirrorPolicy</span></a>) Indicates that the route has request mirroring policies.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-priority">
<dt>priority</dt><dd><p>(<a class="reference internal" href="../../core/v3/base.proto.html#envoy-v3-api-enum-config-core-v3-routingpriority"><span class="std std-ref">config.core.v3.RoutingPriority</span></a>) Optionally specifies the <a class="reference internal" href="../../../../intro/arch_overview/http/http_routing.html#arch-overview-http-routing-priority"><span class="std std-ref">routing priority</span></a>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-rate-limits">
<dt>rate_limits</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-ratelimit"><span class="std std-ref">config.route.v3.RateLimit</span></a>) Specifies a set of rate limit configurations that could be applied to the
route.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routeaction-include-vh-rate-limits">
<dt>include_vh_rate_limits</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#boolvalue">BoolValue</a>) Specifies if the rate limit filter should include the virtual host rate
limits. By default, if the route configured rate limits, the virtual host
<a class="reference internal" href="#envoy-v3-api-field-config-route-v3-virtualhost-rate-limits"><span class="std std-ref">rate_limits</span></a> are not applied to the
request.</p>
<p>This field is deprecated. Please use <a class="reference internal" href="../../../extensions/filters/http/ratelimit/v3/rate_limit.proto.html#envoy-v3-api-field-extensions-filters-http-ratelimit-v3-ratelimitperroute-vh-rate-limits"><span class="std std-ref">vh_rate_limits</span></a></p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-hash-policy">
<dt>hash_policy</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-routeaction-hashpolicy"><span class="std std-ref">config.route.v3.RouteAction.HashPolicy</span></a>) Specifies a list of hash policies to use for ring hash load balancing. Each
hash policy is evaluated individually and the combined result is used to
route the request. The method of combination is deterministic such that
identical lists of hash policies will produce the same hash. Since a hash
policy examines specific parts of a request, it can fail to produce a hash
(i.e. if the hashed header is not present). If (and only if) all configured
hash policies fail to generate a hash, no hash will be produced for
the route. In this case, the behavior is the same as if no hash policies
were specified (i.e. the ring hash load balancer will choose a random
backend). If a hash policy has the “terminal” attribute set to true, and
there is already a hash generated, the hash is returned immediately,
ignoring the rest of the hash policy list.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-cors">
<dt>cors</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-corspolicy"><span class="std std-ref">config.route.v3.CorsPolicy</span></a>) Indicates that the route has a CORS policy.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routeaction-max-grpc-timeout">
<dt>max_grpc_timeout</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) Deprecated by <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-maxstreamduration-grpc-timeout-header-max"><span class="std std-ref">grpc_timeout_header_max</span></a>
If present, and the request is a gRPC request, use the
<a class="reference external" href="https://github.com/grpc/grpc/blob/master/doc/PROTOCOL-HTTP2.md">grpc-timeout header</a>,
or its default value (infinity) instead of
<a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-timeout"><span class="std std-ref">timeout</span></a>, but limit the applied timeout
to the maximum value specified here. If configured as 0, the maximum allowed timeout for
gRPC requests is infinity. If not configured at all, the <cite>grpc-timeout</cite> header is not used
and gRPC requests time out like any other requests using
<a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-timeout"><span class="std std-ref">timeout</span></a> or its default.
This can be used to prevent unexpected upstream request timeouts due to potentially long
time gaps between gRPC request and response in gRPC streaming mode.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If a timeout is specified using <a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router-x-envoy-upstream-rq-timeout-ms"><span class="std std-ref">x-envoy-upstream-rq-timeout-ms</span></a>, it takes
precedence over <a class="reference external" href="https://github.com/grpc/grpc/blob/master/doc/PROTOCOL-HTTP2.md">grpc-timeout header</a>, when
both are present. See also
<a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router-x-envoy-upstream-rq-timeout-ms"><span class="std std-ref">x-envoy-upstream-rq-timeout-ms</span></a>,
<a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router-x-envoy-upstream-rq-per-try-timeout-ms"><span class="std std-ref">x-envoy-upstream-rq-per-try-timeout-ms</span></a>, and the
<a class="reference internal" href="../../../../intro/arch_overview/http/http_routing.html#arch-overview-http-routing-retry"><span class="std std-ref">retry overview</span></a>.</p>
</div>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-grpc-timeout-offset">
<dt>grpc_timeout_offset</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) Deprecated by <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-maxstreamduration-grpc-timeout-header-offset"><span class="std std-ref">grpc_timeout_header_offset</span></a>.
If present, Envoy will adjust the timeout provided by the <cite>grpc-timeout</cite> header by subtracting
the provided duration from the header. This is useful in allowing Envoy to set its global
timeout to be less than that of the deadline imposed by the calling client, which makes it more
likely that Envoy will handle the timeout instead of having the call canceled by the client.
The offset will only be applied if the provided grpc_timeout is greater than the offset. This
ensures that the offset will only ever decrease the timeout and never set it to 0 (meaning
infinity).</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-upgrade-configs">
<dt>upgrade_configs</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-routeaction-upgradeconfig"><span class="std std-ref">config.route.v3.RouteAction.UpgradeConfig</span></a>)</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-internal-redirect-policy">
<dt>internal_redirect_policy</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-internalredirectpolicy"><span class="std std-ref">config.route.v3.InternalRedirectPolicy</span></a>) If present, Envoy will try to follow an upstream redirect response instead of proxying the
response back to the downstream. An upstream redirect response is defined
by <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-internalredirectpolicy-redirect-response-codes"><span class="std std-ref">redirect_response_codes</span></a>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-internal-redirect-action">
<dt>internal_redirect_action</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-enum-config-route-v3-routeaction-internalredirectaction"><span class="std std-ref">config.route.v3.RouteAction.InternalRedirectAction</span></a>)</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routeaction-max-internal-redirects">
<dt>max_internal_redirects</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#uint32value">UInt32Value</a>) An internal redirect is handled, iff the number of previous internal redirects that a
downstream request has encountered is lower than this value, and
<a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-internal-redirect-action"><span class="std std-ref">internal_redirect_action</span></a>
is set to <a class="reference internal" href="#envoy-v3-api-enum-value-config-route-v3-routeaction-internalredirectaction-handle-internal-redirect"><span class="std std-ref">HANDLE_INTERNAL_REDIRECT</span></a>
In the case where a downstream request is bounced among multiple routes by internal redirect,
the first route that hits this threshold, or has
<a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-internal-redirect-action"><span class="std std-ref">internal_redirect_action</span></a>
set to
<a class="reference internal" href="#envoy-v3-api-enum-value-config-route-v3-routeaction-internalredirectaction-pass-through-internal-redirect"><span class="std std-ref">PASS_THROUGH_INTERNAL_REDIRECT</span></a>
will pass the redirect back to downstream.</p>
<p>If not specified, at most one redirect will be followed.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-hedge-policy">
<dt>hedge_policy</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-hedgepolicy"><span class="std std-ref">config.route.v3.HedgePolicy</span></a>) Indicates that the route has a hedge policy. Note that if this is set,
it’ll take precedence over the virtual host level hedge policy entirely
(e.g.: policies are not merged, most internal one becomes the enforced policy).</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-max-stream-duration">
<dt>max_stream_duration</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-routeaction-maxstreamduration"><span class="std std-ref">config.route.v3.RouteAction.MaxStreamDuration</span></a>) Specifies the maximum stream duration for this route.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-routeaction-requestmirrorpolicy">
<span id="envoy-v3-api-msg-config-route-v3-routeaction-requestmirrorpolicy"></span><h2>config.route.v3.RouteAction.RequestMirrorPolicy<a class="headerlink" href="#config-route-v3-routeaction-requestmirrorpolicy" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L583">[config.route.v3.RouteAction.RequestMirrorPolicy proto]</a></p>
<p>The router is capable of shadowing traffic from one cluster to another. The current
implementation is “fire and forget,” meaning Envoy will not wait for the shadow cluster to
respond before returning the response from the primary cluster. All normal statistics are
collected for the shadow cluster making this feature useful for testing.</p>
<p>During shadowing, the host/authority header is altered such that <em>-shadow</em> is appended. This is
useful for logging. For example, <em>cluster1</em> becomes <em>cluster1-shadow</em>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Shadowing will not be triggered if the primary cluster does not exist.</p>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;cluster&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;runtime_fraction&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;trace_sampled&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-requestmirrorpolicy-cluster">
<dt>cluster</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) Specifies the cluster that requests will be mirrored to. The cluster must
exist in the cluster manager configuration.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routeaction-requestmirrorpolicy-runtime-fraction">
<dt>runtime_fraction</dt><dd><p>(<a class="reference internal" href="../../core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-runtimefractionalpercent"><span class="std std-ref">config.core.v3.RuntimeFractionalPercent</span></a>) If not specified, all requests to the target cluster will be mirrored.</p>
<p>If specified, this field takes precedence over the <cite>runtime_key</cite> field and requests must also
fall under the percentage of matches indicated by this field.</p>
<p>For some fraction N/D, a random number in the range [0,D) is selected. If the
number is &lt;= the value of the numerator N, or if the key is not present, the default
value, the request will be mirrored.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-requestmirrorpolicy-trace-sampled">
<dt>trace_sampled</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#boolvalue">BoolValue</a>) Determines if the trace span should be sampled. Defaults to true.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-routeaction-hashpolicy">
<span id="envoy-v3-api-msg-config-route-v3-routeaction-hashpolicy"></span><h2>config.route.v3.RouteAction.HashPolicy<a class="headerlink" href="#config-route-v3-routeaction-hashpolicy" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L612">[config.route.v3.RouteAction.HashPolicy proto]</a></p>
<p>Specifies the route’s hashing policy if the upstream cluster uses a hashing <a class="reference internal" href="../../../../intro/arch_overview/upstream/load_balancing/load_balancers.html#arch-overview-load-balancing-types"><span class="std std-ref">load balancer</span></a>.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;header&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;cookie&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;connection_properties&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;query_parameter&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;filter_state&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;terminal&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-header">
<dt>header</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-routeaction-hashpolicy-header"><span class="std std-ref">config.route.v3.RouteAction.HashPolicy.Header</span></a>) Header hash policy.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-header"><span class="std std-ref">header</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-cookie"><span class="std std-ref">cookie</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-connection-properties"><span class="std std-ref">connection_properties</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-query-parameter"><span class="std std-ref">query_parameter</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-filter-state"><span class="std std-ref">filter_state</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-cookie">
<dt>cookie</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-routeaction-hashpolicy-cookie"><span class="std std-ref">config.route.v3.RouteAction.HashPolicy.Cookie</span></a>) Cookie hash policy.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-header"><span class="std std-ref">header</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-cookie"><span class="std std-ref">cookie</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-connection-properties"><span class="std std-ref">connection_properties</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-query-parameter"><span class="std std-ref">query_parameter</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-filter-state"><span class="std std-ref">filter_state</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-connection-properties">
<dt>connection_properties</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-routeaction-hashpolicy-connectionproperties"><span class="std std-ref">config.route.v3.RouteAction.HashPolicy.ConnectionProperties</span></a>) Connection properties hash policy.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-header"><span class="std std-ref">header</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-cookie"><span class="std std-ref">cookie</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-connection-properties"><span class="std std-ref">connection_properties</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-query-parameter"><span class="std std-ref">query_parameter</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-filter-state"><span class="std std-ref">filter_state</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-query-parameter">
<dt>query_parameter</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-routeaction-hashpolicy-queryparameter"><span class="std std-ref">config.route.v3.RouteAction.HashPolicy.QueryParameter</span></a>) Query parameter hash policy.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-header"><span class="std std-ref">header</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-cookie"><span class="std std-ref">cookie</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-connection-properties"><span class="std std-ref">connection_properties</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-query-parameter"><span class="std std-ref">query_parameter</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-filter-state"><span class="std std-ref">filter_state</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-filter-state">
<dt>filter_state</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-routeaction-hashpolicy-filterstate"><span class="std std-ref">config.route.v3.RouteAction.HashPolicy.FilterState</span></a>) Filter state hash policy.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-header"><span class="std std-ref">header</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-cookie"><span class="std std-ref">cookie</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-connection-properties"><span class="std std-ref">connection_properties</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-query-parameter"><span class="std std-ref">query_parameter</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-filter-state"><span class="std std-ref">filter_state</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-terminal">
<dt>terminal</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) The flag that short-circuits the hash computing. This field provides a
‘fallback’ style of configuration: “if a terminal policy doesn’t work,
fallback to rest of the policy list”, it saves time when the terminal
policy works.</p>
<p>If true, and there is already a hash computed, ignore rest of the
list of hash polices.
For example, if the following hash methods are configured:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 53%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>specifier</p></th>
<th class="head"><p>terminal</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Header A</p></td>
<td><p>true</p></td>
</tr>
<tr class="row-odd"><td><p>Header B</p></td>
<td><p>false</p></td>
</tr>
<tr class="row-even"><td><p>Header C</p></td>
<td><p>false</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The generateHash process ends if policy “header A” generates a hash, as
it’s a terminal policy.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-routeaction-hashpolicy-header">
<span id="envoy-v3-api-msg-config-route-v3-routeaction-hashpolicy-header"></span><h2>config.route.v3.RouteAction.HashPolicy.Header<a class="headerlink" href="#config-route-v3-routeaction-hashpolicy-header" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L616">[config.route.v3.RouteAction.HashPolicy.Header proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;header_name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;regex_rewrite&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-header-header-name">
<dt>header_name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The name of the request header that will be used to obtain the hash
key. If the request header is not present, no hash will be produced.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-header-regex-rewrite">
<dt>regex_rewrite</dt><dd><p>(<a class="reference internal" href="../../../type/matcher/v3/regex.proto.html#envoy-v3-api-msg-type-matcher-v3-regexmatchandsubstitute"><span class="std std-ref">type.matcher.v3.RegexMatchAndSubstitute</span></a>) If specified, the request header value will be rewritten and used
to produce the hash key.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-routeaction-hashpolicy-cookie">
<span id="envoy-v3-api-msg-config-route-v3-routeaction-hashpolicy-cookie"></span><h2>config.route.v3.RouteAction.HashPolicy.Cookie<a class="headerlink" href="#config-route-v3-routeaction-hashpolicy-cookie" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L644">[config.route.v3.RouteAction.HashPolicy.Cookie proto]</a></p>
<p>Envoy supports two types of cookie affinity:</p>
<ol class="arabic simple">
<li><p>Passive. Envoy takes a cookie that’s present in the cookies header and
hashes on its value.</p></li>
<li><p>Generated. Envoy generates and sets a cookie with an expiration (TTL)
on the first request from the client in its response to the client,
based on the endpoint the request gets sent to. The client then
presents this on the next and all subsequent requests. The hash of
this is sufficient to ensure these requests get sent to the same
endpoint. The cookie is generated by hashing the source and
destination ports and addresses so that multiple independent HTTP2
streams on the same connection will independently receive the same
cookie, even if they arrive at the Envoy simultaneously.</p></li>
</ol>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;ttl&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-cookie-name">
<dt>name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The name of the cookie that will be used to obtain the hash key. If the
cookie is not present and ttl below is not set, no hash will be
produced.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-cookie-ttl">
<dt>ttl</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) If specified, a cookie with the TTL will be generated if the cookie is
not present. If the TTL is present and zero, the generated cookie will
be a session cookie.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-cookie-path">
<dt>path</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) The name of the path for the cookie. If no path is specified here, no path
will be set for the cookie.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-routeaction-hashpolicy-connectionproperties">
<span id="envoy-v3-api-msg-config-route-v3-routeaction-hashpolicy-connectionproperties"></span><h2>config.route.v3.RouteAction.HashPolicy.ConnectionProperties<a class="headerlink" href="#config-route-v3-routeaction-hashpolicy-connectionproperties" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L663">[config.route.v3.RouteAction.HashPolicy.ConnectionProperties proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;source_ip&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-connectionproperties-source-ip">
<dt>source_ip</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) Hash on source IP address.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-routeaction-hashpolicy-queryparameter">
<span id="envoy-v3-api-msg-config-route-v3-routeaction-hashpolicy-queryparameter"></span><h2>config.route.v3.RouteAction.HashPolicy.QueryParameter<a class="headerlink" href="#config-route-v3-routeaction-hashpolicy-queryparameter" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L671">[config.route.v3.RouteAction.HashPolicy.QueryParameter proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-queryparameter-name">
<dt>name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The name of the URL query parameter that will be used to obtain the hash
key. If the parameter is not present, no hash will be produced. Query
parameter names are case-sensitive.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-routeaction-hashpolicy-filterstate">
<span id="envoy-v3-api-msg-config-route-v3-routeaction-hashpolicy-filterstate"></span><h2>config.route.v3.RouteAction.HashPolicy.FilterState<a class="headerlink" href="#config-route-v3-routeaction-hashpolicy-filterstate" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L681">[config.route.v3.RouteAction.HashPolicy.FilterState proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-hashpolicy-filterstate-key">
<dt>key</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The name of the Object in the per-request filterState, which is an
Envoy::Http::Hashable object. If there is no data associated with the key,
or the stored object is not Envoy::Http::Hashable, no hash will be produced.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-routeaction-upgradeconfig">
<span id="envoy-v3-api-msg-config-route-v3-routeaction-upgradeconfig"></span><h2>config.route.v3.RouteAction.UpgradeConfig<a class="headerlink" href="#config-route-v3-routeaction-upgradeconfig" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L738">[config.route.v3.RouteAction.UpgradeConfig proto]</a></p>
<p>Allows enabling and disabling upgrades on a per-route basis.
This overrides any enabled/disabled upgrade filter chain specified in the
HttpConnectionManager
<a class="reference internal" href="../../../extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto.html#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-upgrade-configs"><span class="std std-ref">upgrade_configs</span></a>
but does not affect any custom filter chain specified there.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;upgrade_type&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;enabled&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;connect_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-upgradeconfig-upgrade-type">
<dt>upgrade_type</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The case-insensitive name of this upgrade, e.g. “websocket”.
For each upgrade type present in upgrade_configs, requests with
Upgrade: [upgrade_type] will be proxied upstream.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-upgradeconfig-enabled">
<dt>enabled</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#boolvalue">BoolValue</a>) Determines if upgrades are available on this route. Defaults to true.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-upgradeconfig-connect-config">
<dt>connect_config</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-routeaction-upgradeconfig-connectconfig"><span class="std std-ref">config.route.v3.RouteAction.UpgradeConfig.ConnectConfig</span></a>) Configuration for sending data upstream as a raw data payload. This is used for
CONNECT requests, when forwarding CONNECT payload as raw TCP.
Note that CONNECT support is currently considered alpha in Envoy.
[#comment:TODO(htuch): Replace the above comment with an alpha tag.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-routeaction-upgradeconfig-connectconfig">
<span id="envoy-v3-api-msg-config-route-v3-routeaction-upgradeconfig-connectconfig"></span><h2>config.route.v3.RouteAction.UpgradeConfig.ConnectConfig<a class="headerlink" href="#config-route-v3-routeaction-upgradeconfig-connectconfig" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L744">[config.route.v3.RouteAction.UpgradeConfig.ConnectConfig proto]</a></p>
<p>Configuration for sending data upstream as a raw data payload. This is used for
CONNECT requests, when forwarding CONNECT payload as raw TCP.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;proxy_protocol_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-upgradeconfig-connectconfig-proxy-protocol-config">
<dt>proxy_protocol_config</dt><dd><p>(<a class="reference internal" href="../../core/v3/proxy_protocol.proto.html#envoy-v3-api-msg-config-core-v3-proxyprotocolconfig"><span class="std std-ref">config.core.v3.ProxyProtocolConfig</span></a>) If present, the proxy protocol header will be prepended to the CONNECT payload sent upstream.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-routeaction-maxstreamduration">
<span id="envoy-v3-api-msg-config-route-v3-routeaction-maxstreamduration"></span><h2>config.route.v3.RouteAction.MaxStreamDuration<a class="headerlink" href="#config-route-v3-routeaction-maxstreamduration" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L765">[config.route.v3.RouteAction.MaxStreamDuration proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;max_stream_duration&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;grpc_timeout_header_max&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;grpc_timeout_header_offset&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-maxstreamduration-max-stream-duration">
<dt>max_stream_duration</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) Specifies the maximum duration allowed for streams on the route. If not specified, the value
from the <a class="reference internal" href="../../core/v3/protocol.proto.html#envoy-v3-api-field-config-core-v3-httpprotocoloptions-max-stream-duration"><span class="std std-ref">max_stream_duration</span></a> field in
<a class="reference internal" href="../../../extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto.html#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-common-http-protocol-options"><span class="std std-ref">HttpConnectionManager.common_http_protocol_options</span></a>
is used. If this field is set explicitly to zero, any
HttpConnectionManager max_stream_duration timeout will be disabled for
this route.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-maxstreamduration-grpc-timeout-header-max">
<dt>grpc_timeout_header_max</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) If present, and the request contains a <a class="reference external" href="https://github.com/grpc/grpc/blob/master/doc/PROTOCOL-HTTP2.md">grpc-timeout header</a>, use that value as the
<em>max_stream_duration</em>, but limit the applied timeout to the maximum value specified here.
If set to 0, the <cite>grpc-timeout</cite> header is used without modification.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-routeaction-maxstreamduration-grpc-timeout-header-offset">
<dt>grpc_timeout_header_offset</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) If present, Envoy will adjust the timeout provided by the <cite>grpc-timeout</cite> header by
subtracting the provided duration from the header. This is useful for allowing Envoy to set
its global timeout to be less than that of the deadline imposed by the calling client, which
makes it more likely that Envoy will handle the timeout instead of having the call canceled
by the client. If, after applying the offset, the resulting timeout is zero or negative,
the stream will timeout immediately.</p>
</dd>
</dl>
</div>
<div class="section" id="enum-config-route-v3-routeaction-clusternotfoundresponsecode">
<span id="envoy-v3-api-enum-config-route-v3-routeaction-clusternotfoundresponsecode"></span><h2>Enum config.route.v3.RouteAction.ClusterNotFoundResponseCode<a class="headerlink" href="#enum-config-route-v3-routeaction-clusternotfoundresponsecode" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L555">[config.route.v3.RouteAction.ClusterNotFoundResponseCode proto]</a></p>
<dl class="simple" id="envoy-v3-api-enum-value-config-route-v3-routeaction-clusternotfoundresponsecode-service-unavailable">
<dt>SERVICE_UNAVAILABLE</dt><dd><p><em>(DEFAULT)</em> ⁣HTTP status code - 503 Service Unavailable.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-route-v3-routeaction-clusternotfoundresponsecode-not-found">
<dt>NOT_FOUND</dt><dd><p>⁣HTTP status code - 404 Not Found.</p>
</dd>
</dl>
</div>
<div class="section" id="enum-config-route-v3-routeaction-internalredirectaction">
<span id="envoy-v3-api-enum-config-route-v3-routeaction-internalredirectaction"></span><h2>Enum config.route.v3.RouteAction.InternalRedirectAction<a class="headerlink" href="#enum-config-route-v3-routeaction-internalredirectaction" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L565">[config.route.v3.RouteAction.InternalRedirectAction proto]</a></p>
<p>Configures <a class="reference internal" href="../../../../intro/arch_overview/http/http_connection_management.html#arch-overview-internal-redirects"><span class="std std-ref">internal redirect</span></a> behavior.</p>
<dl class="simple" id="envoy-v3-api-enum-value-config-route-v3-routeaction-internalredirectaction-pass-through-internal-redirect">
<dt>PASS_THROUGH_INTERNAL_REDIRECT</dt><dd><p><em>(DEFAULT)</em> ⁣</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-route-v3-routeaction-internalredirectaction-handle-internal-redirect">
<dt>HANDLE_INTERNAL_REDIRECT</dt><dd><p>⁣</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-retrypolicy">
<span id="envoy-v3-api-msg-config-route-v3-retrypolicy"></span><h2>config.route.v3.RetryPolicy<a class="headerlink" href="#config-route-v3-retrypolicy" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1101">[config.route.v3.RetryPolicy proto]</a></p>
<p>HTTP retry <a class="reference internal" href="../../../../intro/arch_overview/http/http_routing.html#arch-overview-http-routing-retry"><span class="std std-ref">architecture overview</span></a>.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;retry_on&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;num_retries&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;per_try_timeout&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;retry_priority&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;retry_host_predicate&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;host_selection_retry_max_attempts&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;retriable_status_codes&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;retry_back_off&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;rate_limited_retry_back_off&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;retriable_headers&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;retriable_request_headers&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-retrypolicy-retry-on">
<dt>retry_on</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Specifies the conditions under which retry takes place. These are the same
conditions documented for <a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router-x-envoy-retry-on"><span class="std std-ref">x-envoy-retry-on</span></a> and
<a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router-x-envoy-retry-grpc-on"><span class="std std-ref">x-envoy-retry-grpc-on</span></a>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-retrypolicy-num-retries">
<dt>num_retries</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#uint32value">UInt32Value</a>) Specifies the allowed number of retries. This parameter is optional and
defaults to 1. These are the same conditions documented for
<a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router-x-envoy-max-retries"><span class="std std-ref">x-envoy-max-retries</span></a>.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-retrypolicy-per-try-timeout">
<dt>per_try_timeout</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) Specifies a non-zero upstream timeout per retry attempt. This parameter is optional. The
same conditions documented for
<a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router-x-envoy-upstream-rq-per-try-timeout-ms"><span class="std std-ref">x-envoy-upstream-rq-per-try-timeout-ms</span></a> apply.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If left unspecified, Envoy will use the global
<a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-timeout"><span class="std std-ref">route timeout</span></a> for the request.
Consequently, when using a <a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router-x-envoy-retry-on"><span class="std std-ref">5xx</span></a> based
retry policy, a request that times out will not be retried as the total timeout budget
would have been exhausted.</p>
</div>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-retrypolicy-retry-priority">
<dt>retry_priority</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-retrypolicy-retrypriority"><span class="std std-ref">config.route.v3.RetryPolicy.RetryPriority</span></a>) Specifies an implementation of a RetryPriority which is used to determine the
distribution of load across priorities used for retries. Refer to
<a class="reference internal" href="../../../../intro/arch_overview/http/http_connection_management.html#arch-overview-http-retry-plugins"><span class="std std-ref">retry plugin configuration</span></a> for more details.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-retrypolicy-retry-host-predicate">
<dt>retry_host_predicate</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-retrypolicy-retryhostpredicate"><span class="std std-ref">config.route.v3.RetryPolicy.RetryHostPredicate</span></a>) Specifies a collection of RetryHostPredicates that will be consulted when selecting a host
for retries. If any of the predicates reject the host, host selection will be reattempted.
Refer to <a class="reference internal" href="../../../../intro/arch_overview/http/http_connection_management.html#arch-overview-http-retry-plugins"><span class="std std-ref">retry plugin configuration</span></a> for more
details.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-retrypolicy-host-selection-retry-max-attempts">
<dt>host_selection_retry_max_attempts</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">int64</a>) The maximum number of times host selection will be reattempted before giving up, at which
point the host that was last selected will be routed to. If unspecified, this will default to
retrying once.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-retrypolicy-retriable-status-codes">
<dt>retriable_status_codes</dt><dd><p>(<strong>repeated</strong> <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">uint32</a>) HTTP status codes that should trigger a retry in addition to those specified by retry_on.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-retrypolicy-retry-back-off">
<dt>retry_back_off</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-retrypolicy-retrybackoff"><span class="std std-ref">config.route.v3.RetryPolicy.RetryBackOff</span></a>) Specifies parameters that control exponential retry back off. This parameter is optional, in which case the
default base interval is 25 milliseconds or, if set, the current value of the
<cite>upstream.base_retry_backoff_ms</cite> runtime parameter. The default maximum interval is 10 times
the base interval. The documentation for <a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router-x-envoy-max-retries"><span class="std std-ref">x-envoy-max-retries</span></a>
describes Envoy’s back-off algorithm.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-retrypolicy-rate-limited-retry-back-off">
<dt>rate_limited_retry_back_off</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-retrypolicy-ratelimitedretrybackoff"><span class="std std-ref">config.route.v3.RetryPolicy.RateLimitedRetryBackOff</span></a>) Specifies parameters that control a retry back-off strategy that is used
when the request is rate limited by the upstream server. The server may
return a response header like <code class="docutils literal notranslate"><span class="pre">Retry-After</span></code> or <code class="docutils literal notranslate"><span class="pre">X-RateLimit-Reset</span></code> to
provide feedback to the client on how long to wait before retrying. If
configured, this back-off strategy will be used instead of the
default exponential back off strategy (configured using <cite>retry_back_off</cite>)
whenever a response includes the matching headers.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-retrypolicy-retriable-headers">
<dt>retriable_headers</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-headermatcher"><span class="std std-ref">config.route.v3.HeaderMatcher</span></a>) HTTP response headers that trigger a retry if present in the response. A retry will be
triggered if any of the header matches match the upstream response headers.
The field is only consulted if ‘retriable-headers’ retry policy is active.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-retrypolicy-retriable-request-headers">
<dt>retriable_request_headers</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-headermatcher"><span class="std std-ref">config.route.v3.HeaderMatcher</span></a>) HTTP headers which must be present in the request for retries to be attempted.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-retrypolicy-retrypriority">
<span id="envoy-v3-api-msg-config-route-v3-retrypolicy-retrypriority"></span><h2>config.route.v3.RetryPolicy.RetryPriority<a class="headerlink" href="#config-route-v3-retrypolicy-retrypriority" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1109">[config.route.v3.RetryPolicy.RetryPriority proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;typed_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-retrypolicy-retrypriority-name">
<dt>name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>)</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-retrypolicy-retrypriority-typed-config">
<dt>typed_config</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#any">Any</a>)</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-retrypolicy-retryhostpredicate">
<span id="envoy-v3-api-msg-config-route-v3-retrypolicy-retryhostpredicate"></span><h2>config.route.v3.RetryPolicy.RetryHostPredicate<a class="headerlink" href="#config-route-v3-retrypolicy-retryhostpredicate" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1124">[config.route.v3.RetryPolicy.RetryHostPredicate proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;typed_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-retrypolicy-retryhostpredicate-name">
<dt>name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>)</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-retrypolicy-retryhostpredicate-typed-config">
<dt>typed_config</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#any">Any</a>)</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-retrypolicy-retrybackoff">
<span id="envoy-v3-api-msg-config-route-v3-retrypolicy-retrybackoff"></span><h2>config.route.v3.RetryPolicy.RetryBackOff<a class="headerlink" href="#config-route-v3-retrypolicy-retrybackoff" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1139">[config.route.v3.RetryPolicy.RetryBackOff proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;base_interval&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;max_interval&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-retrypolicy-retrybackoff-base-interval">
<dt>base_interval</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>, <em>REQUIRED</em>) Specifies the base interval between retries. This parameter is required and must be greater
than zero. Values less than 1 ms are rounded up to 1 ms.
See <a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router-x-envoy-max-retries"><span class="std std-ref">x-envoy-max-retries</span></a> for a discussion of Envoy’s
back-off algorithm.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-retrypolicy-retrybackoff-max-interval">
<dt>max_interval</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) Specifies the maximum interval between retries. This parameter is optional, but must be
greater than or equal to the <cite>base_interval</cite> if set. The default is 10 times the
<cite>base_interval</cite>. See <a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router-x-envoy-max-retries"><span class="std std-ref">x-envoy-max-retries</span></a> for a discussion
of Envoy’s back-off algorithm.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-retrypolicy-resetheader">
<span id="envoy-v3-api-msg-config-route-v3-retrypolicy-resetheader"></span><h2>config.route.v3.RetryPolicy.ResetHeader<a class="headerlink" href="#config-route-v3-retrypolicy-resetheader" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1159">[config.route.v3.RetryPolicy.ResetHeader proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-v3-api-field-config-route-v3-retrypolicy-resetheader-name">
<dt>name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The name of the reset header.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the header appears multiple times only the first value is used.</p>
</div>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-retrypolicy-resetheader-format">
<dt>format</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-enum-config-route-v3-retrypolicy-resetheaderformat"><span class="std std-ref">config.route.v3.RetryPolicy.ResetHeaderFormat</span></a>) The format of the reset header.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-retrypolicy-ratelimitedretrybackoff">
<span id="envoy-v3-api-msg-config-route-v3-retrypolicy-ratelimitedretrybackoff"></span><h2>config.route.v3.RetryPolicy.RateLimitedRetryBackOff<a class="headerlink" href="#config-route-v3-retrypolicy-ratelimitedretrybackoff" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1215">[config.route.v3.RetryPolicy.RateLimitedRetryBackOff proto]</a></p>
<p>A retry back-off strategy that applies when the upstream server rate limits
the request.</p>
<p>Given this configuration:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">rate_limited_retry_back_off</span><span class="p">:</span>
  <span class="nt">reset_headers</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Retry-After</span>
    <span class="nt">format</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">SECONDS</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">X-RateLimit-Reset</span>
    <span class="nt">format</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">UNIX_TIMESTAMP</span>
  <span class="nt">max_interval</span><span class="p">:</span> <span class="s">&quot;300s&quot;</span>
</pre></div>
</div>
<p>The following algorithm will apply:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>If the response contains the header <code class="docutils literal notranslate"><span class="pre">Retry-After</span></code> its value must be on
the form <code class="docutils literal notranslate"><span class="pre">120</span></code> (an integer that represents the number of seconds to
wait before retrying). If so, this value is used as the back-off interval.</p></li>
<li><p>Otherwise, if the response contains the header <code class="docutils literal notranslate"><span class="pre">X-RateLimit-Reset</span></code> its
value must be on the form <code class="docutils literal notranslate"><span class="pre">1595320702</span></code> (an integer that represents the
point in time at which to retry, as a Unix timestamp in seconds). If so,
the current time is subtracted from this value and the result is used as
the back-off interval.</p></li>
<li><p>Otherwise, Envoy will use the default
<a class="reference internal" href="#envoy-v3-api-field-config-route-v3-retrypolicy-retry-back-off"><span class="std std-ref">exponential back-off</span></a>
strategy.</p></li>
</ol>
</div></blockquote>
<p>No matter which format is used, if the resulting back-off interval exceeds
<code class="docutils literal notranslate"><span class="pre">max_interval</span></code> it is discarded and the next header in <code class="docutils literal notranslate"><span class="pre">reset_headers</span></code>
is tried. If a request timeout is configured for the route it will further
limit how long the request will be allowed to run.</p>
<p>To prevent many clients retrying at the same point in time jitter is added
to the back-off interval, so the resulting interval is decided by taking:
<code class="docutils literal notranslate"><span class="pre">random(interval,</span> <span class="pre">interval</span> <span class="pre">*</span> <span class="pre">1.5)</span></code>.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Configuring <code class="docutils literal notranslate"><span class="pre">rate_limited_retry_back_off</span></code> will not by itself cause a request
to be retried. You will still need to configure the right retry policy to match
the responses from the upstream server.</p>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;reset_headers&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;max_interval&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-retrypolicy-ratelimitedretrybackoff-reset-headers">
<dt>reset_headers</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-retrypolicy-resetheader"><span class="std std-ref">config.route.v3.RetryPolicy.ResetHeader</span></a>, <em>REQUIRED</em>) Specifies the reset headers (like <code class="docutils literal notranslate"><span class="pre">Retry-After</span></code> or <code class="docutils literal notranslate"><span class="pre">X-RateLimit-Reset</span></code>)
to match against the response. Headers are tried in order, and matched case
insensitive. The first header to be parsed successfully is used. If no headers
match the default exponential back-off is used instead.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-retrypolicy-ratelimitedretrybackoff-max-interval">
<dt>max_interval</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) Specifies the maximum back off interval that Envoy will allow. If a reset
header contains an interval longer than this then it will be discarded and
the next header will be tried. Defaults to 300 seconds.</p>
</dd>
</dl>
</div>
<div class="section" id="enum-config-route-v3-retrypolicy-resetheaderformat">
<span id="envoy-v3-api-enum-config-route-v3-retrypolicy-resetheaderformat"></span><h2>Enum config.route.v3.RetryPolicy.ResetHeaderFormat<a class="headerlink" href="#enum-config-route-v3-retrypolicy-resetheaderformat" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1104">[config.route.v3.RetryPolicy.ResetHeaderFormat proto]</a></p>
<dl class="simple" id="envoy-v3-api-enum-value-config-route-v3-retrypolicy-resetheaderformat-seconds">
<dt>SECONDS</dt><dd><p><em>(DEFAULT)</em> ⁣</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-route-v3-retrypolicy-resetheaderformat-unix-timestamp">
<dt>UNIX_TIMESTAMP</dt><dd><p>⁣</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-hedgepolicy">
<span id="envoy-v3-api-msg-config-route-v3-hedgepolicy"></span><h2>config.route.v3.HedgePolicy<a class="headerlink" href="#config-route-v3-hedgepolicy" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1297">[config.route.v3.HedgePolicy proto]</a></p>
<p>HTTP request hedging <a class="reference internal" href="../../../../intro/arch_overview/http/http_routing.html#arch-overview-http-routing-hedging"><span class="std std-ref">architecture overview</span></a>.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;hedge_on_per_try_timeout&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-v3-api-field-config-route-v3-hedgepolicy-hedge-on-per-try-timeout">
<dt>hedge_on_per_try_timeout</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) Indicates that a hedged request should be sent when the per-try timeout is hit.
This means that a retry will be issued without resetting the original request, leaving multiple upstream requests in flight.
The first request to complete successfully will be the one returned to the caller.</p>
<ul class="simple">
<li><p>At any time, a successful response (i.e. not triggering any of the retry-on conditions) would be returned to the client.</p></li>
<li><p>Before per-try timeout, an error response (per retry-on conditions) would be retried immediately or returned ot the client
if there are no more retries left.</p></li>
<li><p>After per-try timeout, an error response would be discarded, as a retry in the form of a hedged request is already in progress.</p></li>
</ul>
<p>Note: For this to have effect, you must have a <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-retrypolicy"><span class="std std-ref">RetryPolicy</span></a> that retries at least
one error code and specifies a maximum number of retries.</p>
<p>Defaults to false.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-redirectaction">
<span id="envoy-v3-api-msg-config-route-v3-redirectaction"></span><h2>config.route.v3.RedirectAction<a class="headerlink" href="#config-route-v3-redirectaction" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1329">[config.route.v3.RedirectAction proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;https_redirect&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;scheme_redirect&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;host_redirect&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;port_redirect&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;path_redirect&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;prefix_rewrite&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;regex_rewrite&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;response_code&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;strip_query&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-v3-api-field-config-route-v3-redirectaction-https-redirect">
<dt>https_redirect</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) The scheme portion of the URL will be swapped with “https”.</p>
<dl class="simple">
<dt>When the scheme redirection take place, the following rules apply:</dt><dd><ol class="arabic simple">
<li><p>If the source URI scheme is <cite>http</cite> and the port is explicitly
set to <cite>:80</cite>, the port will be removed after the redirection</p></li>
<li><p>If the source URI scheme is <cite>https</cite> and the port is explicitly
set to <cite>:443</cite>, the port will be removed after the redirection</p></li>
</ol>
</dd>
</dl>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-redirectaction-https-redirect"><span class="std std-ref">https_redirect</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-redirectaction-scheme-redirect"><span class="std std-ref">scheme_redirect</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-redirectaction-scheme-redirect">
<dt>scheme_redirect</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) The scheme portion of the URL will be swapped with this value.</p>
<dl class="simple">
<dt>When the scheme redirection take place, the following rules apply:</dt><dd><ol class="arabic simple">
<li><p>If the source URI scheme is <cite>http</cite> and the port is explicitly
set to <cite>:80</cite>, the port will be removed after the redirection</p></li>
<li><p>If the source URI scheme is <cite>https</cite> and the port is explicitly
set to <cite>:443</cite>, the port will be removed after the redirection</p></li>
</ol>
</dd>
</dl>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-redirectaction-https-redirect"><span class="std std-ref">https_redirect</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-redirectaction-scheme-redirect"><span class="std std-ref">scheme_redirect</span></a> may be set.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-redirectaction-host-redirect">
<dt>host_redirect</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) The host portion of the URL will be swapped with this value.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-redirectaction-port-redirect">
<dt>port_redirect</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">uint32</a>) The port value of the URL will be swapped with this value.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-redirectaction-path-redirect">
<dt>path_redirect</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) The path portion of the URL will be swapped with this value.
Please note that query string in path_redirect will override the
request’s query string and will not be stripped.</p>
<p>For example, let’s say we have the following routes:</p>
<ul class="simple">
<li><p>match: { path: “/old-path-1” }
redirect: { path_redirect: “/new-path-1” }</p></li>
<li><p>match: { path: “/old-path-2” }
redirect: { path_redirect: “/new-path-2”, strip-query: “true” }</p></li>
<li><p>match: { path: “/old-path-3” }
redirect: { path_redirect: “/new-path-3?foo=1”, strip_query: “true” }</p></li>
</ul>
<ol class="arabic simple">
<li><p>if request uri is “/old-path-1?bar=1”, users will be redirected to “/new-path-1?bar=1”</p></li>
<li><p>if request uri is “/old-path-2?bar=1”, users will be redirected to “/new-path-2”</p></li>
<li><p>if request uri is “/old-path-3?bar=1”, users will be redirected to “/new-path-3?foo=1”</p></li>
</ol>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-redirectaction-path-redirect"><span class="std std-ref">path_redirect</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-redirectaction-prefix-rewrite"><span class="std std-ref">prefix_rewrite</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-redirectaction-regex-rewrite"><span class="std std-ref">regex_rewrite</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-redirectaction-prefix-rewrite">
<dt>prefix_rewrite</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) Indicates that during redirection, the matched prefix (or path)
should be swapped with this value. This option allows redirect URLs be dynamically created
based on the request.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Pay attention to the use of trailing slashes as mentioned in
<a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-prefix-rewrite"><span class="std std-ref">RouteAction’s prefix_rewrite</span></a>.</p>
</div>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-redirectaction-path-redirect"><span class="std std-ref">path_redirect</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-redirectaction-prefix-rewrite"><span class="std std-ref">prefix_rewrite</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-redirectaction-regex-rewrite"><span class="std std-ref">regex_rewrite</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-redirectaction-regex-rewrite">
<dt>regex_rewrite</dt><dd><p>(<a class="reference internal" href="../../../type/matcher/v3/regex.proto.html#envoy-v3-api-msg-type-matcher-v3-regexmatchandsubstitute"><span class="std std-ref">type.matcher.v3.RegexMatchAndSubstitute</span></a>) Indicates that during redirect, portions of the path that match the
pattern should be rewritten, even allowing the substitution of capture
groups from the pattern into the new path as specified by the rewrite
substitution string. This is useful to allow application paths to be
rewritten in a way that is aware of segments with variable content like
identifiers.</p>
<p>Examples using Google’s <a class="reference external" href="https://github.com/google/re2">RE2</a> engine:</p>
<ul class="simple">
<li><p>The path pattern <code class="docutils literal notranslate"><span class="pre">^/service/([^/]+)(/.*)$</span></code> paired with a substitution
string of <code class="docutils literal notranslate"><span class="pre">\2/instance/\1</span></code> would transform <code class="docutils literal notranslate"><span class="pre">/service/foo/v1/api</span></code>
into <code class="docutils literal notranslate"><span class="pre">/v1/api/instance/foo</span></code>.</p></li>
<li><p>The pattern <code class="docutils literal notranslate"><span class="pre">one</span></code> paired with a substitution string of <code class="docutils literal notranslate"><span class="pre">two</span></code> would
transform <code class="docutils literal notranslate"><span class="pre">/xxx/one/yyy/one/zzz</span></code> into <code class="docutils literal notranslate"><span class="pre">/xxx/two/yyy/two/zzz</span></code>.</p></li>
<li><p>The pattern <code class="docutils literal notranslate"><span class="pre">^(.*?)one(.*)$</span></code> paired with a substitution string of
<code class="docutils literal notranslate"><span class="pre">\1two\2</span></code> would replace only the first occurrence of <code class="docutils literal notranslate"><span class="pre">one</span></code>,
transforming path <code class="docutils literal notranslate"><span class="pre">/xxx/one/yyy/one/zzz</span></code> into <code class="docutils literal notranslate"><span class="pre">/xxx/two/yyy/one/zzz</span></code>.</p></li>
<li><p>The pattern <code class="docutils literal notranslate"><span class="pre">(?i)/xxx/</span></code> paired with a substitution string of <code class="docutils literal notranslate"><span class="pre">/yyy/</span></code>
would do a case-insensitive match and transform path <code class="docutils literal notranslate"><span class="pre">/aaa/XxX/bbb</span></code> to
<code class="docutils literal notranslate"><span class="pre">/aaa/yyy/bbb</span></code>.</p></li>
</ul>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-redirectaction-path-redirect"><span class="std std-ref">path_redirect</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-redirectaction-prefix-rewrite"><span class="std std-ref">prefix_rewrite</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-redirectaction-regex-rewrite"><span class="std std-ref">regex_rewrite</span></a> may be set.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-redirectaction-response-code">
<dt>response_code</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-enum-config-route-v3-redirectaction-redirectresponsecode"><span class="std std-ref">config.route.v3.RedirectAction.RedirectResponseCode</span></a>) The HTTP status code to use in the redirect response. The default response
code is MOVED_PERMANENTLY (301).</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-redirectaction-strip-query">
<dt>strip_query</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) Indicates that during redirection, the query portion of the URL will
be removed. Default value is false.</p>
</dd>
</dl>
</div>
<div class="section" id="enum-config-route-v3-redirectaction-redirectresponsecode">
<span id="envoy-v3-api-enum-config-route-v3-redirectaction-redirectresponsecode"></span><h2>Enum config.route.v3.RedirectAction.RedirectResponseCode<a class="headerlink" href="#enum-config-route-v3-redirectaction-redirectresponsecode" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1332">[config.route.v3.RedirectAction.RedirectResponseCode proto]</a></p>
<dl class="simple" id="envoy-v3-api-enum-value-config-route-v3-redirectaction-redirectresponsecode-moved-permanently">
<dt>MOVED_PERMANENTLY</dt><dd><p><em>(DEFAULT)</em> ⁣Moved Permanently HTTP Status Code - 301.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-route-v3-redirectaction-redirectresponsecode-found">
<dt>FOUND</dt><dd><p>⁣Found HTTP Status Code - 302.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-route-v3-redirectaction-redirectresponsecode-see-other">
<dt>SEE_OTHER</dt><dd><p>⁣See Other HTTP Status Code - 303.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-route-v3-redirectaction-redirectresponsecode-temporary-redirect">
<dt>TEMPORARY_REDIRECT</dt><dd><p>⁣Temporary Redirect HTTP Status Code - 307.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-route-v3-redirectaction-redirectresponsecode-permanent-redirect">
<dt>PERMANENT_REDIRECT</dt><dd><p>⁣Permanent Redirect HTTP Status Code - 308.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-directresponseaction">
<span id="envoy-v3-api-msg-config-route-v3-directresponseaction"></span><h2>config.route.v3.DirectResponseAction<a class="headerlink" href="#config-route-v3-directresponseaction" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1435">[config.route.v3.DirectResponseAction proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-directresponseaction-status">
<dt>status</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">uint32</a>) Specifies the HTTP response status to be returned.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-directresponseaction-body">
<dt>body</dt><dd><p>(<a class="reference internal" href="../../core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-datasource"><span class="std std-ref">config.core.v3.DataSource</span></a>) Specifies the content of the response body. If this setting is omitted,
no body is included in the generated response.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Headers can be specified using <em>response_headers_to_add</em> in the enclosing
<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-route"><span class="std std-ref">config.route.v3.Route</span></a>, <a class="reference internal" href="route.proto.html#envoy-v3-api-msg-config-route-v3-routeconfiguration"><span class="std std-ref">config.route.v3.RouteConfiguration</span></a> or
<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-virtualhost"><span class="std std-ref">config.route.v3.VirtualHost</span></a>.</p>
</div>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-decorator">
<span id="envoy-v3-api-msg-config-route-v3-decorator"></span><h2>config.route.v3.Decorator<a class="headerlink" href="#config-route-v3-decorator" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1453">[config.route.v3.Decorator proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;propagate&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-v3-api-field-config-route-v3-decorator-operation">
<dt>operation</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The operation name associated with the request matched to this route. If tracing is
enabled, this information will be used as the span name reported for this request.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For ingress (inbound) requests, or egress (outbound) responses, this value may be overridden
by the <a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router-x-envoy-decorator-operation"><span class="std std-ref">x-envoy-decorator-operation</span></a> header.</p>
</div>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-decorator-propagate">
<dt>propagate</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#boolvalue">BoolValue</a>) Whether the decorated details should be propagated to the other party. The default is true.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-tracing">
<span id="envoy-v3-api-msg-config-route-v3-tracing"></span><h2>config.route.v3.Tracing<a class="headerlink" href="#config-route-v3-tracing" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1470">[config.route.v3.Tracing proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;client_sampling&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;random_sampling&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;overall_sampling&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;custom_tags&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-tracing-client-sampling">
<dt>client_sampling</dt><dd><p>(<a class="reference internal" href="../../../type/v3/percent.proto.html#envoy-v3-api-msg-type-v3-fractionalpercent"><span class="std std-ref">type.v3.FractionalPercent</span></a>) Target percentage of requests managed by this HTTP connection manager that will be force
traced if the <a class="reference internal" href="../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-x-client-trace-id"><span class="std std-ref">x-client-trace-id</span></a>
header is set. This field is a direct analog for the runtime variable
‘tracing.client_sampling’ in the <a class="reference internal" href="../../../../configuration/http/http_conn_man/runtime.html#config-http-conn-man-runtime"><span class="std std-ref">HTTP Connection Manager</span></a>.
Default: 100%</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-tracing-random-sampling">
<dt>random_sampling</dt><dd><p>(<a class="reference internal" href="../../../type/v3/percent.proto.html#envoy-v3-api-msg-type-v3-fractionalpercent"><span class="std std-ref">type.v3.FractionalPercent</span></a>) Target percentage of requests managed by this HTTP connection manager that will be randomly
selected for trace generation, if not requested by the client or not forced. This field is
a direct analog for the runtime variable ‘tracing.random_sampling’ in the
<a class="reference internal" href="../../../../configuration/http/http_conn_man/runtime.html#config-http-conn-man-runtime"><span class="std std-ref">HTTP Connection Manager</span></a>.
Default: 100%</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-tracing-overall-sampling">
<dt>overall_sampling</dt><dd><p>(<a class="reference internal" href="../../../type/v3/percent.proto.html#envoy-v3-api-msg-type-v3-fractionalpercent"><span class="std std-ref">type.v3.FractionalPercent</span></a>) Target percentage of requests managed by this HTTP connection manager that will be traced
after all other sampling checks have been applied (client-directed, force tracing, random
sampling). This field functions as an upper limit on the total configured sampling rate. For
instance, setting client_sampling to 100% but overall_sampling to 1% will result in only 1%
of client requests with the appropriate headers to be force traced. This field is a direct
analog for the runtime variable ‘tracing.global_enabled’ in the
<a class="reference internal" href="../../../../configuration/http/http_conn_man/runtime.html#config-http-conn-man-runtime"><span class="std std-ref">HTTP Connection Manager</span></a>.
Default: 100%</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-tracing-custom-tags">
<dt>custom_tags</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="../../../type/tracing/v3/custom_tag.proto.html#envoy-v3-api-msg-type-tracing-v3-customtag"><span class="std std-ref">type.tracing.v3.CustomTag</span></a>) A list of custom tags with unique tag name to create tags for the active span.
It will take effect after merging with the <a class="reference internal" href="../../../extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto.html#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-tracing-custom-tags"><span class="std std-ref">corresponding configuration</span></a>
configured in the HTTP connection manager. If two tags with the same name are configured
each in the HTTP connection manager and the route level, the one configured here takes
priority.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-virtualcluster">
<span id="envoy-v3-api-msg-config-route-v3-virtualcluster"></span><h2>config.route.v3.VirtualCluster<a class="headerlink" href="#config-route-v3-virtualcluster" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1524">[config.route.v3.VirtualCluster proto]</a></p>
<p>A virtual cluster is a way of specifying a regex matching rule against
certain important endpoints such that statistics are generated explicitly for
the matched requests. The reason this is useful is that when doing
prefix/path matching Envoy does not always know what the application
considers to be an endpoint. Thus, it’s impossible for Envoy to generically
emit per endpoint statistics. However, often systems have highly critical
endpoints that they wish to get “perfect” statistics on. Virtual cluster
statistics are perfect in the sense that they are emitted on the downstream
side such that they include network level failures.</p>
<p>Documentation for <a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router-vcluster-stats"><span class="std std-ref">virtual cluster statistics</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Virtual clusters are a useful tool, but we do not recommend setting up a virtual cluster for
every application endpoint. This is both not easily maintainable and as well the matching and
statistics output are not free.</p>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;headers&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-virtualcluster-headers">
<dt>headers</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-headermatcher"><span class="std std-ref">config.route.v3.HeaderMatcher</span></a>) Specifies a list of header matchers to use for matching requests. Each specified header must
match. The pseudo-headers <cite>:path</cite> and <cite>:method</cite> can be used to match the request path and
method, respectively.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-virtualcluster-name">
<dt>name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) Specifies the name of the virtual cluster. The virtual cluster name as well
as the virtual host name are used when emitting statistics. The statistics are emitted by the
router filter and are documented <a class="reference internal" href="../../../../configuration/http/http_filters/router_filter.html#config-http-filters-router-stats"><span class="std std-ref">here</span></a>.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-ratelimit">
<span id="envoy-v3-api-msg-config-route-v3-ratelimit"></span><h2>config.route.v3.RateLimit<a class="headerlink" href="#config-route-v3-ratelimit" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1543">[config.route.v3.RateLimit proto]</a></p>
<p>Global rate limiting <a class="reference internal" href="../../../../intro/arch_overview/other_features/global_rate_limiting.html#arch-overview-global-rate-limit"><span class="std std-ref">architecture overview</span></a>.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;stage&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;disable_key&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;actions&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;limit&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-v3-api-field-config-route-v3-ratelimit-stage">
<dt>stage</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#uint32value">UInt32Value</a>) Refers to the stage set in the filter. The rate limit configuration only
applies to filters with the same stage number. The default stage number is
0.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The filter supports a range of 0 - 10 inclusively for stage numbers.</p>
</div>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-ratelimit-disable-key">
<dt>disable_key</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) The key to be set in runtime to disable this rate limit configuration.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-ratelimit-actions">
<dt>actions</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-ratelimit-action"><span class="std std-ref">config.route.v3.RateLimit.Action</span></a>, <em>REQUIRED</em>) A list of actions that are to be applied for this rate limit configuration.
Order matters as the actions are processed sequentially and the descriptor
is composed by appending descriptor entries in that sequence. If an action
cannot append a descriptor entry, no descriptor is generated for the
configuration. See <a class="reference internal" href="../../../../configuration/http/http_filters/rate_limit_filter.html#config-http-filters-rate-limit-composing-actions"><span class="std std-ref">composing actions</span></a> for additional documentation.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-ratelimit-limit">
<dt>limit</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-ratelimit-override"><span class="std std-ref">config.route.v3.RateLimit.Override</span></a>) An optional limit override to be appended to the descriptor produced by this
rate limit configuration. If the override value is invalid or cannot be resolved
from metadata, no override is provided. See <a class="reference internal" href="../../../../configuration/http/http_filters/rate_limit_filter.html#config-http-filters-rate-limit-rate-limit-override"><span class="std std-ref">rate limit override</span></a> for more information.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-ratelimit-action">
<span id="envoy-v3-api-msg-config-route-v3-ratelimit-action"></span><h2>config.route.v3.RateLimit.Action<a class="headerlink" href="#config-route-v3-ratelimit-action" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1547">[config.route.v3.RateLimit.Action proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;source_cluster&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;destination_cluster&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;request_headers&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;remote_address&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;generic_key&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;header_value_match&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;dynamic_metadata&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;metadata&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;extension&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-v3-api-field-config-route-v3-ratelimit-action-source-cluster">
<dt>source_cluster</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-ratelimit-action-sourcecluster"><span class="std std-ref">config.route.v3.RateLimit.Action.SourceCluster</span></a>) Rate limit on source cluster.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-source-cluster"><span class="std std-ref">source_cluster</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-destination-cluster"><span class="std std-ref">destination_cluster</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-request-headers"><span class="std std-ref">request_headers</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-remote-address"><span class="std std-ref">remote_address</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-generic-key"><span class="std std-ref">generic_key</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-header-value-match"><span class="std std-ref">header_value_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-dynamic-metadata"><span class="std std-ref">dynamic_metadata</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-metadata"><span class="std std-ref">metadata</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-extension"><span class="std std-ref">extension</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-ratelimit-action-destination-cluster">
<dt>destination_cluster</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-ratelimit-action-destinationcluster"><span class="std std-ref">config.route.v3.RateLimit.Action.DestinationCluster</span></a>) Rate limit on destination cluster.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-source-cluster"><span class="std std-ref">source_cluster</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-destination-cluster"><span class="std std-ref">destination_cluster</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-request-headers"><span class="std std-ref">request_headers</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-remote-address"><span class="std std-ref">remote_address</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-generic-key"><span class="std std-ref">generic_key</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-header-value-match"><span class="std std-ref">header_value_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-dynamic-metadata"><span class="std std-ref">dynamic_metadata</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-metadata"><span class="std std-ref">metadata</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-extension"><span class="std std-ref">extension</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-ratelimit-action-request-headers">
<dt>request_headers</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-ratelimit-action-requestheaders"><span class="std std-ref">config.route.v3.RateLimit.Action.RequestHeaders</span></a>) Rate limit on request headers.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-source-cluster"><span class="std std-ref">source_cluster</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-destination-cluster"><span class="std std-ref">destination_cluster</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-request-headers"><span class="std std-ref">request_headers</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-remote-address"><span class="std std-ref">remote_address</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-generic-key"><span class="std std-ref">generic_key</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-header-value-match"><span class="std std-ref">header_value_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-dynamic-metadata"><span class="std std-ref">dynamic_metadata</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-metadata"><span class="std std-ref">metadata</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-extension"><span class="std std-ref">extension</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-ratelimit-action-remote-address">
<dt>remote_address</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-ratelimit-action-remoteaddress"><span class="std std-ref">config.route.v3.RateLimit.Action.RemoteAddress</span></a>) Rate limit on remote address.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-source-cluster"><span class="std std-ref">source_cluster</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-destination-cluster"><span class="std std-ref">destination_cluster</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-request-headers"><span class="std std-ref">request_headers</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-remote-address"><span class="std std-ref">remote_address</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-generic-key"><span class="std std-ref">generic_key</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-header-value-match"><span class="std std-ref">header_value_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-dynamic-metadata"><span class="std std-ref">dynamic_metadata</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-metadata"><span class="std std-ref">metadata</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-extension"><span class="std std-ref">extension</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-ratelimit-action-generic-key">
<dt>generic_key</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-ratelimit-action-generickey"><span class="std std-ref">config.route.v3.RateLimit.Action.GenericKey</span></a>) Rate limit on a generic key.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-source-cluster"><span class="std std-ref">source_cluster</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-destination-cluster"><span class="std std-ref">destination_cluster</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-request-headers"><span class="std std-ref">request_headers</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-remote-address"><span class="std std-ref">remote_address</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-generic-key"><span class="std std-ref">generic_key</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-header-value-match"><span class="std std-ref">header_value_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-dynamic-metadata"><span class="std std-ref">dynamic_metadata</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-metadata"><span class="std std-ref">metadata</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-extension"><span class="std std-ref">extension</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-ratelimit-action-header-value-match">
<dt>header_value_match</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-ratelimit-action-headervaluematch"><span class="std std-ref">config.route.v3.RateLimit.Action.HeaderValueMatch</span></a>) Rate limit on the existence of request headers.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-source-cluster"><span class="std std-ref">source_cluster</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-destination-cluster"><span class="std std-ref">destination_cluster</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-request-headers"><span class="std std-ref">request_headers</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-remote-address"><span class="std std-ref">remote_address</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-generic-key"><span class="std std-ref">generic_key</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-header-value-match"><span class="std std-ref">header_value_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-dynamic-metadata"><span class="std std-ref">dynamic_metadata</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-metadata"><span class="std std-ref">metadata</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-extension"><span class="std std-ref">extension</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-ratelimit-action-dynamic-metadata">
<dt>dynamic_metadata</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-ratelimit-action-dynamicmetadata"><span class="std std-ref">config.route.v3.RateLimit.Action.DynamicMetaData</span></a>) Rate limit on dynamic metadata.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This field has been deprecated in favor of the <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-metadata"><span class="std std-ref">metadata</span></a> field</p>
</div>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-source-cluster"><span class="std std-ref">source_cluster</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-destination-cluster"><span class="std std-ref">destination_cluster</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-request-headers"><span class="std std-ref">request_headers</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-remote-address"><span class="std std-ref">remote_address</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-generic-key"><span class="std std-ref">generic_key</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-header-value-match"><span class="std std-ref">header_value_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-dynamic-metadata"><span class="std std-ref">dynamic_metadata</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-metadata"><span class="std std-ref">metadata</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-extension"><span class="std std-ref">extension</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-ratelimit-action-metadata">
<dt>metadata</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-ratelimit-action-metadata"><span class="std std-ref">config.route.v3.RateLimit.Action.MetaData</span></a>) Rate limit on metadata.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-source-cluster"><span class="std std-ref">source_cluster</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-destination-cluster"><span class="std std-ref">destination_cluster</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-request-headers"><span class="std std-ref">request_headers</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-remote-address"><span class="std std-ref">remote_address</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-generic-key"><span class="std std-ref">generic_key</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-header-value-match"><span class="std std-ref">header_value_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-dynamic-metadata"><span class="std std-ref">dynamic_metadata</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-metadata"><span class="std std-ref">metadata</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-extension"><span class="std std-ref">extension</span></a> must be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-ratelimit-action-extension">
<dt>extension</dt><dd><p>(<a class="reference internal" href="../../core/v3/extension.proto.html#envoy-v3-api-msg-config-core-v3-typedextensionconfig"><span class="std std-ref">config.core.v3.TypedExtensionConfig</span></a>) Rate limit descriptor extension. See the rate limit descriptor extensions documentation.</p>
<p>Precisely one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-source-cluster"><span class="std std-ref">source_cluster</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-destination-cluster"><span class="std std-ref">destination_cluster</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-request-headers"><span class="std std-ref">request_headers</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-remote-address"><span class="std std-ref">remote_address</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-generic-key"><span class="std std-ref">generic_key</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-header-value-match"><span class="std std-ref">header_value_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-dynamic-metadata"><span class="std std-ref">dynamic_metadata</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-metadata"><span class="std std-ref">metadata</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-ratelimit-action-extension"><span class="std std-ref">extension</span></a> must be set.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-ratelimit-action-sourcecluster">
<span id="envoy-v3-api-msg-config-route-v3-ratelimit-action-sourcecluster"></span><h2>config.route.v3.RateLimit.Action.SourceCluster<a class="headerlink" href="#config-route-v3-ratelimit-action-sourcecluster" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1558">[config.route.v3.RateLimit.Action.SourceCluster proto]</a></p>
<p>The following descriptor entry is appended to the descriptor:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s">&quot;source_cluster&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;local service cluster&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>&lt;local service cluster&gt; is derived from the <a class="reference internal" href="../../../../operations/cli.html#cmdoption-service-cluster"><code class="xref std std-option docutils literal notranslate"><span class="pre">--service-cluster</span></code></a> option.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{}</span>
</pre></div>
</div>
</div>
<div class="section" id="config-route-v3-ratelimit-action-destinationcluster">
<span id="envoy-v3-api-msg-config-route-v3-ratelimit-action-destinationcluster"></span><h2>config.route.v3.RateLimit.Action.DestinationCluster<a class="headerlink" href="#config-route-v3-ratelimit-action-destinationcluster" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1579">[config.route.v3.RateLimit.Action.DestinationCluster proto]</a></p>
<p>The following descriptor entry is appended to the descriptor:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s">&quot;destination_cluster&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;routed target cluster&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Once a request matches against a route table rule, a routed cluster is determined by one of
the following <a class="reference internal" href="route.proto.html#envoy-v3-api-msg-config-route-v3-routeconfiguration"><span class="std std-ref">route table configuration</span></a>
settings:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-cluster"><span class="std std-ref">cluster</span></a> indicates the upstream cluster
to route to.</p></li>
<li><p><a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-weighted-clusters"><span class="std std-ref">weighted_clusters</span></a>
chooses a cluster randomly from a set of clusters with attributed weight.</p></li>
<li><p><a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-cluster-header"><span class="std std-ref">cluster_header</span></a> indicates which
header in the request contains the target cluster.</p></li>
</ul>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{}</span>
</pre></div>
</div>
</div>
<div class="section" id="config-route-v3-ratelimit-action-requestheaders">
<span id="envoy-v3-api-msg-config-route-v3-ratelimit-action-requestheaders"></span><h2>config.route.v3.RateLimit.Action.RequestHeaders<a class="headerlink" href="#config-route-v3-ratelimit-action-requestheaders" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1590">[config.route.v3.RateLimit.Action.RequestHeaders proto]</a></p>
<p>The following descriptor entry is appended when a header contains a key that matches the
<em>header_name</em>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s">&quot;&lt;descriptor_key&gt;&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;header_value_queried_from_header&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;header_name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;descriptor_key&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;skip_if_absent&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-ratelimit-action-requestheaders-header-name">
<dt>header_name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The header name to be queried from the request headers. The header’s
value is used to populate the value of the descriptor entry for the
descriptor_key.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-ratelimit-action-requestheaders-descriptor-key">
<dt>descriptor_key</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The key to use in the descriptor entry.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-ratelimit-action-requestheaders-skip-if-absent">
<dt>skip_if_absent</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) If set to true, Envoy skips the descriptor while calling rate limiting service
when header is not present in the request. By default it skips calling the
rate limiting service if this header is not present in the request.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-ratelimit-action-remoteaddress">
<span id="envoy-v3-api-msg-config-route-v3-ratelimit-action-remoteaddress"></span><h2>config.route.v3.RateLimit.Action.RemoteAddress<a class="headerlink" href="#config-route-v3-ratelimit-action-remoteaddress" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1615">[config.route.v3.RateLimit.Action.RemoteAddress proto]</a></p>
<p>The following descriptor entry is appended to the descriptor and is populated using the
trusted address from <a class="reference internal" href="../../../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-x-forwarded-for"><span class="std std-ref">x-forwarded-for</span></a>:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s">&quot;remote_address&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;trusted address from x-forwarded-for&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{}</span>
</pre></div>
</div>
</div>
<div class="section" id="config-route-v3-ratelimit-action-generickey">
<span id="envoy-v3-api-msg-config-route-v3-ratelimit-action-generickey"></span><h2>config.route.v3.RateLimit.Action.GenericKey<a class="headerlink" href="#config-route-v3-ratelimit-action-generickey" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1625">[config.route.v3.RateLimit.Action.GenericKey proto]</a></p>
<p>The following descriptor entry is appended to the descriptor:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s">&quot;generic_key&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;descriptor_value&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;descriptor_value&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;descriptor_key&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-ratelimit-action-generickey-descriptor-value">
<dt>descriptor_value</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The value to use in the descriptor entry.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-ratelimit-action-generickey-descriptor-key">
<dt>descriptor_key</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) An optional key to use in the descriptor entry. If not set it defaults
to ‘generic_key’ as the descriptor key.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-ratelimit-action-headervaluematch">
<span id="envoy-v3-api-msg-config-route-v3-ratelimit-action-headervaluematch"></span><h2>config.route.v3.RateLimit.Action.HeaderValueMatch<a class="headerlink" href="#config-route-v3-ratelimit-action-headervaluematch" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1642">[config.route.v3.RateLimit.Action.HeaderValueMatch proto]</a></p>
<p>The following descriptor entry is appended to the descriptor:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s">&quot;header_match&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;descriptor_value&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;descriptor_value&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;expect_match&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;headers&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-ratelimit-action-headervaluematch-descriptor-value">
<dt>descriptor_value</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The value to use in the descriptor entry.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-ratelimit-action-headervaluematch-expect-match">
<dt>expect_match</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#boolvalue">BoolValue</a>) If set to true, the action will append a descriptor entry when the
request matches the headers. If set to false, the action will append a
descriptor entry when the request does not match the headers. The
default value is true.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-ratelimit-action-headervaluematch-headers">
<dt>headers</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-headermatcher"><span class="std std-ref">config.route.v3.HeaderMatcher</span></a>, <em>REQUIRED</em>) Specifies a set of headers that the rate limit action should match
on. The action will check the request’s headers against all the
specified headers in the config. A match will happen if all the
headers in the config are present in the request with the same values
(or based on presence if the value field is not in the config).</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-ratelimit-action-dynamicmetadata">
<span id="envoy-v3-api-msg-config-route-v3-ratelimit-action-dynamicmetadata"></span><h2>config.route.v3.RateLimit.Action.DynamicMetaData<a class="headerlink" href="#config-route-v3-ratelimit-action-dynamicmetadata" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1672">[config.route.v3.RateLimit.Action.DynamicMetaData proto]</a></p>
<p>The following descriptor entry is appended when the
<a class="reference internal" href="../../../../configuration/advanced/well_known_dynamic_metadata.html#well-known-dynamic-metadata"><span class="std std-ref">dynamic metadata</span></a> contains a key value:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s">&quot;&lt;descriptor_key&gt;&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;value_queried_from_dynamic_metadata&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This action has been deprecated in favor of the <a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-ratelimit-action-metadata"><span class="std std-ref">metadata</span></a> action</p>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;descriptor_key&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;metadata_key&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;default_value&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-ratelimit-action-dynamicmetadata-descriptor-key">
<dt>descriptor_key</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The key to use in the descriptor entry.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-ratelimit-action-dynamicmetadata-metadata-key">
<dt>metadata_key</dt><dd><p>(<a class="reference internal" href="../../../type/metadata/v3/metadata.proto.html#envoy-v3-api-msg-type-metadata-v3-metadatakey"><span class="std std-ref">type.metadata.v3.MetadataKey</span></a>, <em>REQUIRED</em>) Metadata struct that defines the key and path to retrieve the string value. A match will
only happen if the value in the dynamic metadata is of type string.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-ratelimit-action-dynamicmetadata-default-value">
<dt>default_value</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) An optional value to use if <em>metadata_key</em> is empty. If not set and
no value is present under the metadata_key then no descriptor is generated.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-ratelimit-action-metadata">
<span id="envoy-v3-api-msg-config-route-v3-ratelimit-action-metadata"></span><h2>config.route.v3.RateLimit.Action.MetaData<a class="headerlink" href="#config-route-v3-ratelimit-action-metadata" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1690">[config.route.v3.RateLimit.Action.MetaData proto]</a></p>
<p>The following descriptor entry is appended when the metadata contains a key value:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s">&quot;&lt;descriptor_key&gt;&quot;</span><span class="p">,</span> <span class="s">&quot;&lt;value_queried_from_metadata&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;descriptor_key&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;metadata_key&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;default_value&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-ratelimit-action-metadata-descriptor-key">
<dt>descriptor_key</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) The key to use in the descriptor entry.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-ratelimit-action-metadata-metadata-key">
<dt>metadata_key</dt><dd><p>(<a class="reference internal" href="../../../type/metadata/v3/metadata.proto.html#envoy-v3-api-msg-type-metadata-v3-metadatakey"><span class="std std-ref">type.metadata.v3.MetadataKey</span></a>, <em>REQUIRED</em>) Metadata struct that defines the key and path to retrieve the string value. A match will
only happen if the value in the metadata is of type string.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-ratelimit-action-metadata-default-value">
<dt>default_value</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) An optional value to use if <em>metadata_key</em> is empty. If not set and
no value is present under the metadata_key then no descriptor is generated.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-ratelimit-action-metadata-source">
<dt>source</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-enum-config-route-v3-ratelimit-action-metadata-source"><span class="std std-ref">config.route.v3.RateLimit.Action.MetaData.Source</span></a>) Source of metadata</p>
</dd>
</dl>
</div>
<div class="section" id="enum-config-route-v3-ratelimit-action-metadata-source">
<span id="envoy-v3-api-enum-config-route-v3-ratelimit-action-metadata-source"></span><h2>Enum config.route.v3.RateLimit.Action.MetaData.Source<a class="headerlink" href="#enum-config-route-v3-ratelimit-action-metadata-source" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1691">[config.route.v3.RateLimit.Action.MetaData.Source proto]</a></p>
<dl class="simple" id="envoy-v3-api-enum-value-config-route-v3-ratelimit-action-metadata-source-dynamic">
<dt>DYNAMIC</dt><dd><p><em>(DEFAULT)</em> ⁣Query <a class="reference internal" href="../../../../configuration/advanced/well_known_dynamic_metadata.html#well-known-dynamic-metadata"><span class="std std-ref">dynamic metadata</span></a></p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-config-route-v3-ratelimit-action-metadata-source-route-entry">
<dt>ROUTE_ENTRY</dt><dd><p>⁣Query <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-route-metadata"><span class="std std-ref">route entry metadata</span></a></p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-ratelimit-override">
<span id="envoy-v3-api-msg-config-route-v3-ratelimit-override"></span><h2>config.route.v3.RateLimit.Override<a class="headerlink" href="#config-route-v3-ratelimit-override" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1750">[config.route.v3.RateLimit.Override proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;dynamic_metadata&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-ratelimit-override-dynamic-metadata">
<dt>dynamic_metadata</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-config-route-v3-ratelimit-override-dynamicmetadata"><span class="std std-ref">config.route.v3.RateLimit.Override.DynamicMetadata</span></a>, <em>REQUIRED</em>) Limit override from dynamic metadata.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-ratelimit-override-dynamicmetadata">
<span id="envoy-v3-api-msg-config-route-v3-ratelimit-override-dynamicmetadata"></span><h2>config.route.v3.RateLimit.Override.DynamicMetadata<a class="headerlink" href="#config-route-v3-ratelimit-override-dynamicmetadata" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1752">[config.route.v3.RateLimit.Override.DynamicMetadata proto]</a></p>
<p>Fetches the override from the dynamic metadata.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;metadata_key&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-ratelimit-override-dynamicmetadata-metadata-key">
<dt>metadata_key</dt><dd><p>(<a class="reference internal" href="../../../type/metadata/v3/metadata.proto.html#envoy-v3-api-msg-type-metadata-v3-metadatakey"><span class="std std-ref">type.metadata.v3.MetadataKey</span></a>, <em>REQUIRED</em>) Metadata struct that defines the key and path to retrieve the struct value.
The value must be a struct containing an integer “requests_per_unit” property
and a “unit” property with a value parseable to <a class="reference internal" href="../../../type/v3/ratelimit_unit.proto.html#envoy-v3-api-enum-type-v3-ratelimitunit"><span class="std std-ref">RateLimitUnit
enum</span></a></p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-headermatcher">
<span id="envoy-v3-api-msg-config-route-v3-headermatcher"></span><h2>config.route.v3.HeaderMatcher<a class="headerlink" href="#config-route-v3-headermatcher" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1820">[config.route.v3.HeaderMatcher proto]</a></p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Internally, Envoy always uses the HTTP/2 <em>:authority</em> header to represent the HTTP/1 <em>Host</em>
header. Thus, if attempting to match on <em>Host</em>, match on <em>:authority</em> instead.</p>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>To route on HTTP method, use the special HTTP/2 <em>:method</em> header. This works for both
HTTP/1 and HTTP/2 as Envoy normalizes headers. E.g.,</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;:method&quot;</span><span class="p">,</span>
  <span class="nt">&quot;exact_match&quot;</span><span class="p">:</span> <span class="s2">&quot;POST&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>In the absence of any header match specifier, match will default to <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-present-match"><span class="std std-ref">present_match</span></a>. i.e, a request that has the <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-name"><span class="std std-ref">name</span></a> header will match, regardless of the header’s
value.</p>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;exact_match&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;safe_regex_match&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;range_match&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;present_match&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;prefix_match&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;suffix_match&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;contains_match&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;invert_match&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-headermatcher-name">
<dt>name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) Specifies the name of the header in the request.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-headermatcher-exact-match">
<dt>exact_match</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) If specified, header match will be performed based on the value of the header.</p>
<p>Specifies how the header match will be performed to route the request.</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-exact-match"><span class="std std-ref">exact_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-safe-regex-match"><span class="std std-ref">safe_regex_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-range-match"><span class="std std-ref">range_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-present-match"><span class="std std-ref">present_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-prefix-match"><span class="std std-ref">prefix_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-suffix-match"><span class="std std-ref">suffix_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-contains-match"><span class="std std-ref">contains_match</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-headermatcher-safe-regex-match">
<dt>safe_regex_match</dt><dd><p>(<a class="reference internal" href="../../../type/matcher/v3/regex.proto.html#envoy-v3-api-msg-type-matcher-v3-regexmatcher"><span class="std std-ref">type.matcher.v3.RegexMatcher</span></a>) If specified, this regex string is a regular expression rule which implies the entire request
header value must match the regex. The rule will not match if only a subsequence of the
request header value matches the regex.</p>
<p>Specifies how the header match will be performed to route the request.</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-exact-match"><span class="std std-ref">exact_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-safe-regex-match"><span class="std std-ref">safe_regex_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-range-match"><span class="std std-ref">range_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-present-match"><span class="std std-ref">present_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-prefix-match"><span class="std std-ref">prefix_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-suffix-match"><span class="std std-ref">suffix_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-contains-match"><span class="std std-ref">contains_match</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-headermatcher-range-match">
<dt>range_match</dt><dd><p>(<a class="reference internal" href="../../../type/v3/range.proto.html#envoy-v3-api-msg-type-v3-int64range"><span class="std std-ref">type.v3.Int64Range</span></a>) If specified, header match will be performed based on range.
The rule will match if the request header value is within this range.
The entire request header value must represent an integer in base 10 notation: consisting of
an optional plus or minus sign followed by a sequence of digits. The rule will not match if
the header value does not represent an integer. Match will fail for empty values, floating
point numbers or if only a subsequence of the header value is an integer.</p>
<p>Examples:</p>
<ul class="simple">
<li><p>For range [-10,0), route will match for header value -1, but not for 0, “somestring”, 10.9,
“-1somestring”</p></li>
</ul>
<p>Specifies how the header match will be performed to route the request.</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-exact-match"><span class="std std-ref">exact_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-safe-regex-match"><span class="std std-ref">safe_regex_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-range-match"><span class="std std-ref">range_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-present-match"><span class="std std-ref">present_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-prefix-match"><span class="std std-ref">prefix_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-suffix-match"><span class="std std-ref">suffix_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-contains-match"><span class="std std-ref">contains_match</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-headermatcher-present-match">
<dt>present_match</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) If specified, header match will be performed based on whether the header is in the
request.</p>
<p>Specifies how the header match will be performed to route the request.</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-exact-match"><span class="std std-ref">exact_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-safe-regex-match"><span class="std std-ref">safe_regex_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-range-match"><span class="std std-ref">range_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-present-match"><span class="std std-ref">present_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-prefix-match"><span class="std std-ref">prefix_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-suffix-match"><span class="std std-ref">suffix_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-contains-match"><span class="std std-ref">contains_match</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-headermatcher-prefix-match">
<dt>prefix_match</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) If specified, header match will be performed based on the prefix of the header value.
Note: empty prefix is not allowed, please use present_match instead.</p>
<p>Examples:</p>
<ul class="simple">
<li><p>The prefix <em>abcd</em> matches the value <em>abcdxyz</em>, but not for <em>abcxyz</em>.</p></li>
</ul>
<p>Specifies how the header match will be performed to route the request.</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-exact-match"><span class="std std-ref">exact_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-safe-regex-match"><span class="std std-ref">safe_regex_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-range-match"><span class="std std-ref">range_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-present-match"><span class="std std-ref">present_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-prefix-match"><span class="std std-ref">prefix_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-suffix-match"><span class="std std-ref">suffix_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-contains-match"><span class="std std-ref">contains_match</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-headermatcher-suffix-match">
<dt>suffix_match</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) If specified, header match will be performed based on the suffix of the header value.
Note: empty suffix is not allowed, please use present_match instead.</p>
<p>Examples:</p>
<ul class="simple">
<li><p>The suffix <em>abcd</em> matches the value <em>xyzabcd</em>, but not for <em>xyzbcd</em>.</p></li>
</ul>
<p>Specifies how the header match will be performed to route the request.</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-exact-match"><span class="std std-ref">exact_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-safe-regex-match"><span class="std std-ref">safe_regex_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-range-match"><span class="std std-ref">range_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-present-match"><span class="std std-ref">present_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-prefix-match"><span class="std std-ref">prefix_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-suffix-match"><span class="std std-ref">suffix_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-contains-match"><span class="std std-ref">contains_match</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-headermatcher-contains-match">
<dt>contains_match</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) If specified, header match will be performed based on whether the header value contains
the given value or not.
Note: empty contains match is not allowed, please use present_match instead.</p>
<p>Examples:</p>
<ul class="simple">
<li><p>The value <em>abcd</em> matches the value <em>xyzabcdpqr</em>, but not for <em>xyzbcdpqr</em>.</p></li>
</ul>
<p>Specifies how the header match will be performed to route the request.</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-exact-match"><span class="std std-ref">exact_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-safe-regex-match"><span class="std std-ref">safe_regex_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-range-match"><span class="std std-ref">range_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-present-match"><span class="std std-ref">present_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-prefix-match"><span class="std std-ref">prefix_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-suffix-match"><span class="std std-ref">suffix_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-headermatcher-contains-match"><span class="std std-ref">contains_match</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-headermatcher-invert-match">
<dt>invert_match</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) If specified, the match result will be inverted before checking. Defaults to false.</p>
<p>Examples:</p>
<ul class="simple">
<li><p>The regex <code class="docutils literal notranslate"><span class="pre">\d{3}</span></code> does not match the value <em>1234</em>, so it will match when inverted.</p></li>
<li><p>The range [-10,0) will match the value -1, so it will not match when inverted.</p></li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-queryparametermatcher">
<span id="envoy-v3-api-msg-config-route-v3-queryparametermatcher"></span><h2>config.route.v3.QueryParameterMatcher<a class="headerlink" href="#config-route-v3-queryparametermatcher" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1896">[config.route.v3.QueryParameterMatcher proto]</a></p>
<p>Query parameter matching treats the query string of a request’s :path header
as an ampersand-separated list of keys and/or key=value elements.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;string_match&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;present_match&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-queryparametermatcher-name">
<dt>name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) Specifies the name of a key that must be present in the requested
<em>path</em>’s query string.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-queryparametermatcher-string-match">
<dt>string_match</dt><dd><p>(<a class="reference internal" href="../../../type/matcher/v3/string.proto.html#envoy-v3-api-msg-type-matcher-v3-stringmatcher"><span class="std std-ref">type.matcher.v3.StringMatcher</span></a>) Specifies whether a query parameter value should match against a string.</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-queryparametermatcher-string-match"><span class="std std-ref">string_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-queryparametermatcher-present-match"><span class="std std-ref">present_match</span></a> may be set.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-config-route-v3-queryparametermatcher-present-match">
<dt>present_match</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) Specifies whether a query parameter should be present.</p>
<p>Only one of <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-queryparametermatcher-string-match"><span class="std std-ref">string_match</span></a>, <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-queryparametermatcher-present-match"><span class="std std-ref">present_match</span></a> may be set.</p>
</dd>
</dl>
</div>
<div class="section" id="config-route-v3-internalredirectpolicy">
<span id="envoy-v3-api-msg-config-route-v3-internalredirectpolicy"></span><h2>config.route.v3.InternalRedirectPolicy<a class="headerlink" href="#config-route-v3-internalredirectpolicy" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/5c801b25cae04f06bf48248c90e87d623d7a6283/api/envoy/config/route/v3/route_components.proto#L1918">[config.route.v3.InternalRedirectPolicy proto]</a></p>
<p>HTTP Internal Redirect <a class="reference internal" href="../../../../intro/arch_overview/http/http_connection_management.html#arch-overview-internal-redirects"><span class="std std-ref">architecture overview</span></a>.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;max_internal_redirects&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;redirect_response_codes&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;predicates&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;allow_cross_scheme_redirect&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-v3-api-field-config-route-v3-internalredirectpolicy-max-internal-redirects">
<dt>max_internal_redirects</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#uint32value">UInt32Value</a>) An internal redirect is not handled, unless the number of previous internal redirects that a
downstream request has encountered is lower than this value.
In the case where a downstream request is bounced among multiple routes by internal redirect,
the first route that hits this threshold, or does not set <a class="reference internal" href="#envoy-v3-api-field-config-route-v3-routeaction-internal-redirect-policy"><span class="std std-ref">internal_redirect_policy</span></a>
will pass the redirect back to downstream.</p>
<p>If not specified, at most one redirect will be followed.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-internalredirectpolicy-redirect-response-codes">
<dt>redirect_response_codes</dt><dd><p>(<strong>repeated</strong> <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">uint32</a>) Defines what upstream response codes are allowed to trigger internal redirect. If unspecified,
only 302 will be treated as internal redirect.
Only 301, 302, 303, 307 and 308 are valid values. Any other codes will be ignored.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-internalredirectpolicy-predicates">
<dt>predicates</dt><dd><p>(<strong>repeated</strong> <a class="reference internal" href="../../core/v3/extension.proto.html#envoy-v3-api-msg-config-core-v3-typedextensionconfig"><span class="std std-ref">config.core.v3.TypedExtensionConfig</span></a>) Specifies a list of predicates that are queried when an upstream response is deemed
to trigger an internal redirect by all other criteria. Any predicate in the list can reject
the redirect, causing the response to be proxied to downstream.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-config-route-v3-internalredirectpolicy-allow-cross-scheme-redirect">
<dt>allow_cross_scheme_redirect</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) Allow internal redirect to follow a target URI with a different scheme than the value of
x-forwarded-proto. The default is false.</p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../config.html" class="btn btn-neutral float-right" title="Extensions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="scoped_route.proto.html" class="btn btn-neutral float-left" title="HTTP scoped routing configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2016-2021, Envoy Project Authors

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>