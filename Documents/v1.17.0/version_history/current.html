

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1.17.0 (January 11, 2021) &mdash; envoy 1.17.0-5c801b documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/envoy.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sphinx_tabs/semantic-ui-2.4.1/segment.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sphinx_tabs/semantic-ui-2.4.1/menu.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sphinx_tabs/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1.16.2 (December 7, 2020)" href="v1.16.2.html" />
    <link rel="prev" title="Version history" href="version_history.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/envoy-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.17.0-5c801b
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../start/start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/configuration.html">Configuration reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/overview.html">FAQ</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="version_history.html">Version history</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">1.17.0 (January 11, 2021)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#incompatible-behavior-changes">Incompatible Behavior Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#minor-behavior-changes">Minor Behavior Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bug-fixes">Bug Fixes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#removed-config-or-runtime">Removed Config or Runtime</a></li>
<li class="toctree-l3"><a class="reference internal" href="#new-features">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deprecated">Deprecated</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="v1.16.2.html">1.16.2 (December 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.16.1.html">1.16.1 (November 20, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.16.0.html">1.16.0 (October 8, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.15.3.html">1.15.3 (December 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.15.2.html">1.15.2 (September 29, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.15.1.html">1.15.1 (September 29, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.15.0.html">1.15.0 (July 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.6.html">1.14.6 (December 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.5.html">1.14.5 (September 29, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.4.html">1.14.4 (July 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.3.html">1.14.3 (June 30, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.2.html">1.14.2 (June 8, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.1.html">1.14.1 (April 8, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.14.0.html">1.14.0 (April 8, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.7.html">1.13.7 (December 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.6.html">1.13.6 (September 29, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.5.html">1.13.5 (September 29, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.4.html">1.13.4 (July 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.3.html">1.13.3 (June 30, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.2.html">1.13.2 (June 8, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.1.html">1.13.1 (March 3, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.13.0.html">1.13.0 (January 20, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.7.html">1.12.7 (September 29, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.6.html">1.12.6 (July 7, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.5.html">1.12.5 (June 30, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.4.html">1.12.4 (June 8, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.3.html">1.12.3 (March 3, 2020)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.2.html">1.12.2 (December 10, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.1.html">1.12.1 (November 8, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.12.0.html">1.12.0 (October 31, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.11.2.html">1.11.2 (October 8, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.11.1.html">1.11.1 (August 13, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.11.0.html">1.11.0 (July 11, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.10.0.html">1.10.0 (Apr 5, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.9.1.html">1.9.1 (Apr 2, 2019)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.9.0.html">1.9.0 (Dec 20, 2018)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.8.0.html">1.8.0 (Oct 4, 2018)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.7.0.html">1.7.0 (Jun 21, 2018)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.6.0.html">1.6.0 (March 20, 2018)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.5.0.html">1.5.0 (December 4, 2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.4.0.html">1.4.0 (August 24, 2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.3.0.html">1.3.0 (May 17, 2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.2.0.html">1.2.0 (March 7, 2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.1.0.html">1.1.0 (November 30, 2016)</a></li>
<li class="toctree-l2"><a class="reference internal" href="v1.0.0.html">1.0.0 (September 12, 2016)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#deprecation-policy">Deprecation Policy</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">envoy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="version_history.html">Version history</a> &raquo;</li>
        
      <li>1.17.0 (January 11, 2021)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/version_history/current.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="january-11-2021">
<h1>1.17.0 (January 11, 2021)<a class="headerlink" href="#january-11-2021" title="Permalink to this headline">¶</a></h1>
<div class="section" id="incompatible-behavior-changes">
<h2>Incompatible Behavior Changes<a class="headerlink" href="#incompatible-behavior-changes" title="Permalink to this headline">¶</a></h2>
<p><em>Changes that are expected to cause an incompatibility if applicable; deployment changes are likely required</em></p>
<ul class="simple">
<li><p>config: v2 is now fatal-by-default. This may be overridden by setting <a class="reference internal" href="../operations/cli.html#cmdoption-bootstrap-version"><code class="xref std std-option docutils literal notranslate"><span class="pre">--bootstrap-version</span></code></a> 2 on the CLI for a v2 bootstrap file and also enabling the runtime <cite>envoy.reloadable_features.enable_deprecated_v2_api</cite> feature. See
the <a class="reference internal" href="../faq/api/transition.html#faq-api-version-transition"><span class="std std-ref">FAQ entry</span></a> for further details.</p></li>
</ul>
</div>
<div class="section" id="minor-behavior-changes">
<h2>Minor Behavior Changes<a class="headerlink" href="#minor-behavior-changes" title="Permalink to this headline">¶</a></h2>
<p><em>Changes that may cause incompatibilities for some users, but should not for most</em></p>
<ul class="simple">
<li><p>build: the Alpine based debug images are no longer built in CI, use Ubuntu based images instead.</p></li>
<li><p>decompressor: set the default value of window_bits of the decompressor to 15 to be able to decompress responses compressed by a compressor with any window size.</p></li>
<li><p>expr filter: added <cite>connection.termination_details</cite> property support.</p></li>
<li><p>formatter: the <a class="reference internal" href="../api-v3/config/core/v3/substitution_format_string.proto.html#envoy-v3-api-field-config-core-v3-substitutionformatstring-text-format"><span class="std std-ref">text_format</span></a> field no longer requires at least one byte, and may now be the empty string. It has also become <a class="reference internal" href="#deprecated"><span class="std std-ref">deprecated</span></a>.</p></li>
<li><p>grpc_web filter: if a <cite>grpc-accept-encoding</cite> header is present it’s passed as-is to the upstream and if it isn’t <cite>grpc-accept-encoding:identity</cite> is sent instead. The header was always overwriten with <cite>grpc-accept-encoding:identity,deflate,gzip</cite> before.</p></li>
<li><p>http: upstream protocol will now only be logged if an upstream stream was established.</p></li>
<li><p>jwt_authn filter: added support of JWT time constraint verification with a clock skew (default to 60 seconds) and added a filter config field <a class="reference internal" href="../api-v3/extensions/filters/http/jwt_authn/v3/config.proto.html#envoy-v3-api-field-extensions-filters-http-jwt-authn-v3-jwtprovider-clock-skew-seconds"><span class="std std-ref">clock_skew_seconds</span></a> to configure it.</p></li>
<li><p>listener: injection of the <a class="reference internal" href="../configuration/listeners/listener_filters/tls_inspector.html#config-listener-filters-tls-inspector"><span class="std std-ref">TLS inspector</span></a> has been disabled by default. This feature is controlled by the runtime guard <cite>envoy.reloadable_features.disable_tls_inspector_injection</cite>.</p></li>
<li><p>lua: added <cite>always_wrap_body</cite> argument to <cite>body()</cite> API to always return a <a class="reference internal" href="../configuration/http/http_filters/lua_filter.html#config-http-filters-lua-buffer-wrapper"><span class="std std-ref">buffer object</span></a> even if the body is empty.</p></li>
<li><p>memory: enabled new tcmalloc with restartable sequences for aarch64 builds.</p></li>
<li><p>mongo proxy metrics: swapped network connection remote and local closed counters previously set reversed (<cite>cx_destroy_local_with_active_rq</cite> and <cite>cx_destroy_remote_with_active_rq</cite>).</p></li>
<li><p>outlier detection: added <a class="reference internal" href="../api-v3/config/cluster/v3/outlier_detection.proto.html#envoy-v3-api-field-config-cluster-v3-outlierdetection-max-ejection-time"><span class="std std-ref">max_ejection_time</span></a> to limit ejection time growth when a node stays unhealthy for extended period of time. By default <a class="reference internal" href="../api-v3/config/cluster/v3/outlier_detection.proto.html#envoy-v3-api-field-config-cluster-v3-outlierdetection-max-ejection-time"><span class="std std-ref">max_ejection_time</span></a> limits ejection time to 5 minutes. Additionally, when the node stays healthy, ejection time decreases. See <a class="reference internal" href="../intro/arch_overview/upstream/outlier.html#arch-overview-outlier-detection-algorithm"><span class="std std-ref">ejection algorithm</span></a> for more info. Previously, ejection time could grow without limit and never decreased.</p></li>
<li><p>performance: improved performance when handling large HTTP/1 bodies.</p></li>
<li><p>tcp_proxy: now waits for HTTP tunnel to be established before start streaming the downstream data, the runtime guard <cite>envoy.reloadable_features.http_upstream_wait_connect_response</cite> can be set to “false” to disable this behavior.</p></li>
<li><p>tls: removed RSA key transport and SHA-1 cipher suites from the client-side defaults.</p></li>
<li><p>watchdog: the watchdog action <a class="reference internal" href="../api-v3/watchdog/v3alpha/abort_action.proto.html#envoy-v3-api-msg-watchdog-v3alpha-abortactionconfig"><span class="std std-ref">abort_action</span></a> is now the default action to terminate the process if watchdog kill / multikill is enabled.</p></li>
<li><p>xds: to support TTLs, heartbeating has been added to xDS. As a result, responses that contain empty resources without updating the version will no longer be propagated to the
subscribers. To undo this for VHDS (which is the only subscriber that wants empty resources), the <cite>envoy.reloadable_features.vhds_heartbeats</cite> can be set to “false”.</p></li>
</ul>
</div>
<div class="section" id="bug-fixes">
<h2>Bug Fixes<a class="headerlink" href="#bug-fixes" title="Permalink to this headline">¶</a></h2>
<p><em>Changes expected to improve the state of the world and are unlikely to have negative effects</em></p>
<ul class="simple">
<li><p>config: validate that upgrade configs have a non-empty <a class="reference internal" href="../api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto.html#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-upgradeconfig-upgrade-type"><span class="std std-ref">upgrade_type</span></a>, fixing a bug where an errant “-” could result in unexpected behavior.</p></li>
<li><p>dns: fixed a bug where custom resolvers provided in configuration were not preserved after network issues.</p></li>
<li><p>dns_filter: correctly associate DNS response IDs when multiple queries are received.</p></li>
<li><p>grpc mux: fixed sending node again after stream is reset when <a class="reference internal" href="../api-v2/api/v2/core/config_source.proto.html#envoy-api-field-core-apiconfigsource-set-node-on-first-message-only"><span class="std std-ref">set_node_on_first_message_only</span></a> is set.</p></li>
<li><p>http: fixed URL parsing for HTTP/1.1 fully qualified URLs and connect requests containing IPv6 addresses.</p></li>
<li><p>http: reject requests with missing required headers after filter chain processing.</p></li>
<li><p>http: sending CONNECT_ERROR for HTTP/2 where appropriate during CONNECT requests.</p></li>
<li><p>proxy_proto: fixed a bug where the wrong downstream address got sent to upstream connections.</p></li>
<li><p>proxy_proto: fixed a bug where network filters would not have the correct downstreamRemoteAddress() when accessed from the StreamInfo. This could result in incorrect enforcement of RBAC rules in the RBAC network filter (but not in the RBAC HTTP filter), or incorrect access log addresses from tcp_proxy.</p></li>
<li><p>sds: fixed a bug that clusters sharing same sds target are marked active immediately.</p></li>
<li><p>tls: fixed detection of the upstream connection close event.</p></li>
<li><p>tls: fixed read resumption after triggering buffer high-watermark and all remaining request/response bytes are stored in the SSL connection’s internal buffers.</p></li>
<li><p>udp: fixed issue in which receiving truncated UDP datagrams would cause Envoy to crash.</p></li>
<li><p>watchdog: touch the watchdog before most event loop operations to avoid misses when handling bursts of callbacks.</p></li>
</ul>
</div>
<div class="section" id="removed-config-or-runtime">
<h2>Removed Config or Runtime<a class="headerlink" href="#removed-config-or-runtime" title="Permalink to this headline">¶</a></h2>
<p><em>Normally occurs at the end of the</em> <a class="reference internal" href="version_history.html#deprecated"><span class="std std-ref">deprecation period</span></a></p>
<ul class="simple">
<li><p>dispatcher: removed legacy socket read/write resumption code path and runtime guard <cite>envoy.reloadable_features.activate_fds_next_event_loop</cite>.</p></li>
<li><p>ext_authz: removed auto ignore case in HTTP-based <cite>ext_authz</cite> header matching and the runtime guard <cite>envoy.reloadable_features.ext_authz_http_service_enable_case_sensitive_string_matcher</cite>. To ignore case, set the <a class="reference internal" href="../api-v2/type/matcher/string.proto.html#envoy-api-field-type-matcher-stringmatcher-ignore-case"><span class="std std-ref">ignore_case</span></a> field to true.</p></li>
<li><p>ext_authz: the deprecated field <cite>use_alpha</cite> is no longer supported and cannot be set anymore.</p></li>
<li><p>http: removed <cite>envoy.reloadable_features.http1_flood_protection</cite> and legacy code path for turning flood protection off.</p></li>
<li><p>http: removed <cite>envoy.reloadable_features.new_codec_behavior</cite> and legacy codecs.</p></li>
</ul>
</div>
<div class="section" id="new-features">
<h2>New Features<a class="headerlink" href="#new-features" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>compression: the <a class="reference internal" href="../api-v3/extensions/filters/http/compressor/v3/compressor.proto.html#envoy-v3-api-msg-extensions-filters-http-compressor-v3-compressor"><span class="std std-ref">compressor</span></a> filter added support for compressing request payloads. Its configuration is unified with the <a class="reference internal" href="../api-v3/extensions/filters/http/decompressor/v3/decompressor.proto.html#envoy-v3-api-msg-extensions-filters-http-decompressor-v3-decompressor"><span class="std std-ref">decompressor</span></a> filter with two new fields for different directions - <a class="reference internal" href="../api-v3/extensions/filters/http/compressor/v3/compressor.proto.html#envoy-v3-api-field-extensions-filters-http-compressor-v3-compressor-request-direction-config"><span class="std std-ref">requests</span></a> and <a class="reference internal" href="../api-v3/extensions/filters/http/compressor/v3/compressor.proto.html#envoy-v3-api-field-extensions-filters-http-compressor-v3-compressor-response-direction-config"><span class="std std-ref">responses</span></a>. The latter deprecates the old response-specific fields and, if used, roots the response-specific stats in <cite>&lt;stat_prefix&gt;.compressor.&lt;compressor_library.name&gt;.&lt;compressor_library_stat_prefix&gt;.response.*</cite> instead of <cite>&lt;stat_prefix&gt;.compressor.&lt;compressor_library.name&gt;.&lt;compressor_library_stat_prefix&gt;.*</cite>.</p></li>
<li><p>config: added ability to flush stats when the admin’s <a class="reference internal" href="../operations/admin.html#operations-admin-interface-stats"><span class="std std-ref">/stats endpoint</span></a> is hit instead of on a timer via <a class="reference internal" href="../api-v3/config/bootstrap/v3/bootstrap.proto.html#envoy-v3-api-field-config-bootstrap-v3-bootstrap-stats-flush-on-admin"><span class="std std-ref">stats_flush_on_admin</span></a>.</p></li>
<li><p>config: added new runtime feature <cite>envoy.features.enable_all_deprecated_features</cite> that allows the use of all deprecated features.</p></li>
<li><p>crash support: added the ability to dump L4 connection data on crash.</p></li>
<li><p>formatter: added new <a class="reference internal" href="../api-v3/config/core/v3/substitution_format_string.proto.html#envoy-v3-api-field-config-core-v3-substitutionformatstring-text-format-source"><span class="std std-ref">text_format_source</span></a> field to support format strings both inline and from a file.</p></li>
<li><p>formatter: added support for custom date formatting to <a class="reference internal" href="../configuration/observability/access_log/usage.html#config-access-log-format-downstream-peer-cert-v-start"><span class="std std-ref">%DOWNSTREAM_PEER_CERT_V_START%</span></a> and <a class="reference internal" href="../configuration/observability/access_log/usage.html#config-access-log-format-downstream-peer-cert-v-end"><span class="std std-ref">%DOWNSTREAM_PEER_CERT_V_END%</span></a>, similar to <a class="reference internal" href="../configuration/observability/access_log/usage.html#config-access-log-format-start-time"><span class="std std-ref">%START_TIME%</span></a>.</p></li>
<li><p>grpc: implemented header value syntax support when defining <a class="reference internal" href="../api-v3/config/core/v3/grpc_service.proto.html#envoy-v3-api-field-config-core-v3-grpcservice-initial-metadata"><span class="std std-ref">initial metadata</span></a> for gRPC-based <cite>ext_authz</cite> <a class="reference internal" href="../api-v3/extensions/filters/http/ext_authz/v3/ext_authz.proto.html#envoy-v3-api-field-extensions-filters-http-ext-authz-v3-extauthz-grpc-service"><span class="std std-ref">HTTP</span></a> and <a class="reference internal" href="../api-v3/extensions/filters/network/ext_authz/v3/ext_authz.proto.html#envoy-v3-api-field-extensions-filters-network-ext-authz-v3-extauthz-grpc-service"><span class="std std-ref">network</span></a> filters, and <a class="reference internal" href="../api-v3/config/ratelimit/v3/rls.proto.html#envoy-v3-api-field-config-ratelimit-v3-ratelimitserviceconfig-grpc-service"><span class="std std-ref">ratelimit</span></a> filters.</p></li>
<li><p>grpc-json: added support for configuring <a class="reference internal" href="../api-v3/extensions/filters/http/grpc_json_transcoder/v3/transcoder.proto.html#envoy-v3-api-field-extensions-filters-http-grpc-json-transcoder-v3-grpcjsontranscoder-url-unescape-spec"><span class="std std-ref">unescaping behavior</span></a> for path components.</p></li>
<li><p>hds: added support for delta updates in the <a class="reference internal" href="../api-v3/service/health/v3/hds.proto.html#envoy-v3-api-msg-service-health-v3-healthcheckspecifier"><span class="std std-ref">HealthCheckSpecifier</span></a>, making only the Endpoints and Health Checkers that changed be reconstructed on receiving a new message, rather than the entire HDS.</p></li>
<li><p>health_check: added option to use <a class="reference internal" href="../api-v3/config/core/v3/health_check.proto.html#envoy-v3-api-field-config-core-v3-healthcheck-no-traffic-healthy-interval"><span class="std std-ref">no_traffic_healthy_interval</span></a> which allows a different no traffic interval when the host is healthy.</p></li>
<li><p>http: added HCM <a class="reference internal" href="../api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto.html#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-request-headers-timeout"><span class="std std-ref">request_headers_timeout config field</span></a> to control how long a downstream has to finish sending headers before the stream is cancelled.</p></li>
<li><p>http: added frame flood and abuse checks to the upstream HTTP/2 codec. This check is off by default and can be enabled by setting the <cite>envoy.reloadable_features.upstream_http2_flood_checks</cite> runtime key to true.</p></li>
<li><p>http: added <a class="reference internal" href="../api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto.html#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-strip-any-host-port"><span class="std std-ref">stripping any port from host header</span></a> support.</p></li>
<li><p>http: clusters added support for selecting HTTP/1 or HTTP/2 based on ALPN, configurable via <a class="reference internal" href="../api-v3/extensions/upstreams/http/v3/http_protocol_options.proto.html#envoy-v3-api-field-extensions-upstreams-http-v3-httpprotocoloptions-auto-config"><span class="std std-ref">alpn_config</span></a> in the <a class="reference internal" href="../api-v3/extensions/upstreams/http/v3/http_protocol_options.proto.html#envoy-v3-api-msg-extensions-upstreams-http-v3-httpprotocoloptions"><span class="std std-ref">http_protocol_options</span></a> message.</p></li>
<li><p>jwt_authn: added support for <a class="reference internal" href="../api-v3/extensions/filters/http/jwt_authn/v3/config.proto.html#envoy-v3-api-msg-extensions-filters-http-jwt-authn-v3-perrouteconfig"><span class="std std-ref">per-route config</span></a>.</p></li>
<li><p>jwt_authn: changed config field <a class="reference internal" href="../api-v3/extensions/filters/http/jwt_authn/v3/config.proto.html#envoy-v3-api-field-extensions-filters-http-jwt-authn-v3-jwtprovider-issuer"><span class="std std-ref">issuer</span></a> to be optional to comply with JWT <a class="reference external" href="https://tools.ietf.org/html/rfc7519#section-4.1.1">RFC</a> requirements.</p></li>
<li><p>kill_request: added new <a class="reference internal" href="../configuration/http/http_filters/kill_request_filter.html#config-http-filters-kill-request"><span class="std std-ref">HTTP kill request filter</span></a>.</p></li>
<li><p>listener: added an optional <a class="reference internal" href="../api-v3/config/listener/v3/listener.proto.html#envoy-v3-api-field-config-listener-v3-listener-default-filter-chain"><span class="std std-ref">default filter chain</span></a>. If this field is supplied, and none of the <a class="reference internal" href="../api-v3/config/listener/v3/listener.proto.html#envoy-v3-api-field-config-listener-v3-listener-filter-chains"><span class="std std-ref">filter_chains</span></a> matches, this default filter chain is used to serve the connection.</p></li>
<li><p>listener: added back the <a class="reference internal" href="../api-v3/config/listener/v3/listener.proto.html#envoy-v3-api-field-config-listener-v3-listener-use-original-dst"><span class="std std-ref">use_original_dst field</span></a>.</p></li>
<li><p>listener: added the <a class="reference internal" href="../api-v3/config/listener/v3/listener.proto.html#envoy-v3-api-field-config-listener-v3-listener-bind-to-port"><span class="std std-ref">Listener.bind_to_port field</span></a>.</p></li>
<li><p>log: added a new custom flag <code class="docutils literal notranslate"><span class="pre">%_</span></code> to the log pattern to print the actual message to log, but with escaped newlines.</p></li>
<li><p>lua: added <cite>downstreamDirectRemoteAddress()</cite> and <cite>downstreamLocalAddress()</cite> APIs to <a class="reference internal" href="../configuration/http/http_filters/lua_filter.html#config-http-filters-lua-stream-info-wrapper"><span class="std std-ref">streamInfo()</span></a>.</p></li>
<li><p>mongo_proxy: the list of commands to produce metrics for is now <a class="reference internal" href="../api-v3/extensions/filters/network/mongo_proxy/v3/mongo_proxy.proto.html#envoy-v3-api-field-extensions-filters-network-mongo-proxy-v3-mongoproxy-commands"><span class="std std-ref">configurable</span></a>.</p></li>
<li><p>network: added a <a class="reference internal" href="../api-v3/config/listener/v3/listener_components.proto.html#envoy-v3-api-field-config-listener-v3-filterchain-transport-socket-connect-timeout"><span class="std std-ref">transport_socket_connect_timeout config field</span></a> for incoming connections completing transport-level negotiation, including TLS and ALTS hanshakes.</p></li>
<li><p>overload: added <a class="reference internal" href="../configuration/operations/overload_manager/overload_manager.html#config-overload-manager-overload-actions"><span class="std std-ref">envoy.overload_actions.reduce_timeouts</span></a> overload action to enable scaling timeouts down with load. Scaling support <a class="reference internal" href="../api-v3/config/overload/v3/overload.proto.html#envoy-v3-api-enum-config-overload-v3-scaletimersoverloadactionconfig-timertype"><span class="std std-ref">is limited</span></a> to the HTTP connection and stream idle timeouts.</p></li>
<li><p>ratelimit: added support for use of various <a class="reference internal" href="../api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-ratelimit-action-metadata"><span class="std std-ref">metadata</span></a> as a ratelimit action.</p></li>
<li><p>ratelimit: added <a class="reference internal" href="../api-v3/extensions/filters/http/ratelimit/v3/rate_limit.proto.html#envoy-v3-api-msg-extensions-filters-http-ratelimit-v3-ratelimit"><span class="std std-ref">disable_x_envoy_ratelimited_header</span></a> option to disable <cite>X-Envoy-RateLimited</cite> header.</p></li>
<li><p>ratelimit: added <a class="reference internal" href="../api-v3/service/ratelimit/v3/rls.proto.html#envoy-v3-api-field-service-ratelimit-v3-ratelimitresponse-raw-body"><span class="std std-ref">body</span></a> field to support custom response bodies for non-OK responses from the external ratelimit service.</p></li>
<li><p>ratelimit: added <a class="reference internal" href="../api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-ratelimit-action-extension"><span class="std std-ref">descriptor extensions</span></a>.</p></li>
<li><p>ratelimit: added <a class="reference internal" href="../api-v3/extensions/rate_limit_descriptors/expr/v3/expr.proto.html#envoy-v3-api-msg-extensions-rate-limit-descriptors-expr-v3-descriptor"><span class="std std-ref">computed descriptors</span></a>.</p></li>
<li><p>ratelimit: added <a class="reference internal" href="../api-v3/service/ratelimit/v3/rls.proto.html#envoy-v3-api-field-service-ratelimit-v3-ratelimitresponse-dynamic-metadata"><span class="std std-ref">dynamic_metadata</span></a> field to support setting dynamic metadata from the ratelimit service.</p></li>
<li><p>router: added support for regex rewrites during HTTP redirects using <a class="reference internal" href="../api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-redirectaction-regex-rewrite"><span class="std std-ref">regex_rewrite</span></a>.</p></li>
<li><p>sds: improved support for atomic <a class="reference internal" href="../configuration/security/secret.html#xds-certificate-rotation"><span class="std std-ref">key rotations</span></a> and added configurable rotation triggers for
<a class="reference internal" href="../api-v3/extensions/transport_sockets/tls/v3/common.proto.html#envoy-v3-api-field-extensions-transport-sockets-tls-v3-tlscertificate-watched-directory"><span class="std std-ref">TlsCertificate</span></a> and
<a class="reference internal" href="../api-v3/extensions/transport_sockets/tls/v3/common.proto.html#envoy-v3-api-field-extensions-transport-sockets-tls-v3-certificatevalidationcontext-watched-directory"><span class="std std-ref">CertificateValidationContext</span></a>.</p></li>
<li><p>signal: added an extension point for custom actions to run on the thread that has encountered a fatal error. Actions are configurable via <a class="reference internal" href="../api-v3/config/bootstrap/v3/bootstrap.proto.html#envoy-v3-api-field-config-bootstrap-v3-bootstrap-fatal-actions"><span class="std std-ref">fatal_actions</span></a>.</p></li>
<li><p>start_tls: added new <a class="reference internal" href="../api-v3/extensions/transport_sockets/starttls/v3/starttls.proto.html#envoy-v3-api-msg-extensions-transport-sockets-starttls-v3-starttlsconfig"><span class="std std-ref">transport socket</span></a> which starts in clear-text but may programatically be converted to use tls.</p></li>
<li><p>tcp: added a new <a class="reference internal" href="../configuration/operations/overload_manager/overload_manager.html#config-overload-manager-overload-actions"><span class="std std-ref">envoy.overload_actions.reject_incoming_connections</span></a> action to reject incoming TCP connections.</p></li>
<li><p>thrift_proxy: added a new <a class="reference internal" href="../api-v3/extensions/filters/network/thrift_proxy/v3/thrift_proxy.proto.html#envoy-v3-api-field-extensions-filters-network-thrift-proxy-v3-thriftproxy-payload-passthrough"><span class="std std-ref">payload_passthrough</span></a> option to skip decoding body in the Thrift message.</p></li>
<li><p>tls: added support for RSA certificates with 4096-bit keys in FIPS mode.</p></li>
<li><p>tracing: added <a class="reference internal" href="../api-v3/config/trace/v3/skywalking.proto.html#envoy-v3-api-msg-config-trace-v3-skywalkingconfig"><span class="std std-ref">SkyWalking tracer</span></a>.</p></li>
<li><p>tracing: added support for setting the hostname used when sending spans to a Zipkin collector using the <a class="reference internal" href="../api-v3/config/trace/v3/zipkin.proto.html#envoy-v3-api-field-config-trace-v3-zipkinconfig-collector-hostname"><span class="std std-ref">collector_hostname</span></a> field.</p></li>
<li><p>xds: added support for resource TTLs. A TTL is specified on the <a class="reference internal" href="../api-v2/api/v2/discovery.proto.html#envoy-api-msg-resource"><span class="std std-ref">Resource</span></a>. For SotW, a <a class="reference internal" href="../api-v2/api/v2/discovery.proto.html#envoy-api-msg-resource"><span class="std std-ref">Resource</span></a> can be embedded in the list of resources to specify the TTL.</p></li>
</ul>
</div>
<div class="section" id="deprecated">
<span id="id1"></span><h2>Deprecated<a class="headerlink" href="#deprecated" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>cluster: HTTP configuration for upstream clusters has been reworked. HTTP-specific configuration is now done in the new <a class="reference internal" href="../api-v3/extensions/upstreams/http/v3/http_protocol_options.proto.html#envoy-v3-api-msg-extensions-upstreams-http-v3-httpprotocoloptions"><span class="std std-ref">http_protocol_options</span></a> message, configured via the cluster’s <a class="reference internal" href="../api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-typed-extension-protocol-options"><span class="std std-ref">extension_protocol_options</span></a>. This replaces explicit HTTP configuration in cluster config, including <a class="reference internal" href="../api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-upstream-http-protocol-options"><span class="std std-ref">upstream_http_protocol_options</span></a> <a class="reference internal" href="../api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-common-http-protocol-options"><span class="std std-ref">common_http_protocol_options</span></a> <a class="reference internal" href="../api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-http-protocol-options"><span class="std std-ref">http_protocol_options</span></a> <a class="reference internal" href="../api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-http2-protocol-options"><span class="std std-ref">http2_protocol_options</span></a> and <a class="reference internal" href="../api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-protocol-selection"><span class="std std-ref">protocol_selection</span></a>. Examples of before-and-after configuration can be found in the <a class="reference internal" href="../api-v3/extensions/upstreams/http/v3/http_protocol_options.proto.html#envoy-v3-api-msg-extensions-upstreams-http-v3-httpprotocoloptions"><span class="std std-ref">http_protocol_options docs</span></a> and all of Envoy’s example configurations have been updated to the new style of config.</p></li>
<li><p>compression: the fields <a class="reference internal" href="../api-v3/extensions/filters/http/compressor/v3/compressor.proto.html#envoy-v3-api-field-extensions-filters-http-compressor-v3-compressor-content-length"><span class="std std-ref">content_length</span></a>, <a class="reference internal" href="../api-v3/extensions/filters/http/compressor/v3/compressor.proto.html#envoy-v3-api-field-extensions-filters-http-compressor-v3-compressor-content-type"><span class="std std-ref">content_type</span></a>, <a class="reference internal" href="../api-v3/extensions/filters/http/compressor/v3/compressor.proto.html#envoy-v3-api-field-extensions-filters-http-compressor-v3-compressor-disable-on-etag-header"><span class="std std-ref">disable_on_etag_header</span></a>, <a class="reference internal" href="../api-v3/extensions/filters/http/compressor/v3/compressor.proto.html#envoy-v3-api-field-extensions-filters-http-compressor-v3-compressor-remove-accept-encoding-header"><span class="std std-ref">remove_accept_encoding_header</span></a> and <a class="reference internal" href="../api-v3/extensions/filters/http/compressor/v3/compressor.proto.html#envoy-v3-api-field-extensions-filters-http-compressor-v3-compressor-runtime-enabled"><span class="std std-ref">runtime_enabled</span></a> of the <a class="reference internal" href="../api-v3/extensions/filters/http/compressor/v3/compressor.proto.html#envoy-v3-api-msg-extensions-filters-http-compressor-v3-compressor"><span class="std std-ref">Compressor</span></a> message have been deprecated in favor of <a class="reference internal" href="../api-v3/extensions/filters/http/compressor/v3/compressor.proto.html#envoy-v3-api-field-extensions-filters-http-compressor-v3-compressor-response-direction-config"><span class="std std-ref">response_direction_config</span></a>.</p></li>
<li><p>formatter: <a class="reference internal" href="../api-v3/config/core/v3/substitution_format_string.proto.html#envoy-v3-api-field-config-core-v3-substitutionformatstring-text-format"><span class="std std-ref">text_format</span></a> is now deprecated in favor of <a class="reference internal" href="../api-v3/config/core/v3/substitution_format_string.proto.html#envoy-v3-api-field-config-core-v3-substitutionformatstring-text-format-source"><span class="std std-ref">text_format_source</span></a>. To migrate existing text format strings, use the <a class="reference internal" href="../api-v3/config/core/v3/base.proto.html#envoy-v3-api-field-config-core-v3-datasource-inline-string"><span class="std std-ref">inline_string</span></a> field.</p></li>
<li><p>gzip: <a class="reference internal" href="../configuration/http/http_filters/gzip_filter.html#config-http-filters-gzip"><span class="std std-ref">HTTP Gzip filter</span></a> is rejected now unless explicitly allowed with <a class="reference internal" href="../configuration/operations/runtime.html#config-runtime-deprecation"><span class="std std-ref">runtime override</span></a> <cite>envoy.deprecated_features.allow_deprecated_gzip_http_filter</cite> set to <cite>true</cite>. Use the <a class="reference internal" href="../configuration/http/http_filters/compressor_filter.html#config-http-filters-compressor"><span class="std std-ref">compressor filter</span></a>.</p></li>
<li><p>listener: <a class="reference internal" href="../api-v3/config/listener/v3/listener_components.proto.html#envoy-v3-api-field-config-listener-v3-filterchain-use-proxy-proto"><span class="std std-ref">use_proxy_proto</span></a> has been deprecated in favor of adding a <a class="reference internal" href="../configuration/listeners/listener_filters/proxy_protocol.html#config-listener-filters-proxy-protocol"><span class="std std-ref">PROXY protocol listener filter</span></a> explicitly.</p></li>
<li><p>logging: the <cite>–log-format-prefix-with-location</cite> option is removed.</p></li>
<li><p>ratelimit: the <a class="reference internal" href="../api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-ratelimit-action-dynamic-metadata"><span class="std std-ref">dynamic metadata</span></a> action is deprecated in favor of the more generic <a class="reference internal" href="../api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-ratelimit-action-metadata"><span class="std std-ref">metadata</span></a> action.</p></li>
<li><p>stats: the <cite>–use-fake-symbol-table</cite> option is removed.</p></li>
<li><p>tracing: OpenCensus <a class="reference internal" href="../api-v2/config/trace/v2/opencensus.proto.html#envoy-api-field-config-trace-v2-opencensusconfig-zipkin-exporter-enabled"><span class="std std-ref">Zipkin configuration</span></a> is now deprecated, the preferred Zipkin export is via Envoy’s <a class="reference internal" href="../api-v3/config/trace/v3/zipkin.proto.html#envoy-v3-api-msg-config-trace-v3-zipkinconfig"><span class="std std-ref">native Zipkin tracer</span></a>.</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="v1.16.2.html" class="btn btn-neutral float-right" title="1.16.2 (December 7, 2020)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="version_history.html" class="btn btn-neutral float-left" title="Version history" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2016-2021, Envoy Project Authors

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>