

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Dynamic configuration &mdash; envoy tag-v1.9.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/envoy.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Initialization" href="init.html" />
    <link rel="prev" title="Hot restart" href="hot_restart.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> envoy
          

          
          </a>

          
            
            
              <div class="version">
                tag-v1.9.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../intro.html">Introduction</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../what_is_envoy.html">What is Envoy</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="arch_overview.html">Architecture overview</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="terminology.html">Terminology</a></li>
<li class="toctree-l3"><a class="reference internal" href="threading_model.html">Threading model</a></li>
<li class="toctree-l3"><a class="reference internal" href="listeners.html">Listeners</a></li>
<li class="toctree-l3"><a class="reference internal" href="listener_filters.html">Listener filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="network_filters.html">Network (L3/L4) filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="http_connection_management.html">HTTP connection management</a></li>
<li class="toctree-l3"><a class="reference internal" href="http_filters.html">HTTP filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="data_sharing_between_filters.html">Static State</a></li>
<li class="toctree-l3"><a class="reference internal" href="data_sharing_between_filters.html#dynamic-state">Dynamic State</a></li>
<li class="toctree-l3"><a class="reference internal" href="http_routing.html">HTTP routing</a></li>
<li class="toctree-l3"><a class="reference internal" href="grpc.html">gRPC</a></li>
<li class="toctree-l3"><a class="reference internal" href="websocket.html">WebSocket and HTTP upgrades</a></li>
<li class="toctree-l3"><a class="reference internal" href="cluster_manager.html">Cluster manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="service_discovery.html">Service discovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="health_checking.html">Health checking</a></li>
<li class="toctree-l3"><a class="reference internal" href="connection_pooling.html">Connection pooling</a></li>
<li class="toctree-l3"><a class="reference internal" href="load_balancing/load_balancing.html">Load Balancing</a></li>
<li class="toctree-l3"><a class="reference internal" href="outlier.html">Outlier detection</a></li>
<li class="toctree-l3"><a class="reference internal" href="circuit_breaking.html">Circuit breaking</a></li>
<li class="toctree-l3"><a class="reference internal" href="global_rate_limiting.html">Global rate limiting</a></li>
<li class="toctree-l3"><a class="reference internal" href="ssl.html">TLS</a></li>
<li class="toctree-l3"><a class="reference internal" href="statistics.html">Statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="runtime.html">Runtime configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="tracing.html">Tracing</a></li>
<li class="toctree-l3"><a class="reference internal" href="tcp_proxy.html">TCP proxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="access_logging.html">Access logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="mongo.html">MongoDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamo.html">DynamoDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="redis.html">Redis</a></li>
<li class="toctree-l3"><a class="reference internal" href="hot_restart.html">Hot restart</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Dynamic configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fully-static">Fully static</a></li>
<li class="toctree-l4"><a class="reference internal" href="#eds-only">EDS only</a></li>
<li class="toctree-l4"><a class="reference internal" href="#eds-and-cds">EDS and CDS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#eds-cds-and-rds">EDS, CDS, and RDS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#eds-cds-rds-and-lds">EDS, CDS, RDS, and LDS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#eds-cds-rds-lds-and-sds">EDS, CDS, RDS, LDS, and SDS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="init.html">Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="draining.html">Draining</a></li>
<li class="toctree-l3"><a class="reference internal" href="scripting.html">Scripting</a></li>
<li class="toctree-l3"><a class="reference internal" href="ext_authz_filter.html">External Authorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="overload_manager.html">Overload manager</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../deployment_types/deployment_types.html">Deployment types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../comparison.html">Comparison to similar systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_help.html">Getting help</a></li>
<li class="toctree-l2"><a class="reference internal" href="../version_history.html">Version history</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../start/start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/install.html">Building and installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration/configuration.html">Configuration reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api-v2/api.html">v2 API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/overview.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">envoy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../intro.html">Introduction</a> &raquo;</li>
        
          <li><a href="arch_overview.html">Architecture overview</a> &raquo;</li>
        
      <li>Dynamic configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/intro/arch_overview/dynamic_configuration.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dynamic-configuration">
<span id="arch-overview-dynamic-config"></span><h1>Dynamic configuration<a class="headerlink" href="#dynamic-configuration" title="Permalink to this headline">Â¶</a></h1>
<p>Envoy is architected such that different types of configuration management approaches are possible.
The approach taken in a deployment will be dependent on the needs of the implementor. Simple
deployments are possible with a fully static configuration. More complicated deployments can
incrementally add more complex dynamic configuration, the downside being that the implementor must
provide one or more external REST based configuration provider APIs. This document gives an overview
of the options currently available.</p>
<ul class="simple">
<li>Top level configuration <a class="reference internal" href="../../configuration/configuration.html#config"><span class="std std-ref">reference</span></a>.</li>
<li><a class="reference internal" href="../../install/ref_configs.html#install-ref-configs"><span class="std std-ref">Reference configurations</span></a>.</li>
<li>Envoy <a class="reference internal" href="../../configuration/overview/v2_overview.html#config-overview-v2"><span class="std std-ref">v2 API overview</span></a>.</li>
</ul>
<div class="section" id="fully-static">
<h2>Fully static<a class="headerlink" href="#fully-static" title="Permalink to this headline">Â¶</a></h2>
<p>In a fully static configuration, the implementor provides a set of <a class="reference internal" href="../../configuration/listeners/listeners.html#config-listeners"><span class="std std-ref">listeners</span></a> (and <a class="reference internal" href="../../api-v2/api/v2/listener/listener.proto.html#envoy-api-msg-listener-filter"><span class="std std-ref">filter chains</span></a>), <a class="reference internal" href="../../configuration/cluster_manager/cluster_manager.html#config-cluster-manager"><span class="std std-ref">clusters</span></a>, and optionally <a class="reference internal" href="../../api-v2/api/v2/rds.proto.html#envoy-api-msg-routeconfiguration"><span class="std std-ref">HTTP route configurations</span></a>. Dynamic host discovery is only possible via DNS based
<a class="reference internal" href="service_discovery.html#arch-overview-service-discovery"><span class="std std-ref">service discovery</span></a>. Configuration reloads must take place
via the built in <a class="reference internal" href="hot_restart.html#arch-overview-hot-restart"><span class="std std-ref">hot restart</span></a> mechanism.</p>
<p>Though simplistic, fairly complicated deployments can be created using static configurations and
graceful hot restarts.</p>
</div>
<div class="section" id="eds-only">
<span id="arch-overview-dynamic-config-eds"></span><h2>EDS only<a class="headerlink" href="#eds-only" title="Permalink to this headline">Â¶</a></h2>
<p>The <a class="reference internal" href="../../api-v2/api/v2/eds.proto.html#envoy-api-file-envoy-api-v2-eds-proto"><span class="std std-ref">Endpoint Discovery Service (EDS) API</span></a> provides a
more advanced mechanism by which Envoy can discover members of an upstream cluster.
Layered on top of a static configuration, EDS allows an Envoy deployment to circumvent the
limitations of DNS (maximum records in a response, etc.) as well as consume more information used in
load balancing and routing (e.g., canary status, zone, etc.).</p>
</div>
<div class="section" id="eds-and-cds">
<span id="arch-overview-dynamic-config-cds"></span><h2>EDS and CDS<a class="headerlink" href="#eds-and-cds" title="Permalink to this headline">Â¶</a></h2>
<p>The <a class="reference internal" href="../../configuration/cluster_manager/cds.html#config-cluster-manager-cds"><span class="std std-ref">cluster discovery service (CDS) API</span></a> layers on a mechanism by
which Envoy can discover upstream clusters used during routing. Envoy will gracefully add, update,
and remove clusters as specified by the API. This API allows implementors to build a topology in
which Envoy does not need to be aware of all upstream clusters at initial configuration time.
Typically, when doing HTTP routing along with CDS (but without route discovery service),
implementors will make use of the routerâs ability to forward requests to a cluster specified in an
<a class="reference internal" href="../../api-v2/api/v2/route/route.proto.html#envoy-api-field-route-routeaction-cluster-header"><span class="std std-ref">HTTP request header</span></a>.</p>
<p>Although it is possible to use CDS without EDS by specifying fully static clusters, we recommend
still using the EDS API for clusters specified via CDS. Internally, when a cluster definition is
updated, the operation is graceful. However, all existing connection pools will be drained and
reconnected. EDS does not suffer from this limitation. When hosts are added and removed via EDS, the
existing hosts in the cluster are unaffected.</p>
</div>
<div class="section" id="eds-cds-and-rds">
<span id="arch-overview-dynamic-config-rds"></span><h2>EDS, CDS, and RDS<a class="headerlink" href="#eds-cds-and-rds" title="Permalink to this headline">Â¶</a></h2>
<p>The <a class="reference internal" href="../../configuration/http_conn_man/rds.html#config-http-conn-man-rds"><span class="std std-ref">route discovery service (RDS) API</span></a> layers on a mechanism by
which Envoy can discover the entire route configuration for an HTTP connection manager filter at
runtime. The route configuration will be gracefully swapped in without affecting existing requests.
This API, when used alongside EDS and CDS, allows implementors to build a complex routing topology
(<a class="reference internal" href="../../configuration/http_conn_man/traffic_splitting.html#config-http-conn-man-route-table-traffic-splitting"><span class="std std-ref">traffic shifting</span></a>, blue/green
deployment, etc).</p>
</div>
<div class="section" id="eds-cds-rds-and-lds">
<span id="arch-overview-dynamic-config-lds"></span><h2>EDS, CDS, RDS, and LDS<a class="headerlink" href="#eds-cds-rds-and-lds" title="Permalink to this headline">Â¶</a></h2>
<p>The <a class="reference internal" href="../../configuration/listeners/lds.html#config-listeners-lds"><span class="std std-ref">listener discovery service (LDS)</span></a> layers on a mechanism by which
Envoy can discover entire listeners at runtime. This includes all filter stacks, up to and including
HTTP filters with embedded references to <a class="reference internal" href="../../configuration/http_conn_man/rds.html#config-http-conn-man-rds"><span class="std std-ref">RDS</span></a>. Adding LDS into
the mix allows almost every aspect of Envoy to be dynamically configured. Hot restart should
only be required for very rare configuration changes (admin, tracing driver, etc.), certificate
rotation, or binary updates.</p>
</div>
<div class="section" id="eds-cds-rds-lds-and-sds">
<h2>EDS, CDS, RDS, LDS, and SDS<a class="headerlink" href="#eds-cds-rds-lds-and-sds" title="Permalink to this headline">Â¶</a></h2>
<p>The <a class="reference internal" href="../../configuration/secret.html#config-secret-discovery-service"><span class="std std-ref">secret discovery service (SDS)</span></a> layers on a mechanism
by which Envoy can discover cryptographic secrets (certificate plus private key, TLS session
ticket keys) for its listeners, as well as configuration of peer certificate validation logic
(trusted root certs, revocations, etc).</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="init.html" class="btn btn-neutral float-right" title="Initialization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="hot_restart.html" class="btn btn-neutral" title="Hot restart" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2018, Envoy Project Authors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>