

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Listener &mdash; envoy tag-v1.9.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../_static/css/envoy.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Listener components" href="listener/listener.proto.html" />
    <link rel="prev" title="Listeners" href="../../listeners/listeners.html" /> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> envoy
          

          
          </a>

          
            
            
              <div class="version">
                tag-v1.9.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../start/start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install/install.html">Building and installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../configuration/configuration.html">Configuration reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../api.html">v2 API reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../bootstrap/bootstrap.html">Bootstrap</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../listeners/listeners.html">Listeners</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Listener</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#envoy-api-msg-listener">Listener</a></li>
<li class="toctree-l4"><a class="reference internal" href="#enum-listener-draintype">Enum Listener.DrainType</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="listener/listener.proto.html">Listener components</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../clusters/clusters.html">Clusters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../http_routes/http_routes.html">HTTP route management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../config/config.html">Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../admin/admin.html">Admin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/data.html">Envoy data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../service/service.html">Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../common_messages/common_messages.html">Common messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../types/types.html">Types</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/overview.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">envoy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../api.html">v2 API reference</a> &raquo;</li>
        
          <li><a href="../../listeners/listeners.html">Listeners</a> &raquo;</li>
        
      <li>Listener</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/api-v2/api/v2/lds.proto.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="listener">
<span id="envoy-api-file-envoy-api-v2-lds-proto"></span><h1>Listener<a class="headerlink" href="#listener" title="Permalink to this headline">¶</a></h1>
<p>Listener <a class="reference internal" href="../../../configuration/listeners/listeners.html#config-listeners"><span class="std std-ref">configuration overview</span></a></p>
<div class="section" id="envoy-api-msg-listener">
<span id="id1"></span><h2>Listener<a class="headerlink" href="#envoy-api-msg-listener" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/master/api/envoy/api/v2/lds.proto#L40">[Listener proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;filter_chains&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;use_original_dst&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;per_connection_buffer_limit_bytes&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;metadata&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;drain_type&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;listener_filters&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;listener_filters_timeout&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;transparent&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;freebind&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;socket_options&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;tcp_fast_open_queue_length&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
  <span class="nt">&quot;bugfix_reverse_write_filter_order&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="docutils" id="envoy-api-field-listener-name">
<dt>name</dt>
<dd>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) The unique name by which this listener is known. If no name is provided,
Envoy will allocate an internal UUID for the listener. If the listener is to be dynamically
updated or removed via <a class="reference internal" href="../../../configuration/listeners/lds.html#config-listeners-lds"><span class="std std-ref">LDS</span></a> a unique name must be provided.
By default, the maximum length of a listener’s name is limited to 60 characters. This limit can
be increased by setting the <a class="reference internal" href="../../../operations/cli.html#cmdoption-max-obj-name-len"><code class="xref std std-option docutils literal notranslate"><span class="pre">--max-obj-name-len</span></code></a> command line argument to the desired
value.</dd>
</dl>
<dl class="docutils" id="envoy-api-field-listener-address">
<dt>address</dt>
<dd>(<a class="reference internal" href="core/address.proto.html#envoy-api-msg-core-address"><span class="std std-ref">core.Address</span></a>, <em>REQUIRED</em>) The address that the listener should listen on. In general, the address must be unique, though
that is governed by the bind rules of the OS. E.g., multiple listeners can listen on port 0 on
Linux as the actual port will be allocated by the OS.</dd>
</dl>
<dl class="docutils" id="envoy-api-field-listener-filter-chains">
<dt>filter_chains</dt>
<dd><p class="first">(<a class="reference internal" href="listener/listener.proto.html#envoy-api-msg-listener-filterchain"><span class="std std-ref">listener.FilterChain</span></a>, <em>REQUIRED</em>) A list of filter chains to consider for this listener. The
<a class="reference internal" href="listener/listener.proto.html#envoy-api-msg-listener-filterchain"><span class="std std-ref">FilterChain</span></a> with the most specific
<a class="reference internal" href="listener/listener.proto.html#envoy-api-msg-listener-filterchainmatch"><span class="std std-ref">FilterChainMatch</span></a> criteria is used on a
connection.</p>
<p class="last">Example using SNI for filter chain selection can be found in the
<a class="reference internal" href="../../../faq/sni.html#faq-how-to-setup-sni"><span class="std std-ref">FAQ entry</span></a>.</p>
</dd>
</dl>
<dl class="docutils" id="envoy-api-field-listener-use-original-dst">
<dt>use_original_dst</dt>
<dd><p class="first">(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#boolvalue">BoolValue</a>) If a connection is redirected using <em>iptables</em>, the port on which the proxy
receives it might be different from the original destination address. When this flag is set to
true, the listener hands off redirected connections to the listener associated with the
original destination address. If there is no listener associated with the original destination
address, the connection is handled by the listener that receives it. Defaults to false.</p>
<div class="last admonition attention">
<p class="first admonition-title">Attention</p>
<p>This field is deprecated. Use <a class="reference internal" href="../../../configuration/listener_filters/original_dst_filter.html#config-listener-filters-original-dst"><span class="std std-ref">an original_dst</span></a>
<a class="reference internal" href="#envoy-api-field-listener-listener-filters"><span class="std std-ref">listener filter</span></a> instead.</p>
<p class="last">Note that hand off to another listener is <em>NOT</em> performed without this flag. Once
<a class="reference internal" href="listener/listener.proto.html#envoy-api-msg-listener-filterchainmatch"><span class="std std-ref">FilterChainMatch</span></a> is implemented this flag
will be removed, as filter chain matching can be used to select a filter chain based on the
restored destination address.</p>
</div>
</dd>
</dl>
<dl class="docutils" id="envoy-api-field-listener-per-connection-buffer-limit-bytes">
<dt>per_connection_buffer_limit_bytes</dt>
<dd>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#uint32value">UInt32Value</a>) Soft limit on size of the listener’s new connection read and write buffers.
If unspecified, an implementation defined default is applied (1MiB).</dd>
</dl>
<dl class="docutils" id="envoy-api-field-listener-metadata">
<dt>metadata</dt>
<dd>(<a class="reference internal" href="core/base.proto.html#envoy-api-msg-core-metadata"><span class="std std-ref">core.Metadata</span></a>) Listener metadata.</dd>
</dl>
<dl class="docutils" id="envoy-api-field-listener-drain-type">
<dt>drain_type</dt>
<dd>(<a class="reference internal" href="#envoy-api-enum-listener-draintype"><span class="std std-ref">Listener.DrainType</span></a>) The type of draining to perform at a listener-wide level.</dd>
</dl>
<dl class="docutils" id="envoy-api-field-listener-listener-filters">
<dt>listener_filters</dt>
<dd>(<a class="reference internal" href="listener/listener.proto.html#envoy-api-msg-listener-listenerfilter"><span class="std std-ref">listener.ListenerFilter</span></a>) Listener filters have the opportunity to manipulate and augment the connection metadata that
is used in connection filter chain matching, for example. These filters are run before any in
<a class="reference internal" href="#envoy-api-field-listener-filter-chains"><span class="std std-ref">filter_chains</span></a>. Order matters as the
filters are processed sequentially right after a socket has been accepted by the listener, and
before a connection is created.</dd>
</dl>
<dl class="docutils" id="envoy-api-field-listener-listener-filters-timeout">
<dt>listener_filters_timeout</dt>
<dd>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#duration">Duration</a>) The timeout to wait for all listener filters to complete operation. If the timeout is reached,
the accepted socket is closed without a connection being created. Specify 0 to disable the
timeout. If not specified, a default timeout of 15s is used.</dd>
</dl>
<dl class="docutils" id="envoy-api-field-listener-transparent">
<dt>transparent</dt>
<dd>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#boolvalue">BoolValue</a>) Whether the listener should be set as a transparent socket.
When this flag is set to true, connections can be redirected to the listener using an
<em>iptables</em> <em>TPROXY</em> target, in which case the original source and destination addresses and
ports are preserved on accepted connections. This flag should be used in combination with
<a class="reference internal" href="../../../configuration/listener_filters/original_dst_filter.html#config-listener-filters-original-dst"><span class="std std-ref">an original_dst</span></a> <a class="reference internal" href="#envoy-api-field-listener-listener-filters"><span class="std std-ref">listener filter</span></a> to mark the connections’ local addresses as
“restored.” This can be used to hand off each redirected connection to another listener
associated with the connection’s destination address. Direct connections to the socket without
using <em>TPROXY</em> cannot be distinguished from connections redirected using <em>TPROXY</em> and are
therefore treated as if they were redirected.
When this flag is set to false, the listener’s socket is explicitly reset as non-transparent.
Setting this flag requires Envoy to run with the <em>CAP_NET_ADMIN</em> capability.
When this flag is not set (default), the socket is not modified, i.e. the transparent option
is neither set nor reset.</dd>
</dl>
<dl class="docutils" id="envoy-api-field-listener-freebind">
<dt>freebind</dt>
<dd>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#boolvalue">BoolValue</a>) Whether the listener should set the <em>IP_FREEBIND</em> socket option. When this
flag is set to true, listeners can be bound to an IP address that is not
configured on the system running Envoy. When this flag is set to false, the
option <em>IP_FREEBIND</em> is disabled on the socket. When this flag is not set
(default), the socket is not modified, i.e. the option is neither enabled
nor disabled.</dd>
</dl>
<dl class="docutils" id="envoy-api-field-listener-socket-options">
<dt>socket_options</dt>
<dd>(<a class="reference internal" href="core/base.proto.html#envoy-api-msg-core-socketoption"><span class="std std-ref">core.SocketOption</span></a>) Additional socket options that may not be present in Envoy source code or
precompiled binaries.</dd>
</dl>
<dl class="docutils" id="envoy-api-field-listener-tcp-fast-open-queue-length">
<dt>tcp_fast_open_queue_length</dt>
<dd><p class="first">(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#uint32value">UInt32Value</a>) Whether the listener should accept TCP Fast Open (TFO) connections.
When this flag is set to a value greater than 0, the option TCP_FASTOPEN is enabled on
the socket, with a queue length of the specified size
(see <a class="reference external" href="https://tools.ietf.org/html/rfc7413#section-5.1">details in RFC7413</a>).
When this flag is set to 0, the option TCP_FASTOPEN is disabled on the socket.
When this flag is not set (default), the socket is not modified,
i.e. the option is neither enabled nor disabled.</p>
<p>On Linux, the net.ipv4.tcp_fastopen kernel parameter must include flag 0x2 to enable
TCP_FASTOPEN.
See <a class="reference external" href="https://www.kernel.org/doc/Documentation/networking/ip-sysctl.txt">ip-sysctl.txt</a>.</p>
<p class="last">On macOS, only values of 0, 1, and unset are valid; other values may result in an error.
To set the queue length on macOS, set the net.inet.tcp.fastopen_backlog kernel parameter.</p>
</dd>
</dl>
<dl class="docutils" id="envoy-api-field-listener-bugfix-reverse-write-filter-order">
<dt>bugfix_reverse_write_filter_order</dt>
<dd>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#boolvalue">BoolValue</a>) If true, the order of write filters will be reversed to that of filters
configured in the filter chain. Otherwise, it will keep the existing
order. Note: this is a bug fix for Envoy, which is designed to have the
reversed order of write filters to that of read ones, (see
<a class="reference external" href="https://github.com/envoyproxy/envoy/issues/4599">https://github.com/envoyproxy/envoy/issues/4599</a> for details). When we
remove this field, Envoy will have the same behavior when it sets true.</dd>
</dl>
</div>
<div class="section" id="enum-listener-draintype">
<span id="envoy-api-enum-listener-draintype"></span><h2>Enum Listener.DrainType<a class="headerlink" href="#enum-listener-draintype" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/master/api/envoy/api/v2/lds.proto#L106">[Listener.DrainType proto]</a></p>
<dl class="docutils" id="envoy-api-enum-value-listener-draintype-default">
<dt>DEFAULT</dt>
<dd><em>(DEFAULT)</em> ⁣Drain in response to calling /healthcheck/fail admin endpoint (along with the health check
filter), listener removal/modification, and hot restart.</dd>
</dl>
<dl class="docutils" id="envoy-api-enum-value-listener-draintype-modify-only">
<dt>MODIFY_ONLY</dt>
<dd>⁣Drain in response to listener removal/modification and hot restart. This setting does not
include /healthcheck/fail. This setting may be desirable if Envoy is hosting both ingress
and egress listeners.</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="listener/listener.proto.html" class="btn btn-neutral float-right" title="Listener components" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../../listeners/listeners.html" class="btn btn-neutral" title="Listeners" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2018, Envoy Project Authors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>