

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>EDS &mdash; envoy tag-v1.9.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../_static/css/envoy.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Health check" href="core/health_check.proto.html" />
    <link rel="prev" title="Endpoints" href="endpoint/endpoint.proto.html" /> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> envoy
          

          
          </a>

          
            
            
              <div class="version">
                tag-v1.9.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../start/start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install/install.html">Building and installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../configuration/configuration.html">Configuration reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../api.html">v2 API reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../bootstrap/bootstrap.html">Bootstrap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../listeners/listeners.html">Listeners</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../clusters/clusters.html">Clusters</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="cds.proto.html">Clusters</a></li>
<li class="toctree-l3"><a class="reference internal" href="cluster/outlier_detection.proto.html">Outlier detection</a></li>
<li class="toctree-l3"><a class="reference internal" href="cluster/circuit_breaker.proto.html">Circuit breakers</a></li>
<li class="toctree-l3"><a class="reference internal" href="endpoint/endpoint.proto.html">Endpoints</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">EDS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#clusterloadassignment">ClusterLoadAssignment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#clusterloadassignment-policy">ClusterLoadAssignment.Policy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#clusterloadassignment-policy-dropoverload">ClusterLoadAssignment.Policy.DropOverload</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="core/health_check.proto.html">Health check</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../http_routes/http_routes.html">HTTP route management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../config/config.html">Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../admin/admin.html">Admin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data/data.html">Envoy data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../service/service.html">Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../common_messages/common_messages.html">Common messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../types/types.html">Types</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/overview.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">envoy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../api.html">v2 API reference</a> &raquo;</li>
        
          <li><a href="../../clusters/clusters.html">Clusters</a> &raquo;</li>
        
      <li>EDS</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/api-v2/api/v2/eds.proto.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="eds">
<span id="envoy-api-file-envoy-api-v2-eds-proto"></span><h1>EDS<a class="headerlink" href="#eds" title="Permalink to this headline">¶</a></h1>
<p>Endpoint discovery <a class="reference internal" href="../../../intro/arch_overview/service_discovery.html#arch-overview-service-discovery-types-eds"><span class="std std-ref">architecture overview</span></a></p>
<div class="section" id="clusterloadassignment">
<span id="envoy-api-msg-clusterloadassignment"></span><h2>ClusterLoadAssignment<a class="headerlink" href="#clusterloadassignment" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/master/api/envoy/api/v2/eds.proto#L43">[ClusterLoadAssignment proto]</a></p>
<p>Each route from RDS will map to a single cluster or traffic split across
clusters using weights expressed in the RDS WeightedCluster.</p>
<p>With EDS, each cluster is treated independently from a LB perspective, with
LB taking place between the Localities within a cluster and at a finer
granularity between the hosts within a locality. For a given cluster, the
effective weight of a host is its load_balancing_weight multiplied by the
load_balancing_weight of its Locality.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;cluster_name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;endpoints&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;policy&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="docutils" id="envoy-api-field-clusterloadassignment-cluster-name">
<dt>cluster_name</dt>
<dd>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) Name of the cluster. This will be the <a class="reference internal" href="cds.proto.html#envoy-api-field-cluster-edsclusterconfig-service-name"><span class="std std-ref">service_name</span></a> value if specified
in the cluster <a class="reference internal" href="cds.proto.html#envoy-api-msg-cluster-edsclusterconfig"><span class="std std-ref">EdsClusterConfig</span></a>.</dd>
</dl>
<dl class="docutils" id="envoy-api-field-clusterloadassignment-endpoints">
<dt>endpoints</dt>
<dd>(<a class="reference internal" href="endpoint/endpoint.proto.html#envoy-api-msg-endpoint-localitylbendpoints"><span class="std std-ref">endpoint.LocalityLbEndpoints</span></a>) List of endpoints to load balance to.</dd>
</dl>
<dl class="docutils" id="envoy-api-field-clusterloadassignment-policy">
<dt>policy</dt>
<dd>(<a class="reference internal" href="#envoy-api-msg-clusterloadassignment-policy"><span class="std std-ref">ClusterLoadAssignment.Policy</span></a>) Load balancing policy settings.</dd>
</dl>
</div>
<div class="section" id="clusterloadassignment-policy">
<span id="envoy-api-msg-clusterloadassignment-policy"></span><h2>ClusterLoadAssignment.Policy<a class="headerlink" href="#clusterloadassignment-policy" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/master/api/envoy/api/v2/eds.proto#L54">[ClusterLoadAssignment.Policy proto]</a></p>
<p>Load balancing policy settings.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;drop_overloads&quot;</span><span class="p">:</span> <span class="p">[],</span>
  <span class="nt">&quot;overprovisioning_factor&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="docutils" id="envoy-api-field-clusterloadassignment-policy-drop-overloads">
<dt>drop_overloads</dt>
<dd><p class="first">(<a class="reference internal" href="#envoy-api-msg-clusterloadassignment-policy-dropoverload"><span class="std std-ref">ClusterLoadAssignment.Policy.DropOverload</span></a>) Action to trim the overall incoming traffic to protect the upstream
hosts. This action allows protection in case the hosts are unable to
recover from an outage, or unable to autoscale or unable to handle
incoming traffic volume for any reason.</p>
<p>At the client each category is applied one after the other to generate
the ‘actual’ drop percentage on all outgoing traffic. For example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="nt">&quot;drop_overloads&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span> <span class="nt">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;throttle&quot;</span><span class="p">,</span> <span class="nt">&quot;drop_percentage&quot;</span><span class="p">:</span> <span class="mi">60</span> <span class="p">}</span>
    <span class="p">{</span> <span class="nt">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;lb&quot;</span><span class="p">,</span> <span class="nt">&quot;drop_percentage&quot;</span><span class="p">:</span> <span class="mi">50</span> <span class="p">}</span>
<span class="p">]}</span>
</pre></div>
</div>
<dl class="last docutils">
<dt>The actual drop percentages applied to the traffic at the clients will be</dt>
<dd>“throttle”_drop = 60%
“lb”_drop = 20%  // 50% of the remaining ‘actual’ load, which is 40%.
actual_outgoing_load = 20% // remaining after applying all categories.</dd>
</dl>
</dd>
</dl>
<dl class="docutils" id="envoy-api-field-clusterloadassignment-policy-overprovisioning-factor">
<dt>overprovisioning_factor</dt>
<dd><p class="first">(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#uint32value">UInt32Value</a>) Priority levels and localities are considered overprovisioned with this
factor (in percentage). This means that we don’t consider a priority
level or locality unhealthy until the percentage of healthy hosts
multiplied by the overprovisioning factor drops below 100.
With the default value 140(1.4), Envoy doesn’t consider a priority level
or a locality unhealthy until their percentage of healthy hosts drops
below 72%. For example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="nt">&quot;overprovisioning_factor&quot;</span><span class="p">:</span> <span class="mi">100</span> <span class="p">}</span>
</pre></div>
</div>
<p class="last">Read more at <a class="reference internal" href="../../../intro/arch_overview/load_balancing/priority.html#arch-overview-load-balancing-priority-levels"><span class="std std-ref">priority levels</span></a> and
<a class="reference internal" href="../../../intro/arch_overview/load_balancing/locality_weight.html#arch-overview-load-balancing-locality-weighted-lb"><span class="std std-ref">localities</span></a>.</p>
</dd>
</dl>
</div>
<div class="section" id="clusterloadassignment-policy-dropoverload">
<span id="envoy-api-msg-clusterloadassignment-policy-dropoverload"></span><h2>ClusterLoadAssignment.Policy.DropOverload<a class="headerlink" href="#clusterloadassignment-policy-dropoverload" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/envoyproxy/envoy/blob/master/api/envoy/api/v2/eds.proto#L57">[ClusterLoadAssignment.Policy.DropOverload proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;category&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
  <span class="nt">&quot;drop_percentage&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="docutils" id="envoy-api-field-clusterloadassignment-policy-dropoverload-category">
<dt>category</dt>
<dd>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <em>REQUIRED</em>) Identifier for the policy specifying the drop.</dd>
</dl>
<dl class="docutils" id="envoy-api-field-clusterloadassignment-policy-dropoverload-drop-percentage">
<dt>drop_percentage</dt>
<dd>(<a class="reference internal" href="../../type/percent.proto.html#envoy-api-msg-type-fractionalpercent"><span class="std std-ref">type.FractionalPercent</span></a>) Percentage of traffic that should be dropped for the category.</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="core/health_check.proto.html" class="btn btn-neutral float-right" title="Health check" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="endpoint/endpoint.proto.html" class="btn btn-neutral" title="Endpoints" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2018, Envoy Project Authors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>